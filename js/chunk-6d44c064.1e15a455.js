(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6d44c064"],{"0067":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordContext=void 0;const r=n("e6e5"),i=n("f232");class o extends i.EntryHandlerKeyword{constructor(){super("@context")}isStackProcessor(){return!1}async handle(t,e,n,i,o,a){t.streamingProfile&&(t.processingStack[a]||t.processingType[a]||void 0!==t.idStack[a])&&t.emitError(new r.ErrorCoded("Found an out-of-order context, while streaming is enabled.(disable `streamingProfile`)",r.ERROR_CODES.INVALID_STREAMING_KEY_ORDER));const s=t.getContext(i),u=t.parseContext(o,(await s).getContextRaw());t.contextTree.setContext(i.slice(0,-1),u),t.emitContext(o),await t.validateContext(await u)}}e.EntryHandlerKeywordContext=o},"0538":function(t,e,n){"use strict";var r=n("1c0b"),i=n("861d"),o=[].slice,a={},s=function(t,e,n){if(!(e in a)){for(var r=[],i=0;i<e;i++)r[i]="a["+i+"]";a[e]=Function("C,a","return new C("+r.join(",")+")")}return a[e](t,n)};t.exports=Function.bind||function(t){var e=r(this),n=o.call(arguments,1),a=function(){var r=n.concat(o.call(arguments));return this instanceof a?s(e,r.length,r):e.apply(t,r)};return i(e.prototype)&&(a.prototype=e.prototype),a}},"0aac":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerHandlerType=void 0;const r=n("bfb1"),i=n("882b");class o{canCombineWithGraph(){return!1}async handle(t,e,n,o,a,s){if(!Array.isArray(a)){if("string"===typeof a){const t=await e.getContext(o),r=i.Util.getContextValueType(t,o[s-1]),u="@vocab"===r?await n.createVocabOrBaseTerm(t,a):await n.resourceToTerm(t,a);if(u){const t={"@id":"NamedNode"===u.termType?u.value:a};await e.newOnValueJob(o.slice(0,o.length-1),t,s-1,!0),e.idStack[s+1]=[u]}}else{const t=!!e.idStack[s+1];t||delete e.idStack[s],await e.newOnValueJob(o.slice(0,o.length-1),a,s-1,!0),t||(e.idStack[s+1]=e.idStack[s])}const t=await n.getContainerKey(o[s],o,s),u=null!==t?n.createVocabOrBaseTerm(await e.getContext(o),t):null;u&&await r.EntryHandlerPredicate.handlePredicateObject(e,n,o,s+1,n.rdfType,u,!1),await e.handlePendingContainerFlushBuffers()}e.emittedStack[s]=!1}}e.ContainerHandlerType=o},"0ac3":function(t,e,n){e=t.exports=n("6f2e"),e.Stream=e,e.Readable=e,e.Writable=n("6ffa"),e.Duplex=n("d6dd"),e.Transform=n("dcd0"),e.PassThrough=n("aa69")},1065:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.JsonLdParser=void 0;const r=n("c13b"),i=n("e6e5"),o=n("d485"),a=n("56f4"),s=n("af6b"),u=n("72a3"),c=n("bfb1"),l=n("0067"),f=n("88de"),h=n("c317"),d=n("c154"),p=n("2019"),y=n("9d5a"),b=n("c28b"),v=n("1be5"),g=n("202f"),m=n("882b"),w=n("c7e2");class _ extends o.Transform{constructor(t){super({readableObjectMode:!0}),t=t||{},this.options=t,this.parsingContext=new g.ParsingContext(Object.assign({parser:this},t)),this.util=new m.Util({dataFactory:t.dataFactory,parsingContext:this.parsingContext}),this.jsonParser=new r,this.contextJobs=[],this.typeJobs=[],this.contextAwaitingJobs=[],this.lastDepth=0,this.lastKeys=[],this.lastOnValueJob=Promise.resolve(),this.attachJsonParserListeners()}static fromHttpResponse(t,e,n,r){let o,a;if("application/ld+json"!==e){if("application/json"!==e&&!e.endsWith("+json"))throw new i.ErrorCoded("Unsupported JSON-LD media type "+e,i.ERROR_CODES.LOADING_DOCUMENT_FAILED);if(n&&n.has("Link")&&n.forEach((e,n)=>{if("link"===n){const n=w.parse(e);for(const e of n.get("rel","http://www.w3.org/ns/json-ld#context")){if(o)throw new i.ErrorCoded("Multiple JSON-LD context link headers were found on "+t,i.ERROR_CODES.MULTIPLE_CONTEXT_LINK_HEADERS);o=e.uri}}}),!o&&!(null===r||void 0===r?void 0:r.ignoreMissingContextLinkHeader))throw new i.ErrorCoded(`Missing context link header for media type ${e} on ${t}`,i.ERROR_CODES.LOADING_DOCUMENT_FAILED)}if(n&&n.has("Content-Type")){const t=n.get("Content-Type"),e=/; *profile=([^"]*)/.exec(t);e&&"http://www.w3.org/ns/json-ld#streaming"===e[1]&&(a=!0)}return new _(Object.assign({baseIRI:t,context:o,streamingProfile:a},r||{}))}import(t){const e=new o.PassThrough({readableObjectMode:!0});t.on("error",t=>n.emit("error",t)),t.on("data",t=>e.push(t)),t.on("end",()=>e.push(null));const n=e.pipe(new _(this.options));return n}_transform(t,e,n){this.jsonParser.write(t),this.lastOnValueJob.then(()=>n(),t=>n(t))}async newOnValueJob(t,e,n,r){let o=!0;if(r&&n<this.lastDepth){const t=this.parsingContext.listPointerStack[this.lastDepth];t&&(t.value&&this.emit("data",this.util.dataFactory.quad(t.value,this.util.rdfRest,this.util.rdfNil,this.util.getDefaultGraph())),t.listId.listHead=!0,this.parsingContext.idStack[t.listRootDepth+1]=[t.listId],this.parsingContext.listPointerStack.splice(this.lastDepth,1)),await s.EntryHandlerContainer.isBufferableContainerHandler(this.parsingContext,this.lastKeys,this.lastDepth)?(this.parsingContext.pendingContainerFlushBuffers.push({depth:this.lastDepth,keys:this.lastKeys.slice(0,this.lastKeys.length)}),o=!1):await this.flushBuffer(this.lastDepth,this.lastKeys)}const a=await this.util.unaliasKeyword(t[n],t,n),u=await this.util.unaliasKeywordParent(t,n);this.parsingContext.emittedStack[n]=!0;let c=!0;i.Util.isValidKeyword(a)&&"@reverse"===u&&this.emit("error",new i.ErrorCoded(`Found the @id '${e}' inside an @reverse property`,i.ERROR_CODES.INVALID_REVERSE_PROPERTY_MAP));let l=!1;this.parsingContext.validationStack.length>1&&(l=this.parsingContext.validationStack[this.parsingContext.validationStack.length-1].property);for(let i=Math.max(1,this.parsingContext.validationStack.length-1);i<t.length-1;i++){const e=this.parsingContext.validationStack[i]||(this.parsingContext.validationStack[i]=await this.validateKey(t.slice(0,i+1),i,l));if(!e.valid){this.parsingContext.emittedStack[n]=!1,c=!1;break}!l&&e.property&&(l=!0)}if(this.util.isLiteral(n)&&(c=!1),c)for(const i of _.ENTRY_HANDLERS){const r=await i.test(this.parsingContext,this.util,a,t,n);if(r){await i.handle(this.parsingContext,this.util,a,t,e,n,r),i.isStackProcessor()&&(this.parsingContext.processingStack[n]=!0);break}}0===n&&Array.isArray(e)&&await this.util.validateValueIndexes(e),o&&n<this.lastDepth&&this.flushStacks(this.lastDepth),this.lastDepth=n,this.lastKeys=t,this.parsingContext.unaliasedKeywordCacheStack.splice(n-1)}flushStacks(t){this.parsingContext.processingStack.splice(t,1),this.parsingContext.processingType.splice(t,1),this.parsingContext.emittedStack.splice(t,1),this.parsingContext.idStack.splice(t,1),this.parsingContext.graphStack.splice(t+1,1),this.parsingContext.graphContainerTermStack.splice(t,1),this.parsingContext.jsonLiteralStack.splice(t,1),this.parsingContext.validationStack.splice(t-1,2),this.parsingContext.literalStack.splice(t,this.parsingContext.literalStack.length-t)}async flushBuffer(t,e){let n=this.parsingContext.idStack[t];n||(n=this.parsingContext.idStack[t]=[this.util.dataFactory.blankNode()]);const r=this.parsingContext.unidentifiedValuesBuffer[t];if(r){for(const i of n){const n=await this.util.getDepthOffsetGraph(t,e),o=this.parsingContext.graphStack[t]||n>=0?this.parsingContext.idStack[t-n-1]:[await this.util.getGraphContainerValue(e,t)];if(o)for(const e of o){this.parsingContext.emittedStack[t]=!0;for(const n of r)n.reverse?this.parsingContext.emitQuad(t,this.util.dataFactory.quad(n.object,n.predicate,i,e)):this.parsingContext.emitQuad(t,this.util.dataFactory.quad(i,n.predicate,n.object,e))}else{const n=this.parsingContext.getUnidentifiedGraphBufferSafe(t-await this.util.getDepthOffsetGraph(t,e)-1);for(const t of r)t.reverse?n.push({object:i,predicate:t.predicate,subject:t.object}):n.push({object:t.object,predicate:t.predicate,subject:i})}}this.parsingContext.unidentifiedValuesBuffer.splice(t,1),this.parsingContext.literalStack.splice(t,1),this.parsingContext.jsonLiteralStack.splice(t,1)}const i=this.parsingContext.unidentifiedGraphsBuffer[t];if(i){for(const e of n){const n=1!==t||"BlankNode"!==e.termType||this.parsingContext.topLevelProperties?e:this.util.getDefaultGraph();this.parsingContext.emittedStack[t]=!0;for(const e of i)this.parsingContext.emitQuad(t,this.util.dataFactory.quad(e.subject,e.predicate,e.object,n))}this.parsingContext.unidentifiedGraphsBuffer.splice(t,1)}}async validateKey(t,e,n){for(const r of _.ENTRY_HANDLERS)if(await r.validate(this.parsingContext,this.util,t,e,n))return{valid:!0,property:n||r.isPropertyHandler()};return{valid:!1,property:!1}}attachJsonParserListeners(){this.jsonParser.onValue=t=>{const e=this.jsonParser.stack.length,n=new Array(e+1).fill(0).map((t,n)=>n===e?this.jsonParser.key:this.jsonParser.stack[n].key);if(!this.isParsingContextInner(e)){const r=()=>this.newOnValueJob(n,t,e,!0);if(this.parsingContext.streamingProfile||this.parsingContext.contextTree.getContext(n.slice(0,-1)))this.lastOnValueJob=this.lastOnValueJob.then(r);else if("@context"===n[e]){let t=this.contextJobs[e];t||(t=this.contextJobs[e]=[]),t.push(r)}else"@type"===n[e]||"number"===typeof n[e]&&"@type"===n[e-1]?this.typeJobs.push({job:r,keys:n.slice(0,n.length-1)}):this.contextAwaitingJobs.push({job:r,keys:n});this.parsingContext.streamingProfile||0!==e||(this.lastOnValueJob=this.lastOnValueJob.then(()=>this.executeBufferedJobs()))}},this.jsonParser.onError=t=>{this.emit("error",t)}}isParsingContextInner(t){for(let e=t;e>0;e--)if("@context"===this.jsonParser.stack[e-1].key)return!0;return!1}async executeBufferedJobs(){for(const t of this.contextJobs)if(t)for(const e of t)await e();this.parsingContext.unaliasedKeywordCacheStack.splice(0);for(const t of this.contextAwaitingJobs){if(this.typeJobs.length>0){const e=[],n=[];for(let o=0;o<this.typeJobs.length;o++){const r=this.typeJobs[o];m.Util.isPrefixArray(r.keys,t.keys)&&(e.push(r),n.push(o))}const r=e.sort((t,e)=>t.keys.length-e.keys.length);for(const t of r)await t.job();const i=n.sort().reverse();for(const t of i)this.typeJobs.splice(t,1)}await t.job()}}}e.JsonLdParser=_,_.DEFAULT_PROCESSING_MODE="1.1",_.ENTRY_HANDLERS=[new a.EntryHandlerArrayValue,new l.EntryHandlerKeywordContext,new h.EntryHandlerKeywordId,new d.EntryHandlerKeywordIncluded,new f.EntryHandlerKeywordGraph,new p.EntryHandlerKeywordNest,new y.EntryHandlerKeywordType,new v.EntryHandlerKeywordValue,new s.EntryHandlerContainer,new b.EntryHandlerKeywordUnknownFallback,new c.EntryHandlerPredicate,new u.EntryHandlerInvalidFallback]},"13f1":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DataFactory=void 0;const r=n("7096"),i=n("3e6b"),o=n("8ce0"),a=n("9935"),s=n("8026"),u=n("a22a");let c=0;class l{constructor(t){this.blankNodeCounter=0,t=t||{},this.blankNodePrefix=t.blankNodePrefix||`df_${c++}_`}namedNode(t){return new a.NamedNode(t)}blankNode(t){return new r.BlankNode(t||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(t,e){return new o.Literal(t,e)}variable(t){return new u.Variable(t)}defaultGraph(){return i.DefaultGraph.INSTANCE}quad(t,e,n,r){return new s.Quad(t,e,n,r||this.defaultGraph())}fromTerm(t){switch(t.termType){case"NamedNode":return this.namedNode(t.value);case"BlankNode":return this.blankNode(t.value);case"Literal":return t.language?this.literal(t.value,t.language):t.datatype.equals(o.Literal.XSD_STRING)?this.literal(t.value):this.literal(t.value,this.fromTerm(t.datatype));case"Variable":return this.variable(t.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(t.subject),this.fromTerm(t.predicate),this.fromTerm(t.object),this.fromTerm(t.graph))}}fromQuad(t){return this.fromTerm(t)}resetBlankNodeCounter(){this.blankNodeCounter=0}}e.DataFactory=l},"159b":function(t,e,n){var r=n("da84"),i=n("fdbc"),o=n("17c2"),a=n("9112");for(var s in i){var u=r[s],c=u&&u.prototype;if(c&&c.forEach!==o)try{a(c,"forEach",o)}catch(l){c.forEach=o}}},"17c2":function(t,e,n){"use strict";var r=n("b727").forEach,i=n("a640"),o=n("ae40"),a=i("forEach"),s=o("forEach");t.exports=a&&s?[].forEach:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}},"1be5":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordValue=void 0;const r=n("f232");class i extends r.EntryHandlerKeyword{constructor(){super("@value")}async test(t,e,n,r,i){return"@value"===await e.unaliasKeyword(r[i],r.slice(0,r.length-1),i-1,!0)}async handle(t,e,n,r,i,o){t.literalStack[o]=!0,delete t.unidentifiedValuesBuffer[o],delete t.unidentifiedGraphsBuffer[o],t.emittedStack[o]=!1}}e.EntryHandlerKeywordValue=i},2019:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordNest=void 0;const r=n("e6e5"),i=n("f232");class o extends i.EntryHandlerKeyword{constructor(){super("@nest")}async handle(t,e,n,i,o,a){"object"!==typeof o&&t.emitError(new r.ErrorCoded(`Found invalid @nest entry for '${n}': '${o}'`,r.ERROR_CODES.INVALID_NEST_VALUE)),"@value"in await e.unaliasKeywords(o,i,a,await t.getContext(i))&&t.emitError(new r.ErrorCoded(`Found an invalid @value node for '${n}'`,r.ERROR_CODES.INVALID_NEST_VALUE)),t.emittedStack[a]=!1}}e.EntryHandlerKeywordNest=o},"202f":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ParsingContext=void 0;const r=n("e6e5"),i=n("56af"),o=n("c826"),a=n("1065");class s{constructor(t){this.contextParser=new r.ContextParser({documentLoader:t.documentLoader}),this.streamingProfile=!!t.streamingProfile,this.baseIRI=t.baseIRI,this.produceGeneralizedRdf=!!t.produceGeneralizedRdf,this.allowSubjectList=!!t.allowSubjectList,this.processingMode=t.processingMode||a.JsonLdParser.DEFAULT_PROCESSING_MODE,this.strictValues=!!t.strictValues,this.validateValueIndexes=!!t.validateValueIndexes,this.defaultGraph=t.defaultGraph,this.rdfDirection=t.rdfDirection,this.normalizeLanguageTags=t.normalizeLanguageTags,this.streamingProfileAllowOutOfOrderPlainType=t.streamingProfileAllowOutOfOrderPlainType,this.topLevelProperties=!1,this.activeProcessingMode=parseFloat(this.processingMode),this.processingStack=[],this.processingType=[],this.emittedStack=[],this.idStack=[],this.graphStack=[],this.graphContainerTermStack=[],this.listPointerStack=[],this.contextTree=new o.ContextTree,this.literalStack=[],this.validationStack=[],this.unaliasedKeywordCacheStack=[],this.jsonLiteralStack=[],this.unidentifiedValuesBuffer=[],this.unidentifiedGraphsBuffer=[],this.pendingContainerFlushBuffers=[],this.parser=t.parser,t.context?(this.rootContext=this.parseContext(t.context),this.rootContext.then(t=>this.validateContext(t))):this.rootContext=Promise.resolve(new r.JsonLdContextNormalized(this.baseIRI?{"@base":this.baseIRI,"@__baseDocument":!0}:{}))}async parseContext(t,e,n){return this.contextParser.parse(t,{baseIRI:this.baseIRI,ignoreProtection:n,normalizeLanguageTags:this.normalizeLanguageTags,parentContext:e,processingMode:this.activeProcessingMode})}validateContext(t){const e=t.getContextRaw()["@version"];if(e){if(this.activeProcessingMode&&e>this.activeProcessingMode)throw new i.ErrorCoded(`Unsupported JSON-LD version '${e}' under active processing mode ${this.activeProcessingMode}.`,i.ERROR_CODES.PROCESSING_MODE_CONFLICT);if(this.activeProcessingMode&&e<this.activeProcessingMode)throw new i.ErrorCoded(`Invalid JSON-LD version ${e} under active processing mode ${this.activeProcessingMode}.`,i.ERROR_CODES.INVALID_VERSION_VALUE);this.activeProcessingMode=e}}async getContext(t,e=1){const n=t;while("number"===typeof t[t.length-1])t=t.slice(0,t.length-1);e&&(t=t.slice(0,-e));const i=await this.getContextPropagationAware(t),o=i.context;let a=o.getContextRaw();for(let s=i.depth;s<n.length-e;s++){const t=n[s],i=a[t];if(i&&"object"===typeof i&&"@context"in i){const o=(await this.parseContext(i,a,!0)).getContextRaw(),u=!(t in o)||o[t]["@context"]["@propagate"];!1===u&&s!==n.length-1-e||(a=o,delete a["@propagate"],a[t]=Object.assign({},a[t]),"@id"in i&&(a[t]["@id"]=i["@id"]),delete a[t]["@context"],!1!==u&&this.contextTree.setContext(n.slice(0,s+e),Promise.resolve(new r.JsonLdContextNormalized(a))))}}return new r.JsonLdContextNormalized(a)}async getContextPropagationAware(t){const e=t.length;let n,i=null;do{n=!1,i&&"@__propagateFallback"in i.context.getContextRaw()?i.context=new r.JsonLdContextNormalized(i.context.getContextRaw()["@__propagateFallback"]):(i&&(t=t.slice(0,i.depth-1)),i=await this.contextTree.getContext(t)||{context:await this.rootContext,depth:0});const e=t[t.length-1];if(e in i.context.getContextRaw()){const t=i.context.getContextRaw()[e];t&&"object"===typeof t&&"@context"in t&&(n=!0)}}while(i.depth>0&&!1===i.context.getContextRaw()["@propagate"]&&i.depth!==e&&!n);return 0===i.depth&&!1===i.context.getContextRaw()["@propagate"]&&i.depth!==e&&(i.context=new r.JsonLdContextNormalized({})),i}async newOnValueJob(t,e,n,r){await this.parser.newOnValueJob(t,e,n,r)}async handlePendingContainerFlushBuffers(){if(this.pendingContainerFlushBuffers.length>0){for(const t of this.pendingContainerFlushBuffers)await this.parser.flushBuffer(t.depth,t.keys),this.parser.flushStacks(t.depth);return this.pendingContainerFlushBuffers.splice(0,this.pendingContainerFlushBuffers.length),!0}return!1}emitQuad(t,e){1===t&&(this.topLevelProperties=!0),this.parser.push(e)}emitError(t){this.parser.emit("error",t)}emitContext(t){this.parser.emit("context",t)}getUnidentifiedValueBufferSafe(t){let e=this.unidentifiedValuesBuffer[t];return e||(e=[],this.unidentifiedValuesBuffer[t]=e),e}getUnidentifiedGraphBufferSafe(t){let e=this.unidentifiedGraphsBuffer[t];return e||(e=[],this.unidentifiedGraphsBuffer[t]=e),e}getExpandOptions(){return s.EXPAND_OPTIONS[this.activeProcessingMode]}shiftStack(t,e){const n=this.idStack[t+e];if(n&&(this.idStack[t]=n,this.emittedStack[t]=!0,delete this.idStack[t+e]),this.pendingContainerFlushBuffers.length)for(const r of this.pendingContainerFlushBuffers)r.depth>=t+e&&(r.depth-=e,r.keys.splice(t,e));this.unidentifiedValuesBuffer[t+e]&&(this.unidentifiedValuesBuffer[t]=this.unidentifiedValuesBuffer[t+e],delete this.unidentifiedValuesBuffer[t+e])}}e.ParsingContext=s,s.EXPAND_OPTIONS={1:{allowPrefixForcing:!1,allowPrefixNonGenDelims:!1,allowVocabRelativeToBase:!1},1.1:{allowPrefixForcing:!0,allowPrefixNonGenDelims:!1,allowVocabRelativeToBase:!0}}},"25f0":function(t,e,n){"use strict";var r=n("6eeb"),i=n("825a"),o=n("d039"),a=n("ad6d"),s="toString",u=RegExp.prototype,c=u[s],l=o((function(){return"/a/b"!=c.call({source:"a",flags:"b"})})),f=c.name!=s;(l||f)&&r(RegExp.prototype,s,(function(){var t=i(this),e=String(t.source),n=t.flags,r=String(void 0===n&&t instanceof RegExp&&!("flags"in u)?a.call(t):n);return"/"+e+"/"+r}),{unsafe:!0})},"2aaa":function(t,e,n){t.exports=n("faa1").EventEmitter},"2e23":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("b-card",{staticClass:"mb-2",staticStyle:{"min-width":"10rem"},attrs:{"no-body":""}},[n("b-card-title",{attrs:{tag:"h4"}},[t._v("Workspaces ")]),n("b-card-sub-title",[t._v("Privacy: "),n("b-button",{attrs:{pill:"",size:"sm",variant:"primary"},on:{click:t.togglePrivacy}},[t._v(t._s(t.privacy))]),n("br")],1),n("b-list-group",{attrs:{flush:""}},t._l(t.workspaces,(function(e){return n("b-list-group-item",{key:e.url,attrs:{button:"",size:"sm"},on:{click:function(n){return t.openWorkspace(e.url)}}},[n("Label",{attrs:{url:e.url,tick:t.tick}})],1)})),1),n("b-button",{attrs:{pill:"",variant:"outline-secondary",size:"sm"},on:{click:t.add}},[n("b-icon-plus"),t._v(" Add a workspace")],1)],1)],1)},i=[],o=(n("4160"),n("b0c0"),n("d3b7"),n("159b"),n("96cf"),n("1da1"));function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){return s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},s(t,e)}function u(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}n("4ae1"),n("3410");function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}n("25f0");function l(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var f=n("53ca");function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(t,e){return!e||"object"!==Object(f["a"])(e)&&"function"!==typeof e?h(t):e}function p(t){var e=l();return function(){var n,r=c(t);if(e){var i=c(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}function y(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var b=n("dfab"),v=n.n(b),g=n("00e8"),m=n.n(g),w=n("ddbf"),_=function(t){u(n,t);var e=p(n);function n(){return a(this,n),e.apply(this,arguments)}return n}(b["SolidModel"]);y(_,"rdfsClasses",["http://xmlns.com/foaf/0.1/Person"]),y(_,"fields",{name:{type:w["FieldType"].String,rdfProperty:"http://xmlns.com/foaf/0.1/name"}}),v.a.loadSolidModels(),w["Soukai"].loadModels({Person:_}),w["Soukai"].useEngine(new b["SolidEngine"](m.a.fetch.bind(m.a)));var S="https://spoggy-test5.solidcommunity.net/public/table/persons/",x={name:"Workspace",components:{Label:function(){return n.e("chunk-2d20fb75").then(n.bind(null,"b58d"))}},data:function(){return{tick:new Date}},created:function(){this.workspaces=[],console.log("##################",this.$myAddedMethod()),_.at(S).create({name:"John Doe"})},mounted:function(){return Object(o["a"])(regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,_.from(S);case 2:return e=t.sent,console.log("Container",e),t.next=6,_.from(S).all();case 6:n=t.sent,console.log("Persons",n),n.forEach((function(t){console.log("NAme",t.name)}));case 9:case"end":return t.stop()}}),t)})))()},methods:{add:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("table/addWorkspace",{path:t.path,name:"___workspace name___"});case 1:case"end":return e.stop()}}),e)})))()},openWorkspace:function(t){this.$store.commit("table/setWorkspace",t)},togglePrivacy:function(){this.$store.commit("table/togglePrivacy")},getWorkspaces:function(){this.$store.dispatch("table/getWorkspaces",this.storage+this.privacy+"/table/workspaces/")}},watch:{privacy:function(){console.log(this.storage+this.privacy,this.storage),this.getWorkspaces()},storage:function(){console.log(this.storage+this.privacy),this.getWorkspaces()},workspaces:function(){console.log("must update workspaces in table",this.workspaces),this.tick=new Date}},computed:{workspaces:{get:function(){return this.$store.state.table.workspaces},set:function(){}},storage:{get:function(){return this.$store.state.solid.storage},set:function(){}},path:{get:function(){return this.storage+this.privacy+"/table/workspaces/"},set:function(){}},privacy:{get:function(){return this.$store.state.table.privacy},set:function(){}}}},C=x,E=n("2877"),O=Object(E["a"])(C,r,i,!1,null,null,null);e["default"]=O.exports},"3a7c":function(t,e,n){(function(t){function n(t){return Array.isArray?Array.isArray(t):"[object Array]"===b(t)}function r(t){return"boolean"===typeof t}function i(t){return null===t}function o(t){return null==t}function a(t){return"number"===typeof t}function s(t){return"string"===typeof t}function u(t){return"symbol"===typeof t}function c(t){return void 0===t}function l(t){return"[object RegExp]"===b(t)}function f(t){return"object"===typeof t&&null!==t}function h(t){return"[object Date]"===b(t)}function d(t){return"[object Error]"===b(t)||t instanceof Error}function p(t){return"function"===typeof t}function y(t){return null===t||"boolean"===typeof t||"number"===typeof t||"string"===typeof t||"symbol"===typeof t||"undefined"===typeof t}function b(t){return Object.prototype.toString.call(t)}e.isArray=n,e.isBoolean=r,e.isNull=i,e.isNullOrUndefined=o,e.isNumber=a,e.isString=s,e.isSymbol=u,e.isUndefined=c,e.isRegExp=l,e.isObject=f,e.isDate=h,e.isError=d,e.isFunction=p,e.isPrimitive=y,e.isBuffer=t.isBuffer}).call(this,n("b639").Buffer)},"3e6b":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultGraph=void 0;class r{constructor(){this.termType="DefaultGraph",this.value=""}equals(t){return!!t&&"DefaultGraph"===t.termType}}e.DefaultGraph=r,r.INSTANCE=new r},4160:function(t,e,n){"use strict";var r=n("23e7"),i=n("17c2");r({target:"Array",proto:!0,forced:[].forEach!=i},{forEach:i})},"43e4":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SeparatorType=void 0;class r{constructor(t){this.label=t}}e.SeparatorType=r,r.COMMA=new r(","),r.OBJECT_START=new r("{"),r.OBJECT_END=new r("}"),r.OBJECT_END_COMMA=new r("},"),r.ARRAY_START=new r("["),r.ARRAY_END=new r("]"),r.ARRAY_END_COMMA=new r("],"),r.GRAPH_FIELD_NONCOMPACT=new r('"@graph": ['),r.GRAPH_FIELD_COMPACT=new r('"@graph":['),r.CONTEXT_FIELD=new r('"@context":')},"4ae1":function(t,e,n){var r=n("23e7"),i=n("d066"),o=n("1c0b"),a=n("825a"),s=n("861d"),u=n("7c73"),c=n("0538"),l=n("d039"),f=i("Reflect","construct"),h=l((function(){function t(){}return!(f((function(){}),[],t)instanceof t)})),d=!l((function(){f((function(){}))})),p=h||d;r({target:"Reflect",stat:!0,forced:p,sham:p},{construct:function(t,e){o(t),a(e);var n=arguments.length<3?t:o(arguments[2]);if(d&&!h)return f(t,e,n);if(t==n){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var r=[null];return r.push.apply(r,e),new(c.apply(t,r))}var i=n.prototype,l=u(s(i)?i:Object.prototype),p=Function.apply.call(t,l,e);return s(p)?p:l}})},"50cc":function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),i(n("1065"),e)},"51a2":function(t,e,n){t.exports=n("0ac3").PassThrough},"53ca":function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));n("a4d3"),n("e01a"),n("d28b"),n("d3b7"),n("3ca3"),n("ddb0");function r(t){return r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}},"56f4":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerArrayValue=void 0;const r=n("882b");class i{isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,n,r,i){return this.test(t,e,null,n,r)}async test(t,e,n,r,i){return"number"===typeof r[i]}async handle(t,e,n,i,o,a){let s=await e.unaliasKeywordParent(i,a);if("@list"===s){let n=null,r=0;for(let t=a-2;t>0;t--){const e=i[t];if("string"===typeof e||"number"===typeof e){r=t,n=e;break}}if(null!==n){const s=await e.valueToTerm(await t.getContext(i),n,o,a,i);for(const n of s)await this.handleListElement(t,e,n,o,a,i.slice(0,r),r);0===s.length&&await this.handleListElement(t,e,null,o,a,i.slice(0,r),r)}}else if("@set"===s)await t.newOnValueJob(i.slice(0,-2),o,a-2,!1);else if(void 0!==s&&"@type"!==s){for(let t=a-1;t>0;t--)if("number"!==typeof i[t]){s=await e.unaliasKeyword(i[t],i,t);break}const n=await t.getContext(i.slice(0,-1));if("@list"in r.Util.getContextValueContainer(n,s)){t.emittedStack[a+1]=!0;const n=await e.valueToTerm(await t.getContext(i),s,o,a,i);for(const r of n)await this.handleListElement(t,e,r,o,a,i.slice(0,-1),a-1);0===n.length&&await this.handleListElement(t,e,null,o,a,i.slice(0,-1),a-1)}else t.shiftStack(a,1),await t.newOnValueJob(i.slice(0,-1),o,a-1,!1),t.contextTree.removeContext(i.slice(0,-1))}}async handleListElement(t,e,n,r,i,o,a){let s=t.listPointerStack[i];if(null!==r&&null!==(await e.unaliasKeywords(r,o,i))["@value"]){if(s&&s.value){const n=e.dataFactory.blankNode();t.emitQuad(i,e.dataFactory.quad(s.value,e.rdfRest,n,e.getDefaultGraph())),s.value=n}else{const t=e.dataFactory.blankNode();s={value:t,listRootDepth:a,listId:t}}n&&t.emitQuad(i,e.dataFactory.quad(s.value,e.rdfFirst,n,e.getDefaultGraph()))}else s||(s={listRootDepth:a,listId:e.rdfNil});t.listPointerStack[i]=s}}e.EntryHandlerArrayValue=i},"6f2e":function(t,e,n){"use strict";(function(e,r){var i=n("966d");t.exports=S;var o,a=n("e3db");S.ReadableState=_;n("faa1").EventEmitter;var s=function(t,e){return t.listeners(e).length},u=n("2aaa"),c=n("f60b").Buffer,l=e.Uint8Array||function(){};function f(t){return c.from(t)}function h(t){return c.isBuffer(t)||t instanceof l}var d=Object.create(n("3a7c"));d.inherits=n("3fb5");var p=n(7),y=void 0;y=p&&p.debuglog?p.debuglog("stream"):function(){};var b,v=n("9b54"),g=n("c4c0");d.inherits(S,u);var m=["error","close","destroy","pause","resume"];function w(t,e,n){if("function"===typeof t.prependListener)return t.prependListener(e,n);t._events&&t._events[e]?a(t._events[e])?t._events[e].unshift(n):t._events[e]=[n,t._events[e]]:t.on(e,n)}function _(t,e){o=o||n("d6dd"),t=t||{};var r=e instanceof o;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var i=t.highWaterMark,a=t.readableHighWaterMark,s=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(a||0===a)?a:s,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new v,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(b||(b=n("aa22").StringDecoder),this.decoder=new b(t.encoding),this.encoding=t.encoding)}function S(t){if(o=o||n("d6dd"),!(this instanceof S))return new S(t);this._readableState=new _(t,this),this.readable=!0,t&&("function"===typeof t.read&&(this._read=t.read),"function"===typeof t.destroy&&(this._destroy=t.destroy)),u.call(this)}function x(t,e,n,r,i){var o,a=t._readableState;null===e?(a.reading=!1,R(t,a)):(i||(o=E(a,e)),o?t.emit("error",o):a.objectMode||e&&e.length>0?("string"===typeof e||a.objectMode||Object.getPrototypeOf(e)===c.prototype||(e=f(e)),r?a.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):C(t,a,e,!0):a.ended?t.emit("error",new Error("stream.push() after EOF")):(a.reading=!1,a.decoder&&!n?(e=a.decoder.write(e),a.objectMode||0!==e.length?C(t,a,e,!1):A(t,a)):C(t,a,e,!1))):r||(a.reading=!1));return O(a)}function C(t,e,n,r){e.flowing&&0===e.length&&!e.sync?(t.emit("data",n),t.read(0)):(e.length+=e.objectMode?1:n.length,r?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&P(t)),A(t,e)}function E(t,e){var n;return h(e)||"string"===typeof e||void 0===e||t.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function O(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}Object.defineProperty(S.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),S.prototype.destroy=g.destroy,S.prototype._undestroy=g.undestroy,S.prototype._destroy=function(t,e){this.push(null),e(t)},S.prototype.push=function(t,e){var n,r=this._readableState;return r.objectMode?n=!0:"string"===typeof t&&(e=e||r.defaultEncoding,e!==r.encoding&&(t=c.from(t,e),e=""),n=!0),x(this,t,e,!1,n)},S.prototype.unshift=function(t){return x(this,t,null,!0,!1)},S.prototype.isPaused=function(){return!1===this._readableState.flowing},S.prototype.setEncoding=function(t){return b||(b=n("aa22").StringDecoder),this._readableState.decoder=new b(t),this._readableState.encoding=t,this};var D=8388608;function T(t){return t>=D?t=D:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function k(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=T(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function R(t,e){if(!e.ended){if(e.decoder){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,P(t)}}function P(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(y("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?i.nextTick(j,t):j(t))}function j(t){y("emit readable"),t.emit("readable"),U(t)}function A(t,e){e.readingMore||(e.readingMore=!0,i.nextTick(I,t,e))}function I(t,e){var n=e.length;while(!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark){if(y("maybeReadMore read 0"),t.read(0),n===e.length)break;n=e.length}e.readingMore=!1}function L(t){return function(){var e=t._readableState;y("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&s(t,"data")&&(e.flowing=!0,U(t))}}function N(t){y("readable nexttick read 0"),t.read(0)}function M(t,e){e.resumeScheduled||(e.resumeScheduled=!0,i.nextTick(F,t,e))}function F(t,e){e.reading||(y("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),U(t),e.flowing&&!e.reading&&t.read(0)}function U(t){var e=t._readableState;y("flow",e.flowing);while(e.flowing&&null!==t.read());}function V(t,e){return 0===e.length?null:(e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):n=B(t,e.buffer,e.decoder),n);var n}function B(t,e,n){var r;return t<e.head.data.length?(r=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):r=t===e.head.data.length?e.shift():n?J(t,e):G(t,e),r}function J(t,e){var n=e.head,r=1,i=n.data;t-=i.length;while(n=n.next){var o=n.data,a=t>o.length?o.length:t;if(a===o.length?i+=o:i+=o.slice(0,t),t-=a,0===t){a===o.length?(++r,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n,n.data=o.slice(a));break}++r}return e.length-=r,i}function G(t,e){var n=c.allocUnsafe(t),r=e.head,i=1;r.data.copy(n),t-=r.data.length;while(r=r.next){var o=r.data,a=t>o.length?o.length:t;if(o.copy(n,n.length-t,0,a),t-=a,0===t){a===o.length?(++i,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r,r.data=o.slice(a));break}++i}return e.length-=i,n}function K(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,i.nextTick($,e,t))}function $(t,e){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function q(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}S.prototype.read=function(t){y("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return y("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?K(this):P(this),null;if(t=k(t,e),0===t&&e.ended)return 0===e.length&&K(this),null;var r,i=e.needReadable;return y("need readable",i),(0===e.length||e.length-t<e.highWaterMark)&&(i=!0,y("length less than watermark",i)),e.ended||e.reading?(i=!1,y("reading or ended",i)):i&&(y("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=k(n,e))),r=t>0?V(t,e):null,null===r?(e.needReadable=!0,t=0):e.length-=t,0===e.length&&(e.ended||(e.needReadable=!0),n!==t&&e.ended&&K(this)),null!==r&&this.emit("data",r),r},S.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))},S.prototype.pipe=function(t,e){var n=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=t;break;case 1:o.pipes=[o.pipes,t];break;default:o.pipes.push(t);break}o.pipesCount+=1,y("pipe count=%d opts=%j",o.pipesCount,e);var a=(!e||!1!==e.end)&&t!==r.stdout&&t!==r.stderr,u=a?l:_;function c(t,e){y("onunpipe"),t===n&&e&&!1===e.hasUnpiped&&(e.hasUnpiped=!0,d())}function l(){y("onend"),t.end()}o.endEmitted?i.nextTick(u):n.once("end",u),t.on("unpipe",c);var f=L(n);t.on("drain",f);var h=!1;function d(){y("cleanup"),t.removeListener("close",g),t.removeListener("finish",m),t.removeListener("drain",f),t.removeListener("error",v),t.removeListener("unpipe",c),n.removeListener("end",l),n.removeListener("end",_),n.removeListener("data",b),h=!0,!o.awaitDrain||t._writableState&&!t._writableState.needDrain||f()}var p=!1;function b(e){y("ondata"),p=!1;var r=t.write(e);!1!==r||p||((1===o.pipesCount&&o.pipes===t||o.pipesCount>1&&-1!==q(o.pipes,t))&&!h&&(y("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,p=!0),n.pause())}function v(e){y("onerror",e),_(),t.removeListener("error",v),0===s(t,"error")&&t.emit("error",e)}function g(){t.removeListener("finish",m),_()}function m(){y("onfinish"),t.removeListener("close",g),_()}function _(){y("unpipe"),n.unpipe(t)}return n.on("data",b),w(t,"error",v),t.once("close",g),t.once("finish",m),t.emit("pipe",n),o.flowing||(y("pipe resume"),n.resume()),t},S.prototype.unpipe=function(t){var e=this._readableState,n={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,n)),this;if(!t){var r=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,n);return this}var a=q(e.pipes,t);return-1===a||(e.pipes.splice(a,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,n)),this},S.prototype.on=function(t,e){var n=u.prototype.on.call(this,t,e);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&P(this):i.nextTick(N,this))}return n},S.prototype.addListener=S.prototype.on,S.prototype.resume=function(){var t=this._readableState;return t.flowing||(y("resume"),t.flowing=!0,M(this,t)),this},S.prototype.pause=function(){return y("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(y("pause"),this._readableState.flowing=!1,this.emit("pause")),this},S.prototype.wrap=function(t){var e=this,n=this._readableState,r=!1;for(var i in t.on("end",(function(){if(y("wrapped end"),n.decoder&&!n.ended){var t=n.decoder.end();t&&t.length&&e.push(t)}e.push(null)})),t.on("data",(function(i){if(y("wrapped data"),n.decoder&&(i=n.decoder.write(i)),(!n.objectMode||null!==i&&void 0!==i)&&(n.objectMode||i&&i.length)){var o=e.push(i);o||(r=!0,t.pause())}})),t)void 0===this[i]&&"function"===typeof t[i]&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));for(var o=0;o<m.length;o++)t.on(m[o],this.emit.bind(this,m[o]));return this._read=function(e){y("wrapped _read",e),r&&(r=!1,t.resume())},this},Object.defineProperty(S.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),S._fromList=V}).call(this,n("c8ba"),n("4362"))},"6ffa":function(t,e,n){"use strict";(function(e,r){var i=n("966d");function o(t){var e=this;this.next=null,this.entry=null,this.finish=function(){N(e,t)}}t.exports=m;var a,s=!e.browser&&["v0.10","v0.9."].indexOf(e.version.slice(0,5))>-1?setImmediate:i.nextTick;m.WritableState=g;var u=Object.create(n("3a7c"));u.inherits=n("3fb5");var c={deprecate:n("b7d1")},l=n("2aaa"),f=n("f60b").Buffer,h=r.Uint8Array||function(){};function d(t){return f.from(t)}function p(t){return f.isBuffer(t)||t instanceof h}var y,b=n("c4c0");function v(){}function g(t,e){a=a||n("d6dd"),t=t||{};var r=e instanceof a;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var i=t.highWaterMark,s=t.writableHighWaterMark,u=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(s||0===s)?s:u,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var c=!1===t.decodeStrings;this.decodeStrings=!c,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){D(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function m(t){if(a=a||n("d6dd"),!y.call(m,this)&&!(this instanceof a))return new m(t);this._writableState=new g(t,this),this.writable=!0,t&&("function"===typeof t.write&&(this._write=t.write),"function"===typeof t.writev&&(this._writev=t.writev),"function"===typeof t.destroy&&(this._destroy=t.destroy),"function"===typeof t.final&&(this._final=t.final)),l.call(this)}function w(t,e){var n=new Error("write after end");t.emit("error",n),i.nextTick(e,n)}function _(t,e,n,r){var o=!0,a=!1;return null===n?a=new TypeError("May not write null values to stream"):"string"===typeof n||void 0===n||e.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a&&(t.emit("error",a),i.nextTick(r,a),o=!1),o}function S(t,e,n){return t.objectMode||!1===t.decodeStrings||"string"!==typeof e||(e=f.from(e,n)),e}function x(t,e,n,r,i,o){if(!n){var a=S(e,r,i);r!==a&&(n=!0,i="buffer",r=a)}var s=e.objectMode?1:r.length;e.length+=s;var u=e.length<e.highWaterMark;if(u||(e.needDrain=!0),e.writing||e.corked){var c=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},c?c.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else C(t,e,!1,s,r,i,o);return u}function C(t,e,n,r,i,o,a){e.writelen=r,e.writecb=a,e.writing=!0,e.sync=!0,n?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function E(t,e,n,r,o){--e.pendingcb,n?(i.nextTick(o,r),i.nextTick(I,t,e),t._writableState.errorEmitted=!0,t.emit("error",r)):(o(r),t._writableState.errorEmitted=!0,t.emit("error",r),I(t,e))}function O(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function D(t,e){var n=t._writableState,r=n.sync,i=n.writecb;if(O(n),e)E(t,n,r,e,i);else{var o=P(n);o||n.corked||n.bufferProcessing||!n.bufferedRequest||R(t,n),r?s(T,t,n,o,i):T(t,n,o,i)}}function T(t,e,n,r){n||k(t,e),e.pendingcb--,r(),I(t,e)}function k(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function R(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var r=e.bufferedRequestCount,i=new Array(r),a=e.corkedRequestsFree;a.entry=n;var s=0,u=!0;while(n)i[s]=n,n.isBuf||(u=!1),n=n.next,s+=1;i.allBuffers=u,C(t,e,!0,e.length,i,"",a.finish),e.pendingcb++,e.lastBufferedRequest=null,a.next?(e.corkedRequestsFree=a.next,a.next=null):e.corkedRequestsFree=new o(e),e.bufferedRequestCount=0}else{while(n){var c=n.chunk,l=n.encoding,f=n.callback,h=e.objectMode?1:c.length;if(C(t,e,!1,h,c,l,f),n=n.next,e.bufferedRequestCount--,e.writing)break}null===n&&(e.lastBufferedRequest=null)}e.bufferedRequest=n,e.bufferProcessing=!1}function P(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function j(t,e){t._final((function(n){e.pendingcb--,n&&t.emit("error",n),e.prefinished=!0,t.emit("prefinish"),I(t,e)}))}function A(t,e){e.prefinished||e.finalCalled||("function"===typeof t._final?(e.pendingcb++,e.finalCalled=!0,i.nextTick(j,t,e)):(e.prefinished=!0,t.emit("prefinish")))}function I(t,e){var n=P(e);return n&&(A(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"))),n}function L(t,e,n){e.ending=!0,I(t,e),n&&(e.finished?i.nextTick(n):t.once("finish",n)),e.ended=!0,t.writable=!1}function N(t,e,n){var r=t.entry;t.entry=null;while(r){var i=r.callback;e.pendingcb--,i(n),r=r.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}u.inherits(m,l),g.prototype.getBuffer=function(){var t=this.bufferedRequest,e=[];while(t)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(g.prototype,"buffer",{get:c.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"===typeof Symbol&&Symbol.hasInstance&&"function"===typeof Function.prototype[Symbol.hasInstance]?(y=Function.prototype[Symbol.hasInstance],Object.defineProperty(m,Symbol.hasInstance,{value:function(t){return!!y.call(this,t)||this===m&&(t&&t._writableState instanceof g)}})):y=function(t){return t instanceof this},m.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},m.prototype.write=function(t,e,n){var r=this._writableState,i=!1,o=!r.objectMode&&p(t);return o&&!f.isBuffer(t)&&(t=d(t)),"function"===typeof e&&(n=e,e=null),o?e="buffer":e||(e=r.defaultEncoding),"function"!==typeof n&&(n=v),r.ended?w(this,n):(o||_(this,r,t,n))&&(r.pendingcb++,i=x(this,r,o,t,e,n)),i},m.prototype.cork=function(){var t=this._writableState;t.corked++},m.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||R(this,t))},m.prototype.setDefaultEncoding=function(t){if("string"===typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(m.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),m.prototype._write=function(t,e,n){n(new Error("_write() is not implemented"))},m.prototype._writev=null,m.prototype.end=function(t,e,n){var r=this._writableState;"function"===typeof t?(n=t,t=null,e=null):"function"===typeof e&&(n=e,e=null),null!==t&&void 0!==t&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||L(this,r,n)},Object.defineProperty(m.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),m.prototype.destroy=b.destroy,m.prototype._undestroy=b.undestroy,m.prototype._destroy=function(t,e){this.end(),e(t)}}).call(this,n("4362"),n("c8ba"))},7:function(t,e){},7096:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BlankNode=void 0;class r{constructor(t){this.termType="BlankNode",this.value=t}equals(t){return!!t&&"BlankNode"===t.termType&&t.value===this.value}}e.BlankNode=r},"72a3":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerInvalidFallback=void 0;class r{isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,n,r,i){return!1}async test(t,e,n,r,i){return!0}async handle(t,e,n,r,i,o){t.emittedStack[o]=!1}}e.EntryHandlerInvalidFallback=r},"72aa":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.JsonLdSerializer=void 0;const r=n("e6e5"),i=n("d485"),o=n("43e4"),a=n("c3f4");class s extends i.Transform{constructor(t={}){super({objectMode:!0}),this.indentation=0,this.options=t,this.options.baseIRI&&!this.options.context&&(this.options.context={"@base":this.options.baseIRI}),this.options.context?(this.originalContext=this.options.context,this.context=(new r.ContextParser).parse(this.options.context,{baseIRI:this.options.baseIRI})):this.context=Promise.resolve(new r.JsonLdContextNormalized({}))}import(t){const e=new i.PassThrough({objectMode:!0});t.on("error",t=>n.emit("error",t)),t.on("data",t=>e.push(t)),t.on("end",()=>e.push(null));const n=e.pipe(new s(this.options));return n}_transform(t,e,n){this.context.then(e=>{this.transformQuad(t,e),n()}).catch(n)}async list(t){const e=await this.context;return{"@list":t.map(t=>a.Util.termToValue(t,e,this.options))}}_flush(t){return this.opened||this.pushDocumentStart(),this.lastPredicate&&this.endPredicate(),this.lastSubject&&this.endSubject(),this.lastGraph&&"DefaultGraph"!==this.lastGraph.termType&&this.endGraph(),this.endDocument(),t(null,null)}transformQuad(t,e){this.opened||this.pushDocumentStart();const n=this.lastGraph&&"DefaultGraph"!==this.lastGraph.termType&&this.lastGraph.equals(t.subject);if(!n&&(!this.lastGraph||!t.graph.equals(this.lastGraph))){let n="DefaultGraph"!==t.graph.termType&&this.lastSubject&&this.lastSubject.equals(t.graph);this.lastGraph&&("DefaultGraph"!==this.lastGraph.termType?(this.endPredicate(),this.endSubject(),this.endGraph(!0),n=!1):n?(this.endPredicate(!0),this.lastSubject=null):(this.endPredicate(),this.endSubject(!0))),"DefaultGraph"!==t.graph.termType&&(n||this.pushId(t.graph,e),this.pushSeparator(this.options.space?o.SeparatorType.GRAPH_FIELD_NONCOMPACT:o.SeparatorType.GRAPH_FIELD_COMPACT),this.indentation++),this.lastGraph=t.graph}this.lastSubject&&t.subject.equals(this.lastSubject)||(n?(this.endPredicate(),this.endSubject(),this.indentation--,this.pushSeparator(o.SeparatorType.ARRAY_END_COMMA),this.lastGraph=t.graph):(this.lastSubject&&(this.endPredicate(),this.endSubject(!0)),this.pushId(t.subject,e)),this.lastSubject=t.subject),this.lastPredicate&&t.predicate.equals(this.lastPredicate)||(this.lastPredicate&&this.endPredicate(!0),this.pushPredicate(t.predicate,e)),this.pushObject(t.object,e)}pushDocumentStart(){this.opened=!0,this.originalContext&&!this.options.excludeContext?(this.pushSeparator(o.SeparatorType.OBJECT_START),this.indentation++,this.pushSeparator(o.SeparatorType.CONTEXT_FIELD),this.pushIndented(JSON.stringify(this.originalContext,null,this.options.space)+","),this.pushSeparator(this.options.space?o.SeparatorType.GRAPH_FIELD_NONCOMPACT:o.SeparatorType.GRAPH_FIELD_COMPACT),this.indentation++):(this.pushSeparator(o.SeparatorType.ARRAY_START),this.indentation++)}pushId(t,e){const n="BlankNode"===t.termType?"_:"+t.value:e.compactIri(t.value,!1);this.pushSeparator(o.SeparatorType.OBJECT_START),this.indentation++,this.pushIndented(this.options.space?`"@id": "${n}",`:`"@id":"${n}",`)}pushPredicate(t,e){let n=t.value;this.options.useRdfType||n!==a.Util.RDF_TYPE||(n="@type",this.objectOptions=Object.assign(Object.assign({},this.options),{compactIds:!0,vocab:!0}));const r=e.compactIri(n,!0);this.pushIndented(this.options.space?`"${r}": [`:`"${r}":[`),this.indentation++,this.lastPredicate=t}pushObject(t,e){let n;this.hadObjectForPredicate?this.pushSeparator(o.SeparatorType.COMMA):this.hadObjectForPredicate=!0;try{n=t["@list"]?t:a.Util.termToValue(t,e,this.objectOptions||this.options)}catch(r){return this.emit("error",r)}this.pushIndented(JSON.stringify(n,null,this.options.space))}endDocument(){this.opened=!1,this.originalContext&&!this.options.excludeContext?(this.indentation--,this.pushSeparator(o.SeparatorType.ARRAY_END),this.indentation--,this.pushSeparator(o.SeparatorType.OBJECT_END)):(this.indentation--,this.pushSeparator(o.SeparatorType.ARRAY_END))}endPredicate(t){this.indentation--,this.pushSeparator(t?o.SeparatorType.ARRAY_END_COMMA:o.SeparatorType.ARRAY_END),this.hadObjectForPredicate=!1,this.objectOptions=null,this.lastPredicate=null}endSubject(t){this.indentation--,this.pushSeparator(t?o.SeparatorType.OBJECT_END_COMMA:o.SeparatorType.OBJECT_END),this.lastSubject=null}endGraph(t){this.indentation--,this.pushSeparator(o.SeparatorType.ARRAY_END),this.indentation--,this.pushSeparator(t?o.SeparatorType.OBJECT_END_COMMA:o.SeparatorType.OBJECT_END),this.lastGraph=null}pushSeparator(t){this.pushIndented(t.label)}pushIndented(t){const e=this.getIndentPrefix(),n=t.split("\n").map(t=>e+t).join("\n");this.push(n),this.options.space&&this.push("\n")}getIndentPrefix(){return this.options.space?this.options.space.repeat(this.indentation):""}}e.JsonLdSerializer=s},"7c16":function(t,e,n){t.exports=n("d6dd")},8:function(t,e){},8026:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Quad=void 0;class r{constructor(t,e,n,r){this.termType="Quad",this.value="",this.subject=t,this.predicate=e,this.object=n,this.graph=r}equals(t){return!!t&&("Quad"===t.termType||!t.termType)&&this.subject.equals(t.subject)&&this.predicate.equals(t.predicate)&&this.object.equals(t.object)&&this.graph.equals(t.graph)}}e.Quad=r},"882b":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Util=void 0;const r=n("e6e5"),i=n("c513"),o=n("af6b"),a=n("5727");class s{constructor(t){this.parsingContext=t.parsingContext,this.dataFactory=t.dataFactory||new i.DataFactory,this.rdfFirst=this.dataFactory.namedNode(s.RDF+"first"),this.rdfRest=this.dataFactory.namedNode(s.RDF+"rest"),this.rdfNil=this.dataFactory.namedNode(s.RDF+"nil"),this.rdfType=this.dataFactory.namedNode(s.RDF+"type"),this.rdfJson=this.dataFactory.namedNode(s.RDF+"JSON")}static getContextValue(t,e,n,r){const i=t.getContextRaw()[n];if(!i)return r;const o=i[e];return void 0===o?r:o}static getContextValueContainer(t,e){return s.getContextValue(t,"@container",e,{"@set":!0})}static getContextValueType(t,e){const n=s.getContextValue(t,"@type",e,null);return"@none"===n?null:n}static getContextValueLanguage(t,e){return s.getContextValue(t,"@language",e,t.getContextRaw()["@language"]||null)}static getContextValueDirection(t,e){return s.getContextValue(t,"@direction",e,t.getContextRaw()["@direction"]||null)}static isContextValueReverse(t,e){return!!s.getContextValue(t,"@reverse",e,null)}static getContextValueIndex(t,e){return s.getContextValue(t,"@index",e,t.getContextRaw()["@index"]||null)}static isPropertyReverse(t,e,n){return"@reverse"===n!==s.isContextValueReverse(t,e)}static isValidIri(t){return null!==t&&r.Util.isValidIri(t)}static isPrefixArray(t,e){if(t.length>e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}async validateValueIndexes(t){if(this.parsingContext.validateValueIndexes){const e={};for(const n of t)if(n&&"object"===typeof n){const t=n["@id"],i=n["@index"];if(t&&i){const n=e[t];if(n&&n!==i)throw new r.ErrorCoded("Conflicting @index value for "+t,r.ERROR_CODES.CONFLICTING_INDEXES);e[t]=i}}}}async valueToTerm(t,e,n,i,o){if("@json"===s.getContextValueType(t,e))return[this.dataFactory.literal(this.valueToJsonString(n),this.rdfJson)];const a=typeof n;switch(a){case"object":if(null===n||void 0===n)return[];if(Array.isArray(n))return"@list"in s.getContextValueContainer(t,e)?0===n.length?[this.rdfNil]:this.parsingContext.idStack[i+1]||[]:(await this.validateValueIndexes(n),[]);if(t=await this.getContextSelfOrPropertyScoped(t,e),"@context"in n&&(t=await this.parsingContext.parseContext(n["@context"],(await this.parsingContext.getContext(o,0)).getContextRaw())),n=await this.unaliasKeywords(n,o,i,t),"@value"in n){let a,s,u,c,l;for(e in n){const t=n[e];switch(e){case"@value":a=t;break;case"@language":s=t;break;case"@direction":u=t;break;case"@type":c=t;break;case"@index":l=t;break;default:throw new r.ErrorCoded(`Unknown value entry '${e}' in @value: ${JSON.stringify(n)}`,r.ERROR_CODES.INVALID_VALUE_OBJECT)}}if("@json"===await this.unaliasKeyword(c,o,i,!0,t))return[this.dataFactory.literal(this.valueToJsonString(a),this.rdfJson)];if(null===a)return[];if("object"===typeof a)throw new r.ErrorCoded(`The value of an '@value' can not be an object, got '${JSON.stringify(a)}'`,r.ERROR_CODES.INVALID_VALUE_OBJECT_VALUE);if(this.parsingContext.validateValueIndexes&&l&&"string"!==typeof l)throw new r.ErrorCoded(`The value of an '@index' must be a string, got '${JSON.stringify(l)}'`,r.ERROR_CODES.INVALID_INDEX_VALUE);if(s){if("string"!==typeof a)throw new r.ErrorCoded(`When an '@language' is set, the value of '@value' must be a string, got '${JSON.stringify(a)}'`,r.ERROR_CODES.INVALID_LANGUAGE_TAGGED_VALUE);if(!r.ContextParser.validateLanguage(s,this.parsingContext.strictValues,r.ERROR_CODES.INVALID_LANGUAGE_TAGGED_STRING))return[];(this.parsingContext.normalizeLanguageTags||1===this.parsingContext.activeProcessingMode)&&(s=s.toLowerCase())}if(u){if("string"!==typeof a)throw new Error(`When an '@direction' is set, the value of '@value' must be a string, got '${JSON.stringify(a)}'`);if(!r.ContextParser.validateDirection(u,this.parsingContext.strictValues))return[]}if(s&&u&&this.parsingContext.rdfDirection){if(c)throw new r.ErrorCoded(`Can not have '@language', '@direction' and '@type' in a value: '${JSON.stringify(n)}'`,r.ERROR_CODES.INVALID_VALUE_OBJECT);return this.nullableTermToArray(this.createLanguageDirectionLiteral(i,a,s,u))}if(s){if(c)throw new r.ErrorCoded(`Can not have both '@language' and '@type' in a value: '${JSON.stringify(n)}'`,r.ERROR_CODES.INVALID_VALUE_OBJECT);return[this.dataFactory.literal(a,s)]}if(u&&this.parsingContext.rdfDirection){if(c)throw new r.ErrorCoded(`Can not have both '@direction' and '@type' in a value: '${JSON.stringify(n)}'`,r.ERROR_CODES.INVALID_VALUE_OBJECT);return this.nullableTermToArray(this.createLanguageDirectionLiteral(i,a,s,u))}if(c){if("string"!==typeof c)throw new r.ErrorCoded(`The value of an '@type' must be a string, got '${JSON.stringify(c)}'`,r.ERROR_CODES.INVALID_TYPED_VALUE);const e=this.createVocabOrBaseTerm(t,c);if(!e)throw new r.ErrorCoded(`Invalid '@type' value, got '${JSON.stringify(c)}'`,r.ERROR_CODES.INVALID_TYPED_VALUE);if("NamedNode"!==e.termType)throw new r.ErrorCoded(`Illegal value type (${e.termType}): ${c}`,r.ERROR_CODES.INVALID_TYPED_VALUE);return[this.dataFactory.literal(a,e)]}return await this.valueToTerm(new r.JsonLdContextNormalized({}),e,a,i,o)}if("@set"in n){if(Object.keys(n).length>1)throw new r.ErrorCoded(`Found illegal neighbouring entries next to @set for key: '${e}'`,r.ERROR_CODES.INVALID_SET_OR_LIST_OBJECT);return[]}if("@list"in n){if(Object.keys(n).length>1)throw new r.ErrorCoded(`Found illegal neighbouring entries next to @list for key: '${e}'`,r.ERROR_CODES.INVALID_SET_OR_LIST_OBJECT);const t=n["@list"];return Array.isArray(t)?0===t.length?[this.rdfNil]:this.parsingContext.idStack[i+1]||[]:await this.valueToTerm(await this.parsingContext.getContext(o),e,t,i-1,o.slice(0,-1))}if("@reverse"in n)return[];if("@graph"in s.getContextValueContainer(await this.parsingContext.getContext(o),e)){const t=this.parsingContext.graphContainerTermStack[i+1];return t?Object.values(t):[this.dataFactory.blankNode()]}return"@id"in n?(Object.keys(n).length>1&&(t=await this.parsingContext.getContext(o,0)),"@context"in n&&(t=await this.parsingContext.parseContext(n["@context"],t.getContextRaw())),"@vocab"===n["@type"]?this.nullableTermToArray(this.createVocabOrBaseTerm(t,n["@id"])):this.nullableTermToArray(this.resourceToTerm(t,n["@id"]))):this.parsingContext.emittedStack[i+1]||n&&"object"===typeof n&&0===Object.keys(n).length?this.parsingContext.idStack[i+1]||(this.parsingContext.idStack[i+1]=[this.dataFactory.blankNode()]):[];case"string":return this.nullableTermToArray(this.stringValueToTerm(i,await this.getContextSelfOrPropertyScoped(t,e),e,n,null));case"boolean":return this.nullableTermToArray(this.stringValueToTerm(i,await this.getContextSelfOrPropertyScoped(t,e),e,Boolean(n).toString(),this.dataFactory.namedNode(s.XSD_BOOLEAN)));case"number":return this.nullableTermToArray(this.stringValueToTerm(i,await this.getContextSelfOrPropertyScoped(t,e),e,n,this.dataFactory.namedNode(n%1===0&&n<1e21?s.XSD_INTEGER:s.XSD_DOUBLE)));default:return this.parsingContext.emitError(new Error("Could not determine the RDF type of a "+a)),[]}}async getContextSelfOrPropertyScoped(t,e){const n=t.getContextRaw()[e];return n&&"object"===typeof n&&"@context"in n&&(t=await this.parsingContext.parseContext(n,t.getContextRaw(),!0)),t}nullableTermToArray(t){return t?[t]:[]}predicateToTerm(t,e){const n=t.expandTerm(e,!0,this.parsingContext.getExpandOptions());return n?"_"===n[0]&&":"===n[1]?this.parsingContext.produceGeneralizedRdf?this.dataFactory.blankNode(n.substr(2)):null:s.isValidIri(n)?this.dataFactory.namedNode(n):n&&this.parsingContext.strictValues?(this.parsingContext.emitError(new r.ErrorCoded("Invalid predicate IRI: "+n,r.ERROR_CODES.INVALID_IRI_MAPPING)),null):null:null}resourceToTerm(t,e){if(e.startsWith("_:"))return this.dataFactory.blankNode(e.substr(2));const n=t.expandTerm(e,!1,this.parsingContext.getExpandOptions());if(!s.isValidIri(n)){if(!n||!this.parsingContext.strictValues)return null;this.parsingContext.emitError(new Error("Invalid resource IRI: "+n))}return this.dataFactory.namedNode(n)}createVocabOrBaseTerm(t,e){if(e.startsWith("_:"))return this.dataFactory.blankNode(e.substr(2));const n=this.parsingContext.getExpandOptions();let r=t.expandTerm(e,!0,n);if(r===e&&(r=t.expandTerm(e,!1,n)),!s.isValidIri(r)){if(!r||!this.parsingContext.strictValues)return null;this.parsingContext.emitError(new Error("Invalid term IRI: "+r))}return this.dataFactory.namedNode(r)}intToString(t,e){if("number"===typeof t){if(Number.isFinite(t)){const n=t%1===0;return!n||e&&e.value===s.XSD_DOUBLE?t.toExponential(15).replace(/(\d)0*e\+?/,"$1E"):Number(t).toString()}return t>0?"INF":"-INF"}return t}stringValueToTerm(t,e,n,r,i){const o=s.getContextValueType(e,n);if(o)if("@id"===o){if(!i)return this.resourceToTerm(e,this.intToString(r,i))}else if("@vocab"===o){if(!i)return this.createVocabOrBaseTerm(e,this.intToString(r,i))}else i=this.dataFactory.namedNode(o);if(!i){const o=s.getContextValueLanguage(e,n),a=s.getContextValueDirection(e,n);return a&&this.parsingContext.rdfDirection?this.createLanguageDirectionLiteral(t,this.intToString(r,i),o,a):this.dataFactory.literal(this.intToString(r,i),o)}return this.dataFactory.literal(this.intToString(r,i),i)}createLanguageDirectionLiteral(t,e,n,r){if("i18n-datatype"===this.parsingContext.rdfDirection)return n||(n=""),this.dataFactory.literal(e,this.dataFactory.namedNode(`https://www.w3.org/ns/i18n#${n}_${r}`));{const i=this.dataFactory.blankNode(),o=this.getDefaultGraph();return this.parsingContext.emitQuad(t,this.dataFactory.quad(i,this.dataFactory.namedNode(s.RDF+"value"),this.dataFactory.literal(e),o)),n&&this.parsingContext.emitQuad(t,this.dataFactory.quad(i,this.dataFactory.namedNode(s.RDF+"language"),this.dataFactory.literal(n),o)),this.parsingContext.emitQuad(t,this.dataFactory.quad(i,this.dataFactory.namedNode(s.RDF+"direction"),this.dataFactory.literal(r),o)),i}}valueToJsonString(t){return a(t)}async unaliasKeyword(t,e,n,i,o){if(Number.isInteger(t))return t;if(!i){const t=this.parsingContext.unaliasedKeywordCacheStack[n];if(t)return t}if(!r.Util.isPotentialKeyword(t)){o=o||await this.parsingContext.getContext(e);let n=o.getContextRaw()[t];n&&"object"===typeof n&&(n=n["@id"]),r.Util.isValidKeyword(n)&&(t=n)}return i?t:this.parsingContext.unaliasedKeywordCacheStack[n]=t}async unaliasKeywordParent(t,e){return await this.unaliasKeyword(e>0&&t[e-1],t,e-1)}async unaliasKeywords(t,e,n,r){const i={};for(const o in t)i[await this.unaliasKeyword(o,e,n+1,!0,r)]=t[o];return i}isLiteral(t){for(let e=t;e>=0;e--)if(this.parsingContext.literalStack[e]||this.parsingContext.jsonLiteralStack[e])return!0;return!1}async getDepthOffsetGraph(t,e){for(let n=t-1;n>0;n--)if("@graph"===await this.unaliasKeyword(e[n],e,n)){const r=(await o.EntryHandlerContainer.getContainerHandler(this.parsingContext,e,n)).containers;return o.EntryHandlerContainer.isComplexGraphContainer(r)?-1:t-n-1}return-1}validateReverseSubject(t){if("Literal"===t.termType)throw new r.ErrorCoded("Found illegal literal in subject position: "+t.value,r.ERROR_CODES.INVALID_REVERSE_PROPERTY_VALUE)}getDefaultGraph(){return this.parsingContext.defaultGraph||this.dataFactory.defaultGraph()}async getGraphContainerValue(t,e){let n=this.getDefaultGraph();const{containers:r,depth:i}=await o.EntryHandlerContainer.getContainerHandler(this.parsingContext,t,e);if("@graph"in r){const e=o.EntryHandlerContainer.getContainerGraphIndex(r,i,t),a=this.parsingContext.graphContainerTermStack[i];if(n=a?a[e]:null,!n){let o=null;if("@id"in r){const e=await this.getContainerKey(t[i],t,i);null!==e&&(o=await this.resourceToTerm(await this.parsingContext.getContext(t),e))}o||(o=this.dataFactory.blankNode()),this.parsingContext.graphContainerTermStack[i]||(this.parsingContext.graphContainerTermStack[i]={}),n=this.parsingContext.graphContainerTermStack[i][e]=o}}return n}async getPropertiesDepth(t,e){let n=e;for(let r=e-1;r>0;r--)if("number"!==typeof t[r]){const e=await this.unaliasKeyword(t[r],t,r);if("@reverse"===e)return r;if("@nest"!==e)return n;n=r}return n}async getContainerKey(t,e,n){const r=await this.unaliasKeyword(t,e,n);return"@none"===r?null:r}}e.Util=s,s.XSD="http://www.w3.org/2001/XMLSchema#",s.XSD_BOOLEAN=s.XSD+"boolean",s.XSD_INTEGER=s.XSD+"integer",s.XSD_DOUBLE=s.XSD+"double",s.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#"},"88de":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordGraph=void 0;const r=n("f232");class i extends r.EntryHandlerKeyword{constructor(){super("@graph")}async handle(t,e,n,r,i,o){t.graphStack[o+1]=!0}}e.EntryHandlerKeywordGraph=i},"89fd":function(t,e,n){t.exports=n("0ac3").Transform},"8ccd":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerHandlerIndex=void 0;const r=n("e6e5"),i=n("bfb1"),o=n("882b");class a{canCombineWithGraph(){return!0}async handle(t,e,n,a,s,u){if(!Array.isArray(s)){const c="@graph"in t,l=await e.getContext(a),f=a[u-1],h=o.Util.getContextValueIndex(l,f);if(h){if(r.Util.isPotentialKeyword(h))throw new r.ErrorCoded("Keywords can not be used as @index value, got: "+h,r.ERROR_CODES.INVALID_TERM_DEFINITION);if("string"!==typeof h)throw new r.ErrorCoded("@index values must be strings, got: "+h,r.ERROR_CODES.INVALID_TERM_DEFINITION);if("object"!==typeof s){if("@id"!==o.Util.getContextValueType(l,f))throw new r.ErrorCoded("Property-based index containers require nodes as values or strings with @type: @id, but got: "+s,r.ERROR_CODES.INVALID_VALUE_OBJECT);const t=n.resourceToTerm(l,s);t&&(e.idStack[u+1]=[t])}const t=n.createVocabOrBaseTerm(l,h);if(t){const r=await n.valueToTerm(l,h,await n.getContainerKey(a[u],a,u),u,a);if(c){const i=await n.getGraphContainerValue(a,u+1);for(const o of r)e.emitQuad(u,n.dataFactory.quad(i,t,o,n.getDefaultGraph()))}else for(const o of r)await i.EntryHandlerPredicate.handlePredicateObject(e,n,a,u+1,t,o,!1)}}const d=c?2:1;await e.newOnValueJob(a.slice(0,a.length-d),s,u-d,!0),await e.handlePendingContainerFlushBuffers()}e.emittedStack[u]=!1}}e.ContainerHandlerIndex=a},"8ce0":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Literal=void 0;const r=n("9935");class i{constructor(t,e){this.termType="Literal",this.value=t,"string"===typeof e?(this.language=e,this.datatype=i.RDF_LANGUAGE_STRING):e?(this.language="",this.datatype=e):(this.language="",this.datatype=i.XSD_STRING)}equals(t){return!!t&&"Literal"===t.termType&&t.value===this.value&&t.language===this.language&&t.datatype.equals(this.datatype)}}e.Literal=i,i.RDF_LANGUAGE_STRING=new r.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),i.XSD_STRING=new r.NamedNode("http://www.w3.org/2001/XMLSchema#string")},"966d":function(t,e,n){"use strict";(function(e){function n(t,n,r,i){if("function"!==typeof t)throw new TypeError('"callback" argument must be a function');var o,a,s=arguments.length;switch(s){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick((function(){t.call(null,n)}));case 3:return e.nextTick((function(){t.call(null,n,r)}));case 4:return e.nextTick((function(){t.call(null,n,r,i)}));default:o=new Array(s-1),a=0;while(a<o.length)o[a++]=arguments[a];return e.nextTick((function(){t.apply(null,o)}))}}"undefined"===typeof e||!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports={nextTick:n}:t.exports=e}).call(this,n("4362"))},9935:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NamedNode=void 0;class r{constructor(t){this.termType="NamedNode",this.value=t}equals(t){return!!t&&"NamedNode"===t.termType&&t.value===this.value}}e.NamedNode=r},"9b54":function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=n("f60b").Buffer,o=n(8);function a(t,e,n){t.copy(e,n)}t.exports=function(){function t(){r(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},t.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},t.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(t){if(0===this.length)return"";var e=this.head,n=""+e.data;while(e=e.next)n+=t+e.data;return n},t.prototype.concat=function(t){if(0===this.length)return i.alloc(0);if(1===this.length)return this.head.data;var e=i.allocUnsafe(t>>>0),n=this.head,r=0;while(n)a(n.data,e,r),r+=n.data.length,n=n.next;return e},t}(),o&&o.inspect&&o.inspect.custom&&(t.exports.prototype[o.inspect.custom]=function(){var t=o.inspect({length:this.length});return this.constructor.name+" "+t})},"9d5a":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordType=void 0;const r=n("e6e5"),i=n("882b"),o=n("bfb1"),a=n("f232");class s extends a.EntryHandlerKeyword{constructor(){super("@type")}isStackProcessor(){return!1}async handle(t,e,n,a,s,u){const c=a[u],l=await t.getContext(a),f=e.rdfType,h=i.Util.isPropertyReverse(l,c,await e.unaliasKeywordParent(a,u)),d=Array.isArray(s)?s:[s];for(const i of d){"string"!==typeof i&&t.emitError(new r.ErrorCoded(`Found illegal @type '${i}'`,r.ERROR_CODES.INVALID_TYPE_VALUE));const n=e.createVocabOrBaseTerm(l,i);n&&await o.EntryHandlerPredicate.handlePredicateObject(t,e,a,u,f,n,h)}let p=Promise.resolve(l),y=!1;for(const r of d.sort()){const e=i.Util.getContextValue(l,"@context",r,null);e&&(y=!0,p=p.then(n=>t.parseContext(e,n.getContextRaw())))}!t.streamingProfile||!y&&t.streamingProfileAllowOutOfOrderPlainType||!t.processingStack[u]&&!t.idStack[u]||t.emitError(new r.ErrorCoded("Found an out-of-order type-scoped context, while streaming is enabled.(disable `streamingProfile`)",r.ERROR_CODES.INVALID_STREAMING_KEY_ORDER)),y&&(p=p.then(t=>("@propagate"in t.getContextRaw()||(t.getContextRaw()["@propagate"]=!1),!1===t.getContextRaw()["@propagate"]&&(t.getContextRaw()["@__propagateFallback"]=l.getContextRaw()),t)),t.contextTree.setContext(a.slice(0,a.length-1),p)),t.processingType[u]=!0}}e.EntryHandlerKeywordType=s},a22a:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Variable=void 0;class r{constructor(t){this.termType="Variable",this.value=t}equals(t){return!!t&&"Variable"===t.termType&&t.value===this.value}}e.Variable=r},a640:function(t,e,n){"use strict";var r=n("d039");t.exports=function(t,e){var n=[][t];return!!n&&r((function(){n.call(null,e||function(){throw 1},1)}))}},aa69:function(t,e,n){"use strict";t.exports=o;var r=n("dcd0"),i=Object.create(n("3a7c"));function o(t){if(!(this instanceof o))return new o(t);r.call(this,t)}i.inherits=n("3fb5"),i.inherits(o,r),o.prototype._transform=function(t,e,n){n(null,t)}},ad6d:function(t,e,n){"use strict";var r=n("825a");t.exports=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},ae40:function(t,e,n){var r=n("83ab"),i=n("d039"),o=n("5135"),a=Object.defineProperty,s={},u=function(t){throw t};t.exports=function(t,e){if(o(s,t))return s[t];e||(e={});var n=[][t],c=!!o(e,"ACCESSORS")&&e.ACCESSORS,l=o(e,0)?e[0]:u,f=o(e,1)?e[1]:void 0;return s[t]=!!n&&!i((function(){if(c&&!r)return!0;var t={length:-1};c?a(t,1,{enumerable:!0,get:u}):t[1]=1,n.call(t,l,f)}))}},af6b:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerContainer=void 0;const r=n("c9fc"),i=n("8ccd"),o=n("f071"),a=n("0aac"),s=n("882b");class u{static isSimpleGraphContainer(t){return"@graph"in t&&("@set"in t&&2===Object.keys(t).length||1===Object.keys(t).length)}static isComplexGraphContainer(t){return"@graph"in t&&("@set"in t&&Object.keys(t).length>2||!("@set"in t)&&Object.keys(t).length>1)}static getContainerGraphIndex(t,e,n){let r=u.isSimpleGraphContainer(t),i="";for(let o=e;o<n.length;o++)r&&"number"!==typeof n[o]||(i+=":"+n[o]),r||"number"===typeof n[o]||(r=!0);return i}static async getContainerHandler(t,e,n){const r={containers:{"@set":!0},depth:n,fallback:!0};let i=!1;const o=await t.getContext(e,2);for(let a=n-1;a>=0;a--)if("number"!==typeof e[a]){const t=s.Util.getContextValue(o,"@container",e[a],!1);if(t&&u.isSimpleGraphContainer(t))return{containers:t,depth:a+1,fallback:!1};const n=s.Util.getContextValue(o,"@container",e[a-1],!1);if(n){const t="@graph"in n;for(const e in u.CONTAINER_HANDLERS)if(n[e])return t?u.CONTAINER_HANDLERS[e].canCombineWithGraph()?{containers:n,depth:a,fallback:!1}:r:i?r:{containers:n,depth:a,fallback:!1};return r}if(i)return r;i=!0}return r}static async isBufferableContainerHandler(t,e,n){const r=await u.getContainerHandler(t,e,n);return!r.fallback&&!("@graph"in r.containers)}isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,n,r,i){return!!await this.test(t,e,null,n,r)}async test(t,e,n,r,i){const o=s.Util.getContextValueContainer(await t.getContext(r,2),r[i-1]);for(const a in u.CONTAINER_HANDLERS)if(o[a])return{containers:o,handler:u.CONTAINER_HANDLERS[a]};return null}async handle(t,e,n,r,i,o,a){return a.handler.handle(a.containers,t,e,r,i,o)}}e.EntryHandlerContainer=u,u.CONTAINER_HANDLERS={"@id":new r.ContainerHandlerIdentifier,"@index":new i.ContainerHandlerIndex,"@language":new o.ContainerHandlerLanguage,"@type":new a.ContainerHandlerType}},af7e:function(t,e,n){t.exports=n("6ffa")},bfb1:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerPredicate=void 0;const r=n("e6e5"),i=n("882b");class o{static async handlePredicateObject(t,e,n,r,i,o,a){const s=await e.getPropertiesDepth(n,r),u=await e.getDepthOffsetGraph(r,n),c=r-u,l=t.idStack[s];if(l)for(const f of l){const l=u>=0;if(l){const n=t.idStack[c-1];if(n)for(const s of n)a?(e.validateReverseSubject(o),t.emitQuad(r,e.dataFactory.quad(o,i,f,s))):t.emitQuad(r,e.dataFactory.quad(f,i,o,s));else a?(e.validateReverseSubject(o),t.getUnidentifiedGraphBufferSafe(c-1).push({subject:o,predicate:i,object:f})):t.getUnidentifiedGraphBufferSafe(c-1).push({subject:f,predicate:i,object:o})}else{const u=await e.getGraphContainerValue(n,s);a?(e.validateReverseSubject(o),t.emitQuad(r,e.dataFactory.quad(o,i,f,u))):t.emitQuad(r,e.dataFactory.quad(f,i,o,u))}}else a&&e.validateReverseSubject(o),t.getUnidentifiedValueBufferSafe(s).push({predicate:i,object:o,reverse:a})}isPropertyHandler(){return!0}isStackProcessor(){return!0}async validate(t,e,n,r,o){const a=n[r];if(a){const o=await t.getContext(n);if(await e.predicateToTerm(o,n[r]))return"@json"===i.Util.getContextValueType(o,a)&&(t.jsonLiteralStack[r+1]=!0),!0}return!1}async test(t,e,n,r,i){return r[i]}async handle(t,e,n,a,s,u,c){const l=a[u],f=await t.getContext(a),h=await e.predicateToTerm(f,n);if(h){const c=await e.valueToTerm(f,n,s,u,a);if(c.length)for(let d of c){const c=i.Util.isPropertyReverse(f,l,await e.unaliasKeywordParent(a,u));if(s){const o="@list"in i.Util.getContextValueContainer(f,n);if(o||s["@list"]){if((o&&!Array.isArray(s)&&!s["@list"]||s["@list"]&&!Array.isArray(s["@list"]))&&d!==e.rdfNil){const n=e.dataFactory.blankNode();t.emitQuad(u,e.dataFactory.quad(n,e.rdfRest,e.rdfNil,e.getDefaultGraph())),t.emitQuad(u,e.dataFactory.quad(n,e.rdfFirst,d,e.getDefaultGraph())),d=n}if(c&&!t.allowSubjectList)throw new r.ErrorCoded("Found illegal list value in subject position at "+n,r.ERROR_CODES.INVALID_REVERSE_PROPERTY_VALUE)}}await o.handlePredicateObject(t,e,a,u,h,d,c)}}}}e.EntryHandlerPredicate=o},c13b:function(t,e,n){(function(e){var n={},r=n.LEFT_BRACE=1,i=n.RIGHT_BRACE=2,o=n.LEFT_BRACKET=3,a=n.RIGHT_BRACKET=4,s=n.COLON=5,u=n.COMMA=6,c=n.TRUE=7,l=n.FALSE=8,f=n.NULL=9,h=n.STRING=10,d=n.NUMBER=11,p=n.START=17,y=n.STOP=18,b=n.TRUE1=33,v=n.TRUE2=34,g=n.TRUE3=35,m=n.FALSE1=49,w=n.FALSE2=50,_=n.FALSE3=51,S=n.FALSE4=52,x=n.NULL1=65,C=n.NULL2=66,E=n.NULL3=67,O=n.NUMBER1=81,D=n.NUMBER3=83,T=n.STRING1=97,k=n.STRING2=98,R=n.STRING3=99,P=n.STRING4=100,j=n.STRING5=101,A=n.STRING6=102,I=n.VALUE=113,L=n.KEY=114,N=n.OBJECT=129,M=n.ARRAY=130,F="\\".charCodeAt(0),U="/".charCodeAt(0),V="\b".charCodeAt(0),B="\f".charCodeAt(0),J="\n".charCodeAt(0),G="\r".charCodeAt(0),K="\t".charCodeAt(0),$=65536;function q(){this.tState=p,this.value=void 0,this.string=void 0,this.stringBuffer=e.alloc?e.alloc($):new e($),this.stringBufferOffset=0,this.unicode=void 0,this.highSurrogate=void 0,this.key=void 0,this.mode=void 0,this.stack=[],this.state=I,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:new e(2),3:new e(3),4:new e(4)},this.offset=-1}q.toknam=function(t){for(var e=Object.keys(n),r=0,i=e.length;r<i;r++){var o=e[r];if(n[o]===t)return o}return t&&"0x"+t.toString(16)};var H=q.prototype;H.onError=function(t){throw t},H.charError=function(t,e){this.tState=y,this.onError(new Error("Unexpected "+JSON.stringify(String.fromCharCode(t[e]))+" at position "+e+" in state "+q.toknam(this.tState)))},H.appendStringChar=function(t){this.stringBufferOffset>=$&&(this.string+=this.stringBuffer.toString("utf8"),this.stringBufferOffset=0),this.stringBuffer[this.stringBufferOffset++]=t},H.appendStringBuf=function(t,e,n){var r=t.length;"number"===typeof e&&(r="number"===typeof n?n<0?t.length-e+n:n-e:t.length-e),r<0&&(r=0),this.stringBufferOffset+r>$&&(this.string+=this.stringBuffer.toString("utf8",0,this.stringBufferOffset),this.stringBufferOffset=0),t.copy(this.stringBuffer,this.stringBufferOffset,e,n),this.stringBufferOffset+=r},H.write=function(t){var n;"string"===typeof t&&(t=new e(t));for(var y=0,I=t.length;y<I;y++)if(this.tState===p){if(n=t[y],this.offset++,123===n)this.onToken(r,"{");else if(125===n)this.onToken(i,"}");else if(91===n)this.onToken(o,"[");else if(93===n)this.onToken(a,"]");else if(58===n)this.onToken(s,":");else if(44===n)this.onToken(u,",");else if(116===n)this.tState=b;else if(102===n)this.tState=m;else if(110===n)this.tState=x;else if(34===n)this.string="",this.stringBufferOffset=0,this.tState=T;else if(45===n)this.string="-",this.tState=O;else if(n>=48&&n<64)this.string=String.fromCharCode(n),this.tState=D;else if(32!==n&&9!==n&&10!==n&&13!==n)return this.charError(t,y)}else if(this.tState===T)if(n=t[y],this.bytes_remaining>0){for(var L=0;L<this.bytes_remaining;L++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+L]=t[L];this.appendStringBuf(this.temp_buffs[this.bytes_in_sequence]),this.bytes_in_sequence=this.bytes_remaining=0,y=y+L-1}else if(0===this.bytes_remaining&&n>=128){if(n<=193||n>244)return this.onError(new Error("Invalid UTF-8 character at position "+y+" in state "+q.toknam(this.tState)));if(n>=194&&n<=223&&(this.bytes_in_sequence=2),n>=224&&n<=239&&(this.bytes_in_sequence=3),n>=240&&n<=244&&(this.bytes_in_sequence=4),this.bytes_in_sequence+y>t.length){for(var N=0;N<=t.length-1-y;N++)this.temp_buffs[this.bytes_in_sequence][N]=t[y+N];this.bytes_remaining=y+this.bytes_in_sequence-t.length,y=t.length-1}else this.appendStringBuf(t,y,y+this.bytes_in_sequence),y=y+this.bytes_in_sequence-1}else if(34===n)this.tState=p,this.string+=this.stringBuffer.toString("utf8",0,this.stringBufferOffset),this.stringBufferOffset=0,this.onToken(h,this.string),this.offset+=e.byteLength(this.string,"utf8")+1,this.string=void 0;else if(92===n)this.tState=k;else{if(!(n>=32))return this.charError(t,y);this.appendStringChar(n)}else if(this.tState===k)if(n=t[y],34===n)this.appendStringChar(n),this.tState=T;else if(92===n)this.appendStringChar(F),this.tState=T;else if(47===n)this.appendStringChar(U),this.tState=T;else if(98===n)this.appendStringChar(V),this.tState=T;else if(102===n)this.appendStringChar(B),this.tState=T;else if(110===n)this.appendStringChar(J),this.tState=T;else if(114===n)this.appendStringChar(G),this.tState=T;else if(116===n)this.appendStringChar(K),this.tState=T;else{if(117!==n)return this.charError(t,y);this.unicode="",this.tState=R}else if(this.tState===R||this.tState===P||this.tState===j||this.tState===A){if(n=t[y],!(n>=48&&n<64||n>64&&n<=70||n>96&&n<=102))return this.charError(t,y);if(this.unicode+=String.fromCharCode(n),this.tState++===A){var M=parseInt(this.unicode,16);this.unicode=void 0,void 0!==this.highSurrogate&&M>=56320&&M<57344?(this.appendStringBuf(new e(String.fromCharCode(this.highSurrogate,M))),this.highSurrogate=void 0):void 0===this.highSurrogate&&M>=55296&&M<56320?this.highSurrogate=M:(void 0!==this.highSurrogate&&(this.appendStringBuf(new e(String.fromCharCode(this.highSurrogate))),this.highSurrogate=void 0),this.appendStringBuf(new e(String.fromCharCode(M)))),this.tState=T}}else if(this.tState===O||this.tState===D)switch(n=t[y],n){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 46:case 101:case 69:case 43:case 45:this.string+=String.fromCharCode(n),this.tState=D;break;default:this.tState=p;var $=Number(this.string);if(isNaN($))return this.charError(t,y);this.string.match(/[0-9]+/)==this.string&&$.toString()!=this.string?this.onToken(h,this.string):this.onToken(d,$),this.offset+=this.string.length-1,this.string=void 0,y--;break}else if(this.tState===b){if(114!==t[y])return this.charError(t,y);this.tState=v}else if(this.tState===v){if(117!==t[y])return this.charError(t,y);this.tState=g}else if(this.tState===g){if(101!==t[y])return this.charError(t,y);this.tState=p,this.onToken(c,!0),this.offset+=3}else if(this.tState===m){if(97!==t[y])return this.charError(t,y);this.tState=w}else if(this.tState===w){if(108!==t[y])return this.charError(t,y);this.tState=_}else if(this.tState===_){if(115!==t[y])return this.charError(t,y);this.tState=S}else if(this.tState===S){if(101!==t[y])return this.charError(t,y);this.tState=p,this.onToken(l,!1),this.offset+=4}else if(this.tState===x){if(117!==t[y])return this.charError(t,y);this.tState=C}else if(this.tState===C){if(108!==t[y])return this.charError(t,y);this.tState=E}else if(this.tState===E){if(108!==t[y])return this.charError(t,y);this.tState=p,this.onToken(f,null),this.offset+=3}},H.onToken=function(t,e){},H.parseError=function(t,e){this.tState=y,this.onError(new Error("Unexpected "+q.toknam(t)+(e?"("+JSON.stringify(e)+")":"")+" in state "+q.toknam(this.state)))},H.push=function(){this.stack.push({value:this.value,key:this.key,mode:this.mode})},H.pop=function(){var t=this.value,e=this.stack.pop();this.value=e.value,this.key=e.key,this.mode=e.mode,this.emit(t),this.mode||(this.state=I)},H.emit=function(t){this.mode&&(this.state=u),this.onValue(t)},H.onValue=function(t){},H.onToken=function(t,e){if(this.state===I)if(t===h||t===d||t===c||t===l||t===f)this.value&&(this.value[this.key]=e),this.emit(e);else if(t===r)this.push(),this.value?this.value=this.value[this.key]={}:this.value={},this.key=void 0,this.state=L,this.mode=N;else if(t===o)this.push(),this.value?this.value=this.value[this.key]=[]:this.value=[],this.key=0,this.mode=M,this.state=I;else if(t===i){if(this.mode!==N)return this.parseError(t,e);this.pop()}else{if(t!==a)return this.parseError(t,e);if(this.mode!==M)return this.parseError(t,e);this.pop()}else if(this.state===L)if(t===h)this.key=e,this.state=s;else{if(t!==i)return this.parseError(t,e);this.pop()}else if(this.state===s){if(t!==s)return this.parseError(t,e);this.state=I}else{if(this.state!==u)return this.parseError(t,e);if(t===u)this.mode===M?(this.key++,this.state=I):this.mode===N&&(this.state=L);else{if(!(t===a&&this.mode===M||t===i&&this.mode===N))return this.parseError(t,e);this.pop()}}},q.C=n,t.exports=q}).call(this,n("b639").Buffer)},c154:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordIncluded=void 0;const r=n("e6e5"),i=n("f232");class o extends i.EntryHandlerKeyword{constructor(){super("@included")}async handle(t,e,n,i,o,a){"object"!==typeof o&&t.emitError(new r.ErrorCoded(`Found illegal @included '${o}'`,r.ERROR_CODES.INVALID_INCLUDED_VALUE));const s=await e.unaliasKeywords(o,i,a,await t.getContext(i));"@value"in s&&t.emitError(new r.ErrorCoded(`Found an illegal @included @value node '${JSON.stringify(o)}'`,r.ERROR_CODES.INVALID_INCLUDED_VALUE)),"@list"in s&&t.emitError(new r.ErrorCoded(`Found an illegal @included @list node '${JSON.stringify(o)}'`,r.ERROR_CODES.INVALID_INCLUDED_VALUE)),t.emittedStack[a]=!1}}e.EntryHandlerKeywordIncluded=o},c20d:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),i(n("72aa"),e),i(n("c3f4"),e)},c28b:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordUnknownFallback=void 0;const r=n("e6e5");class i{isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,n,i,o){const a=await e.unaliasKeyword(n[i],n,i);return!!r.Util.isPotentialKeyword(a)&&!(!o&&"@list"===a)}async test(t,e,n,i,o){return r.Util.isPotentialKeyword(n)}async handle(t,e,n,o,a,s){const u=i.VALID_KEYWORDS_TYPES[n];void 0!==u?u&&typeof a!==u.type&&t.emitError(new r.ErrorCoded(`Invalid value type for '${n}' with value '${a}'`,u.errorCode)):t.strictValues&&t.emitError(new Error(`Unknown keyword '${n}' with value '${a}'`)),t.emittedStack[s]=!1}}e.EntryHandlerKeywordUnknownFallback=i,i.VALID_KEYWORDS_TYPES={"@index":{type:"string",errorCode:r.ERROR_CODES.INVALID_INDEX_VALUE},"@list":null,"@reverse":{type:"object",errorCode:r.ERROR_CODES.INVALID_REVERSE_VALUE},"@set":null,"@value":null}},c317:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordId=void 0;const r=n("e6e5"),i=n("f232");class o extends i.EntryHandlerKeyword{constructor(){super("@id")}isStackProcessor(){return!1}async handle(t,e,n,i,o,a){"string"!==typeof o&&t.emitError(new r.ErrorCoded(`Found illegal @id '${o}'`,r.ERROR_CODES.INVALID_ID_VALUE));const s=await e.getPropertiesDepth(i,a);void 0!==t.idStack[s]&&(t.idStack[s][0].listHead?t.emitError(new r.ErrorCoded(`Found illegal neighbouring entries next to @list for key: '${i[a-1]}'`,r.ERROR_CODES.INVALID_SET_OR_LIST_OBJECT)):t.emitError(new r.ErrorCoded(`Found duplicate @ids '${t.idStack[s][0].value}' and '${o}'`,r.ERROR_CODES.COLLIDING_KEYWORDS))),t.idStack[s]=e.nullableTermToArray(await e.resourceToTerm(await t.getContext(i),o))}}e.EntryHandlerKeywordId=o},c3f4:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Util=void 0;const r=n("e6e5");class i{static termToValue(t,e,n={compactIds:!1,useNativeTypes:!1}){switch(t.termType){case"NamedNode":const a=e.compactIri(t.value,n.vocab);return n.compactIds?a:{"@id":a};case"DefaultGraph":return n.compactIds?t.value:{"@id":t.value};case"BlankNode":const s="_:"+t.value;return n.compactIds?s:{"@id":s};case"Literal":if(t.datatype.value===i.RDF_JSON){let e;try{e=JSON.parse(t.value)}catch(o){throw new r.ErrorCoded("Invalid JSON literal: "+o.message,r.ERROR_CODES.INVALID_JSON_LITERAL)}return{"@value":e,"@type":"@json"}}if("i18n-datatype"===n.rdfDirection&&t.datatype.value.startsWith(i.I18N)){const[e,n]=t.datatype.value.substr(i.I18N.length,t.datatype.value.length).split("_");return Object.assign(Object.assign({"@value":t.value},e?{"@language":e}:{}),n?{"@direction":n}:{})}const u=t.datatype.value===i.XSD_STRING,c={"@value":!u&&n.useNativeTypes?i.stringToNativeType(t.value,t.datatype.value):t.value};return t.language?Object.assign(Object.assign({},c),{"@language":t.language}):u||"string"!==typeof c["@value"]?c:Object.assign(Object.assign({},c),{"@type":t.datatype.value})}}static stringToNativeType(t,e){if(e.startsWith(i.XSD)){const n=e.substr(i.XSD.length);switch(n){case"boolean":if("true"===t)return!0;if("false"===t)return!1;throw new Error(`Invalid xsd:boolean value '${t}'`);case"integer":case"number":case"int":case"byte":case"long":const e=parseInt(t,10);if(isNaN(e))throw new Error(`Invalid xsd:integer value '${t}'`);return e;case"float":case"double":const n=parseFloat(t);if(isNaN(n))throw new Error(`Invalid xsd:float value '${t}'`);return n}}return t}}e.Util=i,i.XSD="http://www.w3.org/2001/XMLSchema#",i.XSD_STRING=i.XSD+"string",i.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#",i.RDF_TYPE=i.RDF+"type",i.RDF_JSON=i.RDF+"JSON",i.I18N="https://www.w3.org/ns/i18n#"},c4c0:function(t,e,n){"use strict";var r=n("966d");function i(t,e){var n=this,i=this._readableState&&this._readableState.destroyed,o=this._writableState&&this._writableState.destroyed;return i||o?(e?e(t):!t||this._writableState&&this._writableState.errorEmitted||r.nextTick(a,this,t),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!e&&t?(r.nextTick(a,n,t),n._writableState&&(n._writableState.errorEmitted=!0)):e&&e(t)})),this)}function o(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function a(t,e){t.emit("error",e)}t.exports={destroy:i,undestroy:o}},c513:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),i(n("7096"),e),i(n("13f1"),e),i(n("3e6b"),e),i(n("8ce0"),e),i(n("9935"),e),i(n("8026"),e),i(n("a22a"),e)},c826:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContextTree=void 0;class r{constructor(){this.subTrees={}}getContext(t){if(t.length>0){const[e,...n]=t,r=this.subTrees[e];if(r){const t=r.getContext(n);if(t)return t.then(({context:t,depth:e})=>({context:t,depth:e+1}))}}return this.context?this.context.then(t=>({context:t,depth:0})):null}setContext(t,e){if(0===t.length)this.context=e;else{const[n,...i]=t;let o=this.subTrees[n];o||(o=this.subTrees[n]=new r),o.setContext(i,e)}}removeContext(t){this.setContext(t,null)}}e.ContextTree=r},c9fc:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerHandlerIdentifier=void 0;class r{canCombineWithGraph(){return!0}async handle(t,e,n,r,i,o){let a;if(e.emittedStack[o+1]&&e.idStack[o+1])a=e.idStack[o+1][0];else{const t=await n.getContainerKey(r[o],r,o),i=null!==t?await n.resourceToTerm(await e.getContext(r),r[o]):n.dataFactory.blankNode();if(!i)return void(e.emittedStack[o]=!1);a=i,e.idStack[o+1]=[a]}let s=e.idStack[o];s||(s=e.idStack[o]=[]),s.some(t=>t.equals(a))||s.push(a),await e.handlePendingContainerFlushBuffers()||(e.emittedStack[o]=!1)}}e.ContainerHandlerIdentifier=r},d485:function(t,e,n){t.exports=o;var r=n("faa1").EventEmitter,i=n("3fb5");function o(){r.call(this)}i(o,r),o.Readable=n("0ac3"),o.Writable=n("af7e"),o.Duplex=n("7c16"),o.Transform=n("89fd"),o.PassThrough=n("51a2"),o.Stream=o,o.prototype.pipe=function(t,e){var n=this;function i(e){t.writable&&!1===t.write(e)&&n.pause&&n.pause()}function o(){n.readable&&n.resume&&n.resume()}n.on("data",i),t.on("drain",o),t._isStdio||e&&!1===e.end||(n.on("end",s),n.on("close",u));var a=!1;function s(){a||(a=!0,t.end())}function u(){a||(a=!0,"function"===typeof t.destroy&&t.destroy())}function c(t){if(l(),0===r.listenerCount(this,"error"))throw t}function l(){n.removeListener("data",i),t.removeListener("drain",o),n.removeListener("end",s),n.removeListener("close",u),n.removeListener("error",c),t.removeListener("error",c),n.removeListener("end",l),n.removeListener("close",l),t.removeListener("close",l)}return n.on("error",c),t.on("error",c),n.on("end",l),n.on("close",l),t.on("close",l),t.emit("pipe",n),t}},d6dd:function(t,e,n){"use strict";var r=n("966d"),i=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};t.exports=f;var o=Object.create(n("3a7c"));o.inherits=n("3fb5");var a=n("6f2e"),s=n("6ffa");o.inherits(f,a);for(var u=i(s.prototype),c=0;c<u.length;c++){var l=u[c];f.prototype[l]||(f.prototype[l]=s.prototype[l])}function f(t){if(!(this instanceof f))return new f(t);a.call(this,t),s.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",h)}function h(){this.allowHalfOpen||this._writableState.ended||r.nextTick(d,this)}function d(t){t.end()}Object.defineProperty(f.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(f.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}}),f.prototype._destroy=function(t,e){this.push(null),this.end(),r.nextTick(e,t)}},dcd0:function(t,e,n){"use strict";t.exports=a;var r=n("d6dd"),i=Object.create(n("3a7c"));function o(t,e){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=e&&this.push(e),r(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function a(t){if(!(this instanceof a))return new a(t);r.call(this,t),this._transformState={afterTransform:o.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"===typeof t.transform&&(this._transform=t.transform),"function"===typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",s)}function s(){var t=this;"function"===typeof this._flush?this._flush((function(e,n){u(t,e,n)})):u(this,null,null)}function u(t,e,n){if(e)return t.emit("error",e);if(null!=n&&t.push(n),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}i.inherits=n("3fb5"),i.inherits(a,r),a.prototype.push=function(t,e){return this._transformState.needTransform=!1,r.prototype.push.call(this,t,e)},a.prototype._transform=function(t,e,n){throw new Error("_transform() is not implemented")},a.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},a.prototype._read=function(t){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},a.prototype._destroy=function(t,e){var n=this;r.prototype._destroy.call(this,t,(function(t){e(t),n.emit("close")}))}},ddbf:function(t,e,n){!function(e,n){t.exports=n()}(window,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var r,i=(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=function(t){function e(e){var n=this.constructor,r=t.call(this,e)||this;return r.name=n.name,Object.setPrototypeOf(r,n.prototype),r}return i(e,t),e}(Error),a=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))},s=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},u=new(function(){function t(){this._bootedModels={}}return t.prototype.useEngine=function(t){this._engine=t},t.prototype.model=function(t){return this._bootedModels[t]},t.prototype.loadModel=function(t,e){t in e||(e.boot(t),this._bootedModels[t]=e)},t.prototype.loadModels=function(t){for(var e in t)t.hasOwnProperty(e)&&this.loadModel(e,t[e])},t.prototype.requireEngine=function(){if(!this._engine)throw new o("Engine must be initialized before performing any operations. Learn more at https://soukai.js.org/guide/engines.html");return this._engine},t.prototype.closeConnections=function(){return a(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return this._engine&&"closeConnections"in this._engine?[4,this._engine.closeConnections()]:[2];case 1:return t.sent(),[2]}}))}))},Object.defineProperty(t.prototype,"engine",{get:function(){return this._engine},enumerable:!0,configurable:!0}),t}()),c=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),l=function(t){function e(e,n){var r=t.call(this,"Model "+e+": "+n+". Learn more at https://soukai.js.org/guide/defining-models.html")||this;return r.modelName=e,r}return c(e,t),e}(o),f=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};function h(t){for(var e in t=f({},t))t.hasOwnProperty(e)&&null!==t[e]&&"object"==typeof t[e]&&t[e].constructor===Object&&(t[e]=h(t[e]));return t}function d(t,e){if(t===e)return!0;var n=typeof t;if(n!==typeof e)return!1;if("object"!==n||null===t||null===e)return!1;if(t instanceof Date&&e instanceof Date)return t.getTime()===e.getTime();if(Object.keys(t).length!==Object.keys(e).length)return!1;for(var r in t)if(!d(t[r],e[r]))return!1;return!0}function p(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}var y={deepClone:h,deepEquals:d,isObject:p},b=new(function(){function t(){}return t.prototype.contains=function(t,e){return-1!==t.indexOf(e)},t.prototype.flatten=function(t){return"flat"in t?t.flat():[].concat.apply([],t)},t.prototype.unique=function(t){var e=new Set(t),n=[];return e.forEach((function(t){return n.push(t)})),n},t.prototype.withoutIndexes=function(t,e){var n=this;return t.map((function(t,e){return[t,e]})).filter((function(t){t[0];var r=t[1];return!n.contains(e,r)})).map((function(t){return t[0]}))},t}());function v(t){return t.split(/_|\s/).map((function(t){return t.length>0?t.substr(0,1).toUpperCase()+t.substr(1):t})).join("")}function g(t){return t.split(/_|\s|(?=[A-Z])/).map((function(t,e){return 0===t.length?t:0===e?t.toLowerCase():t.substr(0,1).toUpperCase()+t.substr(1).toLowerCase()})).join("")}var m,w=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))},_=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},S=function(){function t(t,e,n,r){this.related=null,this.deleteStrategy=null,this.parent=t,this.relatedClass=e,this.foreignKeyName=n,this.localKeyName=r||e.primaryKey}return Object.defineProperty(t.prototype,"loaded",{get:function(){return null!==this.related},enumerable:!0,configurable:!0}),t.prototype.getModels=function(){return w(this,void 0,void 0,(function(){return _(this,(function(t){switch(t.label){case 0:return this.loaded?[3,2]:[4,this.resolve()];case 1:t.sent(),t.label=2;case 2:return[2,this.getLoadedModels()]}}))}))},t.prototype.getLoadedModels=function(){return Array.isArray(this.related)?this.related:this.related?[this.related]:[]},t.prototype.unload=function(){this.related=null},t.prototype.onDelete=function(t){return this.deleteStrategy=t,this},t}(),x=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),C=function(t){function e(e,n,r,i){return t.call(this,e,n,r||g(n.name+"_"+n.primaryKey+"s"),i)||this}return x(e,t),e}(S),E=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),O=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))},D=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},T=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return E(e,t),e.prototype.resolve=function(){return O(this,void 0,void 0,(function(){var t,e,n,r;return D(this,(function(i){switch(i.label){case 0:return t=this.parent.getAttribute(this.foreignKeyName),e=this,this.localKeyName!==this.relatedClass.primaryKey?[3,2]:[4,this.relatedClass.all({$in:t})];case 1:return n=i.sent(),[3,4];case 2:return[4,this.relatedClass.all((r={},r[this.localKeyName]={$or:t.map((function(t){return{$eq:t}})).concat(t.map((function(t){return{$contains:t}})))},r))];case 3:n=i.sent(),i.label=4;case 4:return e.related=n,[2,this.related]}}))}))},e}(C),k=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),R=function(t){function e(e,n,r,i){return t.call(this,e,n,r||g(n.name+"_"+n.primaryKey),i)||this}return k(e,t),e}(S),P=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),j=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))},A=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},I=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.resolve=function(){return j(this,void 0,void 0,(function(){var t,e,n,r;return A(this,(function(i){switch(i.label){case 0:return t=this.parent.getAttribute(this.foreignKeyName),e=this,this.localKeyName!==this.relatedClass.primaryKey?[3,2]:[4,this.relatedClass.find(t)];case 1:return n=i.sent(),[3,4];case 2:return[4,this.relatedClass.first((r={},r[this.localKeyName]=t,r))];case 3:n=i.sent(),i.label=4;case 4:return e.related=n,[2,this.related]}}))}))},e}(R),L=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),N=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))},M=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},F=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return L(e,t),e.prototype.resolve=function(){return N(this,void 0,void 0,(function(){var t,e,n;return M(this,(function(r){switch(r.label){case 0:return t=this.parent.getAttribute(this.localKeyName),e=this,[4,this.relatedClass.all((n={},n[this.foreignKeyName]={$or:[{$eq:t},{$contains:t}]},n))];case 1:return e.related=r.sent(),[2,this.related]}}))}))},e}(C),U=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),V=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))},B=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},J=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return U(e,t),e.prototype.resolve=function(){return V(this,void 0,void 0,(function(){var t,e,n;return B(this,(function(r){switch(r.label){case 0:return t=this.parent.getAttribute(this.localKeyName),e=this,[4,this.relatedClass.first((n={},n[this.foreignKeyName]={$or:[{$eq:t},{$contains:t}]},n))];case 1:return e.related=r.sent(),[2,this.related]}}))}))},e}(R),G=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},K=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))},$=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};!function(t){t.Number="number",t.String="string",t.Boolean="boolean",t.Array="array",t.Object="object",t.Date="date",t.Key="key"}(m||(m={}));var q=Object.values(m),H=["createdAt","updatedAt"],W=function(){function t(t,e){if(void 0===t&&(t={}),void 0===e&&(e=!1),!("__pureInstance"in t))return this.modelClass.ensureBooted(),this.initialize(t,e),this._proxy}return Object.defineProperty(t,"instance",{get:function(){return new this},enumerable:!0,configurable:!0}),Object.defineProperty(t,"pureInstance",{get:function(){return new this({__pureInstance:!0})},enumerable:!0,configurable:!0}),t.boot=function(e){var n=this,r={};if(void 0===n.collection)n.collection=e.toLowerCase()+"s";else if("string"!=typeof n.collection)throw new l(e,"Collection name not defined or invalid format");if("boolean"==typeof n.timestamps||void 0===n.timestamps)if(void 0===n.timestamps||n.timestamps){for(var i=0,o=H;i<o.length;i++)r[u=o[i]]={type:m.Date,required:!1};n.timestamps=H}else n.timestamps=[];else{if(!Array.isArray(n.timestamps))throw new l(e,"Invalid timestamps definition");for(var a=0,s=n.timestamps;a<s.length;a++){var u=s[a];if(-1===H.indexOf(u))throw new l(e,"Invalid timestamp field defined ("+u+")");r[u]={type:m.Date,required:!1}}}if(void 0!==n.fields)for(var u in n.fields)if(n.fields.hasOwnProperty(u)&&(r[u]=z(e,u,n.fields[u]),-1!==n.timestamps.indexOf(u)&&(r[u].type!==m.Date||r[u].required)))throw new l(e,"Field "+u+" definition must be type date and not required because it is used an automatic timestamp. Learn more at https://soukai.js.org/guide/defining-models.html#automatic-timestamps");n.primaryKey in r||(r[n.primaryKey]={type:m.Key,required:!1});for(var c=Object.getOwnPropertyNames(n.pureInstance),f=[],h=Object.getPrototypeOf(n.pureInstance);h!==t.prototype;){c.push.apply(c,h.constructor.classFields);for(var d=0,p=Object.getOwnPropertyNames(h);d<p.length;d++){var y=p[d];y.endsWith("Relationship")&&"function"==typeof n.pureInstance[y]&&f.push(y.substring(0,y.length-12))}h=Object.getPrototypeOf(h)}n.classFields=b.unique(c),n.relations=b.unique(f),n.fields=r,n.modelName=e},t.create=function(t){return void 0===t&&(t={}),new this(t).save()},t.createFromEngineDocument=function(t,e){return this.instance.createFromEngineDocument(t,e)},t.createManyFromEngineDocuments=function(t){return this.instance.createManyFromEngineDocuments(t)},t.find=function(t){var e=this;return this.ensureBooted(),u.requireEngine().readOne(this.collection,this.instance.serializeKey(t)).then((function(n){return e.createFromEngineDocument(t,n)})).catch((function(){return null}))},t.all=function(t){return K(this,void 0,void 0,(function(){var e;return $(this,(function(n){switch(n.label){case 0:return this.ensureBooted(),[4,u.requireEngine().readMany(this.collection,t)];case 1:return e=n.sent(),[4,this.createManyFromEngineDocuments(e)];case 2:return[2,n.sent()]}}))}))},t.first=function(t){return K(this,void 0,void 0,(function(){return $(this,(function(e){switch(e.label){case 0:return[4,this.all(t)];case 1:return[2,e.sent()[0]||null]}}))}))},t.ensureBooted=function(){if(void 0===this.modelName)throw new o("Model has not been booted (did you forget to call Soukai.loadModel?) Learn more at https://soukai.js.org/guide/defining-models.html")},Object.defineProperty(t.prototype,"modelClass",{get:function(){return this.constructor},enumerable:!0,configurable:!0}),t.prototype.update=function(t){for(var e in void 0===t&&(t={}),t=this.castAttributes(t,this.modelClass.fields))this.setAttribute(e,t[e]);return this.hasAutomaticTimestamp("updatedAt")&&this.touch(),this.save()},t.prototype.hasRelation=function(t){return-1!==this.modelClass.relations.indexOf(t)},t.prototype.getRelation=function(t){return this._relations[t]||null},t.prototype.loadRelation=function(t){return this.requireRelation(t).resolve()},t.prototype.loadRelationIfUnloaded=function(t){return K(this,void 0,void 0,(function(){return $(this,(function(e){return[2,this.isRelationLoaded(t)?this.getRelationModels(t):this.loadRelation(t)]}))}))},t.prototype.unloadRelation=function(t){this.requireRelation(t).unload()},t.prototype.getRelationModels=function(t){return this.requireRelation(t).related},t.prototype.setRelationModels=function(t,e){this.requireRelation(t).related=e},t.prototype.isRelationLoaded=function(t){return this.requireRelation(t).loaded},t.prototype.hasAttribute=function(t){for(var e=t.split("."),n=Z(this._attributes,this.modelClass.fields);e.length>0;)if(void 0===(n=n[e.shift()]))return!1;return!0},t.prototype.setAttribute=function(t,e){e=this.castAttribute(e,this.modelClass.fields[t]),this._attributes[t]=e,delete this._dirtyAttributes[t],y.deepEquals(this._originalAttributes[t],e)||(this._dirtyAttributes[t]=e),this.hasAutomaticTimestamp("updatedAt")&&"updatedAt"!==t&&this.touch()},t.prototype.setAttributes=function(t){for(var e=0,n=Object.entries(t);e<n.length;e++){var r=n[e],i=r[0],o=r[1];this.setAttribute(i,o)}},t.prototype.getAttribute=function(t,e){void 0===e&&(e=!1);for(var n=t.split("."),r=this.getAttributes(e);n.length>0;)if(void 0===(r=r[n.shift()]))return r;return r},t.prototype.getAttributes=function(t){return void 0===t&&(t=!1),t?h(this._attributes):Z(this._attributes,this.modelClass.fields)},t.prototype.unsetAttribute=function(t){this._attributes.hasOwnProperty(t)&&(t in this.modelClass.fields?this._attributes[t]=void 0:delete this._attributes[t],void 0!==this._originalAttributes[t]&&(this._dirtyAttributes[t]=void 0),this.hasAutomaticTimestamp("updatedAt")&&this.touch())},t.prototype.isDirty=function(t){return t?t in this._dirtyAttributes:Object.values(this._dirtyAttributes).length>0},t.prototype.getPrimaryKey=function(){return this._attributes[this.modelClass.primaryKey]},t.prototype.getSerializedPrimaryKey=function(){var t=this.getPrimaryKey();return t?this.serializeKey(t):null},t.prototype.delete=function(){return K(this,void 0,void 0,(function(){var t;return $(this,(function(e){switch(e.label){case 0:return this._exists?[4,this.getCascadeModels()]:[2,this];case 1:return t=e.sent(),[4,this.deleteModelsFromEngine(t)];case 2:return e.sent(),t.forEach((function(t){return t.resetEngineData()})),[2,this]}}))}))},t.prototype.save=function(){return K(this,void 0,void 0,(function(){var t,e;return $(this,(function(n){switch(n.label){case 0:return Y(this._attributes,this.modelClass.fields),this.isDirty()?(t=this._exists,[4,this.syncDirty()]):[2,this];case 1:return e=n.sent(),this._wasRecentlyCreated=this._wasRecentlyCreated||!t,this._attributes[this.modelClass.primaryKey]=this.parseKey(e),this.cleanDirty(),[2,this]}}))}))},t.prototype.touch=function(){this.setAttribute("updatedAt",new Date)},t.prototype.setExists=function(t){this._exists=t},t.prototype.exists=function(){return this._exists},t.prototype.wasRecentlyCreated=function(){return this._wasRecentlyCreated},t.prototype.initialize=function(t,e){this._exists=e,this._wasRecentlyCreated=!1,this.initializeProxy(),this.initializeAttributes(t,e),this.initializeRelations()},t.prototype.initializeProxy=function(){this._proxy=new Proxy(this,{get:function(t,e,n){if("string"!=typeof e||e in t||-1!==t.modelClass.classFields.indexOf(e))return Reflect.get(t,e,n);var r="get"+v(e)+"Attribute";if("function"==typeof t[r])return t[r]();if(t.hasRelation(e))return t.isRelationLoaded(e)?t.getRelationModels(e):void 0;if(e.startsWith("related")){var i=g(e.substr(7));if(t.hasRelation(i))return t._relations[i]}return t.getAttribute(e)},set:function(t,e,n,r){return"string"!=typeof e||e in t||-1!==t.modelClass.classFields.indexOf(e)?Reflect.set(t,e,n,r):t.hasRelation(e)?(t.setRelationModels(e,n),!0):(t.setAttribute(e,n),!0)},deleteProperty:function(t,e){return"string"!=typeof e||e in t?Reflect.deleteProperty(t,e):t.hasRelation(e)?(t.unloadRelation(e),!0):e in t._attributes&&-1===t.modelClass.classFields.indexOf(e)?(t.unsetAttribute(e),!0):Reflect.deleteProperty(t,e)}})},t.prototype.initializeAttributes=function(t,e){this._attributes=y.deepClone(t),this._originalAttributes=e?y.deepClone(t):{},this._dirtyAttributes=e?{}:y.deepClone(t),e||(this.hasAutomaticTimestamp("createdAt")&&!("createdAt"in t)&&(this._attributes.createdAt=new Date,this._dirtyAttributes.createdAt=this._attributes.createdAt),this.hasAutomaticTimestamp("updatedAt")&&!("updatedAt"in t)&&(this._attributes.updatedAt=new Date,this._dirtyAttributes.updatedAt=this._attributes.updatedAt)),this._attributes=this.castAttributes(X(this._attributes,this.modelClass.fields),this.modelClass.fields)},t.prototype.initializeRelations=function(){var t=this;this._relations=this.modelClass.relations.reduce((function(e,n){var r=t._proxy[g(n)+"Relationship"]();return r.name=n,e[n]=r,e}),{})},t.prototype.createFromEngineDocument=function(t,e){return K(this,void 0,void 0,(function(){var n;return $(this,(function(r){switch(r.label){case 0:return[4,this.parseEngineDocumentAttributes(t,e)];case 1:return(n=r.sent())[this.modelClass.primaryKey]=t,[2,new this.modelClass(n,!0)]}}))}))},t.prototype.createManyFromEngineDocuments=function(t){return K(this,void 0,void 0,(function(){var e=this;return $(this,(function(n){return[2,Promise.all(Object.entries(t).map((function(t){var n=t[0],r=t[1];return e.createFromEngineDocument(e.parseKey(n),r)})))]}))}))},t.prototype.syncDirty=function(){return K(this,void 0,void 0,(function(){var t,e,n;return $(this,(function(r){switch(r.label){case 0:return t=u.requireEngine(),this._exists?(e=this.getDirtyEngineDocumentUpdates(),n=this.getSerializedPrimaryKey(),[4,t.update(this.modelClass.collection,n,e)]):[2,t.create(this.modelClass.collection,this.toEngineDocument(),this.getSerializedPrimaryKey()||void 0)];case 1:return r.sent(),[2,n]}}))}))},t.prototype.cleanDirty=function(){this._originalAttributes=y.deepClone(this._attributes),this._dirtyAttributes={},this._exists=!0},t.prototype.getCascadeModels=function(){return K(this,void 0,void 0,(function(){var t,e,n,r=this;return $(this,(function(i){switch(i.label){case 0:return t=this.modelClass.relations.map((function(t){return r._relations[t]})).filter((function(t){return"cascade"===t.deleteStrategy})).map((function(t){return K(r,void 0,void 0,(function(){return $(this,(function(e){switch(e.label){case 0:return[4,t.getModels()];case 1:return[2,e.sent().map((function(t){return t.getCascadeModels()}))]}}))}))})),[4,Promise.all(t)];case 1:return e=i.sent(),[4,Promise.all(b.flatten(e))];case 2:return n=i.sent(),[2,b.flatten(n).concat([this]).filter((function(t){return t.exists()}))]}}))}))},t.prototype.deleteModelsFromEngine=function(t){return K(this,void 0,void 0,(function(){var e,n;return $(this,(function(r){switch(r.label){case 0:return e=u.requireEngine(),n=t.map((function(t){return[t.modelClass.collection,t.getSerializedPrimaryKey()]})),[4,Promise.all(n.map((function(t){var n=t[0],r=t[1];return e.delete(n,r)})))];case 1:return r.sent(),[2]}}))}))},t.prototype.resetEngineData=function(){delete this._attributes[this.modelClass.primaryKey],this._exists=!1,this._dirtyAttributes=y.deepClone(this._attributes)},t.prototype.hasOne=function(t,e,n){return new J(this,t,e,n)},t.prototype.belongsToOne=function(t,e,n){return new I(this,t,e,n)},t.prototype.hasMany=function(t,e,n){return new F(this,t,e,n)},t.prototype.belongsToMany=function(t,e,n){return new T(this,t,e,n)},t.prototype.castAttributes=function(t,e){var n={};for(var r in t)n[r]=this.castAttribute(t[r],e[r]);return n},t.prototype.castAttribute=function(t,e){var n=this;if(Q(t))return t;if(void 0===e)switch(typeof t){case"object":return t.toString();case"symbol":case"function":case"undefined":return;default:return t}switch(e.type){case m.Date:return new Date(t);case m.Object:return this.castAttributes(t,e.fields);case m.Array:return t.map((function(t){return n.castAttribute(t,e.items)}));case m.Boolean:return!!t;case m.Number:return parseFloat(t);case m.String:return t.toString();default:return t}},t.prototype.hasAutomaticTimestamp=function(t){return-1!==this.modelClass.timestamps.indexOf(t)},t.prototype.toEngineDocument=function(){return Z(this._attributes,this.modelClass.fields)},t.prototype.getDirtyEngineDocumentUpdates=function(){var t=y.deepClone(this._dirtyAttributes);for(var e in t)void 0===t[e]&&(t[e]={$unset:!0});return t},t.prototype.parseEngineDocumentAttributes=function(t,e){return K(this,void 0,void 0,(function(){return $(this,(function(t){return[2,G({},e)]}))}))},t.prototype.serializeKey=function(t){return t.toString()},t.prototype.parseKey=function(t){return t},t.prototype.requireRelation=function(t){if(!(t in this._relations))throw new o("Attempting to use undefined "+t+" relation.");return this._relations[t]},t.primaryKey="id",t.classFields=[],t.relations=[],t}();function z(t,e,n,r){void 0===r&&(r=!0);var i={};if(-1!==q.indexOf(n))i.type=n;else{if("object"!=typeof n)throw new l(t,"Invalid field definition "+e);i=n}if(void 0===i.type)i={fields:i,type:m.Object};else if(-1===q.indexOf(i.type))throw new l(t,"Invalid field definition "+e);switch(r&&(i.required=!!i.required),i.type){case m.Object:if(void 0===i.fields)throw new l(t,"Field definition of type object requires fields attribute "+e);for(var o in i.fields)i.fields.hasOwnProperty(o)&&(i.fields[o]=z(t,o,i.fields[o]));break;case m.Array:if(void 0===i.items)throw new l(t,"Field definition of type array requires items attribute. Field: '"+e+"'");i.items=z(t,"items",i.items,!1)}return i}function X(t,e){for(var n in e){var r=e[n];if(!(n in t))switch(r.type){case m.Object:t[n]={};break;case m.Array:t[n]=[];break;default:t[n]=void 0}r.type===m.Object&&(t[n]=X(t[n],r.fields))}return t}function Y(t,e){for(var n in e){var r=e[n];if(r.required&&(!(n in t)||Q(t[n])))throw new o("The "+n+" attribute is required.");n in t&&!Q(t[n])&&r.type===m.Object&&Y(t[n],r.fields)}}function Q(t){return null==t}function Z(t,e,n){for(var r in void 0===n&&(n=!1),t=h(t))if(void 0===t[r])delete t[r];else if(r in e&&e[r].type===m.Object){var i=Z(t[r],e[r].fields,!0);void 0===i?delete t[r]:t[r]=i}return n&&0===Object.keys(t).length?void 0:t}var tt=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),et=function(t){function e(e){var n=t.call(this,"Could not create document with id "+e+" because it is already in use.")||this;return n.id=e,n}return tt(e,t),e}(o),nt=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),rt=function(t){function e(e){var n=t.call(this,"Couldn't find document with id "+e+".")||this;return n.id=e,n}return nt(e,t),e}(o),it={generate:function t(e){return e?(e^16*Math.random()>>e/4).toString(16):"10000000-1000-4000-8000-100000000000".replace(/[018]/g,t)}},ot=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},at=function(){function t(){var t=this;this.documentsIn=function(t,e,n){return b.contains(n,t)},this.attributeEq=function(t,e,n){return d(t[e],n)},this.attributeContains=function(e,n,r){Array.isArray(r)||(r=[r]);var i=e&&e[n];return!!Array.isArray(i)&&!r.find((function(e){return!i.find((function(n){return t.filterValue(n,e)}))}))},this.attributeOr=function(e,n,r){return!!r.find((function(r){return!!t.filterValue(e,(i={},i[n]=r,i));var i}))},this.attributeIn=function(t,e,n){return b.contains(n,t[e])},this.attributeUpdate=function(e,n,r){p(r)?t.isOperation(r,t.attributeUpdates)?t.runOperation(r,t.attributeUpdates,e,n):p(e[n])?t.updateAttributes(e[n],r):e[n]=r:e[n]=r},this.attributeUpdateItems=function(e,n,r){Array.isArray(r)||(r=[r]);for(var i=function(r,i,o){r&&r.$in&&(r.$in=r.$in.map((function(t){return t.toString()})));var a=t.requireArrayProperty("$updateItems",e,n),s=t.filterDocuments(a.reduce((function(t,e,n){return ot({},t,((r={})[n]=p(e)?e:{},r));var r}),{}),r||{});i&&Object.keys(s).forEach((function(e){var n;t.updateAttributes(s,((n={})[e]=i,n)),a[e]=s[e]})),o&&(e[n]=b.withoutIndexes(a,Object.keys(s).map(parseInt)))},o=0,a=r;o<a.length;o++){var s=a[o];i(s.$where,s.$update,s.$unset)}},this.attributePush=function(e,n,r){t.requireArrayProperty("$push",e,n).push(r)},this.attributeUnset=function(t,e,n){if(!0!==n)for(var r=0,i=n=Array.isArray(n)?n:[n];r<i.length;r++){var o=i[r];delete t[e][o]}else delete t[e]},this.attributeApply=function(e,n,r){for(var i=0,o=r;i<o.length;i++){var a=o[i];t.runOperation(a,t.attributeUpdates,e,n)}},this.rootFilters={$in:this.documentsIn},this.attributeFilters={$eq:this.attributeEq,$contains:this.attributeContains,$or:this.attributeOr,$in:this.attributeIn},this.attributeUpdates={$update:this.attributeUpdate,$updateItems:this.attributeUpdateItems,$push:this.attributePush,$unset:this.attributeUnset,$apply:this.attributeApply}}return t.prototype.filterDocuments=function(t,e){var n=this;return void 0===e&&(e={}),Object.entries(t).reduce((function(t,r){var i=r[0],o=r[1];return n.filterDocument(i,o,e)&&(t[i]=o),t}),{})},t.prototype.updateAttributes=function(t,e){if(this.isOperation(e,{$unset:this.attributeUnset}))for(var n=e.$unset,r=0,i=Array.isArray(n)?n:[n];r<i.length;r++){var o=i[r];this.attributeUnset(t,o,!0)}else for(var a=0,s=Object.entries(e);a<s.length;a++){var u=s[a],c=u[0],l=u[1];this.attributeUpdate(t,c,l)}},t.prototype.obtainDocumentId=function(t){return t||it.generate()},t.prototype.filterDocument=function(t,e,n){var r=this;void 0===n&&(n={}),n=ot({},n);for(var i=0,o=Object.keys(n).filter((function(t){return t in r.rootFilters}));i<o.length;i++){var a=o[i];if(!this.rootFilters[a](t,e,n[a]))return!1;delete n[a]}return this.filterValue(e,n)},t.prototype.filterValue=function(t,e){var n=this;return void 0===e&&(e={}),p(e)?this.isOperation(e,this.attributeFilters)?this.runOperation(e,this.attributeFilters,{value:t},"value"):!!p(t)&&!Object.entries(e).find((function(e){var r=e[0],i=e[1];return!(n.isOperation(i,n.attributeFilters)?n.runOperation(i,n.attributeFilters,t,r):n.attributeEq(t,r,i))})):this.attributeEq({value:t},"value",e)},t.prototype.isOperation=function(t,e){if(!p(t))return!1;var n=Object.keys(t),r=n[0],i=n.slice(1);return!(!r||0!==i.length||!(r in e))},t.prototype.runOperation=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=Object.entries(t)[0],o=i[0],a=i[1];return e[o].apply(e,n.concat([a]))},t.prototype.requireArrayProperty=function(t,e,n){if(!e||!Array.isArray(e[n]))throw new Error(t+" operator can only be applied to array attributes");return e[n]},t}();let st,ut;const ct=new WeakMap,lt=new WeakMap,ft=new WeakMap,ht=new WeakMap,dt=new WeakMap;let pt={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return lt.get(t);if("objectStoreNames"===e)return t.objectStoreNames||ft.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return vt(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function yt(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(ut||(ut=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(gt(this),e),vt(ct.get(this))}:function(...e){return vt(t.apply(gt(this),e))}:function(e,...n){const r=t.call(gt(this),e,...n);return ft.set(r,e.sort?e.sort():[e]),vt(r)}}function bt(t){return"function"==typeof t?yt(t):(t instanceof IDBTransaction&&function(t){if(lt.has(t))return;const e=new Promise((e,n)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{e(),r()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});lt.set(t,e)}(t),e=t,(st||(st=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(t=>e instanceof t)?new Proxy(t,pt):t);var e}function vt(t){if(t instanceof IDBRequest)return function(t){const e=new Promise((e,n)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{e(vt(t.result)),r()},o=()=>{n(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(e=>{e instanceof IDBCursor&&ct.set(e,t)}).catch(()=>{}),dt.set(e,t),e}(t);if(ht.has(t))return ht.get(t);const e=bt(t);return e!==t&&(ht.set(t,e),dt.set(e,t)),e}const gt=t=>dt.get(t);function mt(t,e,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){const a=indexedDB.open(t,e),s=vt(a);return r&&a.addEventListener("upgradeneeded",t=>{r(vt(a.result),t.oldVersion,t.newVersion,vt(a.transaction))}),n&&a.addEventListener("blocked",()=>n()),s.then(t=>{o&&t.addEventListener("close",()=>o()),i&&t.addEventListener("versionchange",()=>i())}).catch(()=>{}),s}function wt(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",()=>e()),vt(n).then(()=>{})}const _t=["get","getKey","getAll","getAllKeys","count"],St=["put","add","delete","clear"],xt=new Map;function Ct(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(xt.get(e))return xt.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=St.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!_t.includes(n))return;const o=async function(t,...e){const o=this.transaction(t,i?"readwrite":"readonly");let a=o.store;r&&(a=a.index(e.shift()));const s=a[n](...e);return i&&await o.done,s};return xt.set(e,o),o}pt=(t=>({...t,get:(e,n,r)=>Ct(e,n)||t.get(e,n,r),has:(e,n)=>!!Ct(e,n)||t.has(e,n)}))(pt);var Et=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Ot=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Dt=function(){function t(t){void 0===t&&(t=null),this.database=t?"soukai-"+t:"soukai",this.helper=new at}return t.prototype.purgeDatabase=function(){return Et(this,void 0,void 0,(function(){var t=this;return Ot(this,(function(e){switch(e.label){case 0:return this.closeConnections(),[4,Promise.all([wt(this.database+"-meta",{blocked:function(){return t.throwDatabaseBlockedError()}}),wt(this.database,{blocked:function(){return t.throwDatabaseBlockedError()}})])];case 1:return e.sent(),[2]}}))}))},t.prototype.closeConnections=function(){return Et(this,void 0,void 0,(function(){return Ot(this,(function(t){return this.metadataConnection&&this.metadataConnection.close(),this.documentsConnection&&this.documentsConnection.close(),delete this.metadataConnection,delete this.documentsConnection,[2]}))}))},t.prototype.create=function(t,e,n){return Et(this,void 0,void 0,(function(){var r;return Ot(this,(function(i){switch(i.label){case 0:return n=this.helper.obtainDocumentId(n),[4,this.startDocumentsTransaction("readwrite",t,!0)];case 1:return[4,(r=i.sent()).store.get(n)];case 2:if(i.sent())throw new et(n);return r.store.add(e,n),[4,r.done];case 3:return i.sent(),[2,n]}}))}))},t.prototype.readOne=function(t,e){return Et(this,void 0,void 0,(function(){var n,r;return Ot(this,(function(i){switch(i.label){case 0:return[4,this.startDocumentsTransaction("readonly",t)];case 1:if(!(n=i.sent()))throw new rt(e);return[4,n.store.get(e)];case 2:if(!(r=i.sent()))throw new rt(e);return[2,r]}}))}))},t.prototype.readMany=function(t,e){return Et(this,void 0,void 0,(function(){var n,r,i;return Ot(this,(function(o){switch(o.label){case 0:return[4,this.startDocumentsTransaction("readonly",t)];case 1:return n=o.sent(),r={},n?[4,n.store.openCursor()]:[2,r];case 2:i=o.sent(),o.label=3;case 3:if(null===i)return[3,6];r[i.key]=i.value,o.label=4;case 4:return[4,i.continue()];case 5:return i=o.sent(),[3,3];case 6:return[2,this.helper.filterDocuments(r,e)]}}))}))},t.prototype.update=function(t,e,n){return Et(this,void 0,void 0,(function(){var r,i;return Ot(this,(function(o){switch(o.label){case 0:return[4,this.startDocumentsTransaction("readwrite",t,!0)];case 1:return[4,(r=o.sent()).store.get(e)];case 2:if(!(i=o.sent()))throw new rt(e);return this.helper.updateAttributes(i,n),r.store.put(i,e),[4,r.done];case 3:return o.sent(),[2]}}))}))},t.prototype.delete=function(t,e){return Et(this,void 0,void 0,(function(){var n;return Ot(this,(function(r){switch(r.label){case 0:return[4,this.startDocumentsTransaction("readwrite",t)];case 1:if(!(n=r.sent()))throw new rt(e);return[4,n.store.get(e)];case 2:if(!r.sent())throw new rt(e);return n.store.delete(e),[4,n.done];case 3:return r.sent(),[2]}}))}))},t.prototype.startDocumentsTransaction=function(t,e,n){return void 0===n&&(n=!1),Et(this,void 0,void 0,(function(){var r,i,o,a,s=this;return Ot(this,(function(u){switch(u.label){case 0:return[4,this.startMetadataTransaction("readwrite")];case 1:return[4,(r=u.sent()).store.getAllKeys()];case 2:return-1!==(i=u.sent()).indexOf(e)?[3,4]:n?(i.push(e),r.store.add({name:e}),[4,r.done]):[2,null];case 3:u.sent(),this.documentsConnection&&(this.documentsConnection.close(),delete this.documentsConnection),u.label=4;case 4:return o=this,(a=this.documentsConnection)?[3,6]:[4,mt(this.database,i.length,{upgrade:function(t){for(var e=0,n=i;e<n.length;e++){var r=n[e];t.objectStoreNames.contains(r)||t.createObjectStore(r)}},blocked:function(){return s.throwDatabaseBlockedError()}})];case 5:a=u.sent(),u.label=6;case 6:return o.documentsConnection=a,[2,this.documentsConnection.transaction(e,t)]}}))}))},t.prototype.startMetadataTransaction=function(t){return Et(this,void 0,void 0,(function(){var e,n,r=this;return Ot(this,(function(i){switch(i.label){case 0:return e=this,(n=this.metadataConnection)?[3,2]:[4,mt(this.database+"-meta",1,{upgrade:function(t){t.objectStoreNames.contains("collections")||t.createObjectStore("collections",{keyPath:"name"})},blocked:function(){return r.throwDatabaseBlockedError()}})];case 1:n=i.sent(),i.label=2;case 2:return e.metadataConnection=n,[2,this.metadataConnection.transaction("collections",t)]}}))}))},t.prototype.throwDatabaseBlockedError=function(){throw new o("An attempt to open an IndexedDB connection has been blocked, remember to call IndexedDBEngine.closeConnections when necessary. Learn more at https://developer.mozilla.org/en-US/docs/Web/API/IDBOpenDBRequest/blocked_event")},t}(),Tt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))},kt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Rt=function(){function t(){this.db={},this.helper=new at}return Object.defineProperty(t.prototype,"database",{get:function(){return this.db},enumerable:!0,configurable:!0}),t.prototype.create=function(t,e,n){var r=this.collection(t);if((n=this.helper.obtainDocumentId(n))in r)throw new et(n);return r[n]=e,Promise.resolve(n)},t.prototype.readOne=function(t,e){var n=this.collection(t);return e in n?Promise.resolve(n[e]):Promise.reject(new rt(e))},t.prototype.readMany=function(t,e){return Tt(this,void 0,void 0,(function(){var n;return kt(this,(function(r){return this.hasCollection(t)?(n=this.collection(t),[2,this.helper.filterDocuments(n,e)]):[2,{}]}))}))},t.prototype.update=function(t,e,n){var r=this.collection(t);if(e in r){var i=r[e];return this.helper.updateAttributes(i,n),Promise.resolve()}return Promise.reject(new rt(e))},t.prototype.delete=function(t,e){var n=this.collection(t);return e in n?(delete n[e],Promise.resolve()):Promise.reject(new rt(e))},t.prototype.hasCollection=function(t){return t in this.db},t.prototype.collection=function(t){return this.hasCollection(t)||(this.db[t]={}),this.db[t]},t}(),Pt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))},jt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},At=function(){function t(t){void 0===t&&(t=""),this.prefix=t,this.helper=new at}return t.prototype.clear=function(){for(var t=0,e=Object.keys(localStorage);t<e.length;t++){var n=e[t];n.startsWith(this.prefix)&&localStorage.removeItem(n)}},t.prototype.create=function(t,e,n){return Pt(this,void 0,void 0,(function(){var r;return jt(this,(function(i){if(r=this.readItem(t,{}),(n=this.helper.obtainDocumentId(n))in r)throw new et(n);return r[n]=this.serializeAttributes(e),this.writeItem(t,r),[2,n]}))}))},t.prototype.readOne=function(t,e){return Pt(this,void 0,void 0,(function(){var n;return jt(this,(function(r){if(n=this.readItem(t,{}),!(e in n))throw new rt(e);return[2,this.deserializeAttributes(n[e])]}))}))},t.prototype.readMany=function(t,e){return Pt(this,void 0,void 0,(function(){var n,r;return jt(this,(function(i){for(r in n=this.readItem(t,{}))n[r]=this.deserializeAttributes(n[r]);return[2,this.helper.filterDocuments(n,e)]}))}))},t.prototype.update=function(t,e,n){return Pt(this,void 0,void 0,(function(){var r,i;return jt(this,(function(o){if(r=this.readItem(t,{}),!(e in r))throw new rt(e);return i=this.deserializeAttributes(r[e]),this.helper.updateAttributes(i,n),r[e]=this.serializeAttributes(i),this.writeItem(t,r),[2]}))}))},t.prototype.delete=function(t,e){return Pt(this,void 0,void 0,(function(){var n;return jt(this,(function(r){if(n=this.readItem(t,{}),!(e in n))throw new rt(e);return delete n[e],this.writeItem(t,n),[2]}))}))},t.prototype.readItem=function(t,e){void 0===e&&(e=null);var n=localStorage.getItem(this.prefix+t);return null!==n?JSON.parse(n):e},t.prototype.writeItem=function(t,e){localStorage.setItem(this.prefix+t,JSON.stringify(e))},t.prototype.serializeAttributes=function(t){for(var e in t){var n=t[e];t[e]=this.serializeAttributeValue(n)}return t},t.prototype.serializeAttributeValue=function(t){var e=this;return Array.isArray(t)?t.map((function(t){return e.serializeAttributeValue(t)})):t instanceof Date?{__dateTime:t.getTime()}:"object"==typeof t?this.serializeAttributes(t):t},t.prototype.deserializeAttributes=function(t){for(var e in t){var n=t[e];t[e]=this.deserializeAttributeValue(n)}return t},t.prototype.deserializeAttributeValue=function(t){var e=this;return Array.isArray(t)?t.map((function(t){return e.deserializeAttributeValue(t)})):"object"==typeof t&&"__dateTime"in t?new Date(t.__dateTime):t},t}(),It=function(){function t(t){this.engine=t}return t.prototype.create=function(t,e,n){return console.log("CREATE",t,e,n),this.engine.create(t,e,n).then((function(t){return console.log("CREATED",t),t})).catch((function(t){throw console.error(t),t}))},t.prototype.readOne=function(t,e){return console.log("READ ONE",t,e),this.engine.readOne(t,e).then((function(t){return console.log("FOUND",t),t})).catch((function(t){throw console.error(t),t}))},t.prototype.readMany=function(t,e){return console.log("READ ALL",t,e),this.engine.readMany(t,e).then((function(t){return console.log("FOUND",t),t})).catch((function(t){throw console.error(t),t}))},t.prototype.update=function(t,e,n){return console.log("UPDATE",t,e,n),this.engine.update(t,e,n).then((function(){return console.log("UPDATED")})).catch((function(t){throw console.error(t),t}))},t.prototype.delete=function(t,e){return console.log("DELETE",t,e),this.engine.delete(t,e).then((function(){return console.log("DELETED")})).catch((function(t){throw console.error(t),t}))},t}();function Lt(t){for(var e={},n=0,r=t.keys();n<r.length;n++){var i=r[n],o=(i.match(/^(?:\.\/)?(.+)\.(j|t)s$/)||[])[1];void 0!==o&&(e[o]=t(i).default)}return e}n.d(e,"definitionsFromContext",(function(){return Lt})),n.d(e,"Model",(function(){return W})),n.d(e,"Soukai",(function(){return u})),n.d(e,"EngineHelper",(function(){return at})),n.d(e,"LogEngine",(function(){return It})),n.d(e,"InMemoryEngine",(function(){return Rt})),n.d(e,"LocalStorageEngine",(function(){return At})),n.d(e,"IndexedDBEngine",(function(){return Dt})),n.d(e,"SoukaiError",(function(){return o})),n.d(e,"DocumentNotFound",(function(){return rt})),n.d(e,"DocumentAlreadyExists",(function(){return et})),n.d(e,"InvalidModelDefinition",(function(){return l})),n.d(e,"BelongsToManyRelation",(function(){return T})),n.d(e,"BelongsToOneRelation",(function(){return I})),n.d(e,"HasManyRelation",(function(){return F})),n.d(e,"HasOneRelation",(function(){return J})),n.d(e,"MultiModelRelation",(function(){return C})),n.d(e,"Relation",(function(){return S})),n.d(e,"SingleModelRelation",(function(){return R})),n.d(e,"FieldType",(function(){return m})),e.default=u}])}))},dfab:function(t,e,n){!function(e,r){t.exports=r(n("ddbf"),n("50cc"),n("c20d"),n("dae0"))}(window,(function(t,e,n,r){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=4)}([function(e,n){e.exports=t},function(t,n){t.exports=e},function(t,e){t.exports=n},function(t,e){t.exports=r},function(t,e,n){"use strict";n.r(e),n.d(e,"DocumentFormat",(function(){return Lt})),n.d(e,"MalformedDocumentError",(function(){return Gt})),n.d(e,"NetworkError",(function(){return $t})),n.d(e,"SolidContainerModel",(function(){return Se})),n.d(e,"SolidDocument",(function(){return Ft})),n.d(e,"SolidEngine",(function(){return ce})),n.d(e,"SolidModel",(function(){return Nt}));var r,i=n(0),o=n.n(i),a=n(1),s=n(2),u=n(3),c=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},l=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(c(arguments[e]));return t},f=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},h=new(function(){function t(){}return t.prototype.resolve=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=t.shift();t.length>0;){var r=t.shift();r.startsWith("/")?n=this.base(n)+r:r.startsWith("http://")||r.startsWith("https://")?n=r:n.endsWith("/")?n+=r:n+="/"+r}return n},t.prototype.resolveDirectory=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this.resolve.apply(this,l(t));return n.endsWith("/")?n:n+"/"},t.prototype.base=function(t){var e=t.indexOf("://"),n=t.substr(e+3).indexOf("/");return-1!==n?t.substring(0,e+3+n):t},t.prototype.parentDirectory=function(t){t.endsWith("/")&&(t=t.substring(0,t.length-1));var e=t.lastIndexOf("/");return-1!==e?t.substr(0,e+1):t},t.prototype.filename=function(t){var e=t.lastIndexOf("/");return-1!==e?t.substr(e+1):""},t.prototype.parse=function(t){var e=t.trim().match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/);if(!e)return null;var n=e[4]||"",r=c(-1===n.indexOf(":")?[n]:n.split(":"),2),i=r[0],o=r[1];return{protocol:e[2]||void 0,domain:i||void 0,port:o||void 0,path:e[5]||void 0,query:e[7]||void 0,fragment:e[9]||void 0}},t.prototype.clean=function(t,e){var n,r,i=this.parse(t);if(!i)return t;try{for(var o=f(Object.entries(i)),a=o.next();!a.done;a=o.next()){var s=c(a.value,2),u=s[0],l=s[1];i[u]=!1!==e[u]&&l||""}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return[i.protocol?i.protocol+"://":"",i.domain||"",i.port?":"+i.port:"",i.path||"",i.query?"?"+i.query:"",i.fragment?"#"+i.fragment:""].join("")},t.prototype.route=function(t){return this.clean(t,{protocol:!0,domain:!0,port:!0,path:!0,query:!1,fragment:!1})},t}()),d=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),p=function(t){this.name=t},y=function(){function t(t,e,n){this.resourceUrl=t,this.name=e,this.value=n}return t.fromStatement=function(t){var e="NamedNode"===t.subject.termType?t.subject.value:null;return t.predicate.value===V("rdf:type")?this.type(e,t.object.value):"NamedNode"===t.object.termType?this.reference(e,t.predicate.value,t.object.value):"BlankNode"===t.object.termType?this.reference(e,t.predicate.value,null):"Variable"===t.object.termType?this.reference(e,t.predicate.value,new p(t.object.value)):this.literal(e,t.predicate.value,t.object.datatype.value===V("xsd:dateTime")?new Date(t.object.value):t.object.value)},t.literal=function(t,e,n){return new b(t,e,n)},t.reference=function(t,e,n){return new v(t,e,n)},t.type=function(t,e){return new g(t,e)},t.toTurtle=function(t,e){return void 0===e&&(e=null),t.map((function(t){return t.toTurtle(e)+" ."})).join("\n")},t.prototype.toTurtle=function(t){return void 0===t&&(t=null),this.getTurtleSubject(t)+" "+this.getTurtlePredicate()+" "+this.getTurtleObject(t)},t.prototype.clone=function(e){switch(e=null!=e?e:this.resourceUrl,this.type){case 2:return t.literal(e,this.name,this.value);case 0:return t.type(e,this.value);case 1:return t.reference(e,this.name,this.value)}},t.prototype.getTurtleReference=function(t,e){var n=null==t?void 0:t.indexOf("#");return t&&t!==e?null!==e&&t.startsWith(e)&&-1!==n?"<#"+t.substr(n+1)+">":"<"+encodeURI(t)+">":"<>"},t.prototype.getTurtleSubject=function(t){return this.getTurtleReference(this.resourceUrl,t)},t.prototype.getTurtlePredicate=function(){return"<"+encodeURI(this.name)+">"},t}(),b=function(t){function e(e,n,r){var i=t.call(this,e,n,r)||this;return i.type=2,i}return d(e,t),e.prototype.getTurtleObject=function(){if(this.value instanceof Date){var t=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.map((function(t){return t.toString().padStart(2,"0")}))};return'"'+t(this.value.getUTCFullYear(),this.value.getUTCMonth()+1,this.value.getUTCDate()).join("-")+"T"+t(this.value.getUTCHours(),this.value.getUTCMinutes(),this.value.getUTCSeconds()).join(":")+'Z"^^<'+V("xsd:dateTime")+">"}return JSON.stringify(this.value)},e}(y),v=function(t){function e(e,n,r){var i=t.call(this,e,n,r)||this;return i.type=1,i}return d(e,t),e.prototype.getTurtleObject=function(t){return this.value instanceof p?this.value.name:this.getTurtleReference(this.value,t)},e}(y),g=function(t){function e(e,n){var r=t.call(this,e,V("rdf:type"),n)||this;return r.type=0,r}return d(e,t),e.prototype.getTurtlePredicate=function(){return"a"},e.prototype.getTurtleObject=function(){return"<"+encodeURI(this.value)+">"},e}(y),m=y,w=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},_=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(w(arguments[e]));return t},S=function(){function t(t){this.url=t,this.statements=[],this.types=[],this.properties=[],this.propertiesIndex={}}return Object.defineProperty(t.prototype,"name",{get:function(){return this.getPropertyValue(V("foaf:name"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"label",{get:function(){return this.getPropertyValue(V("rdfs:label"))},enumerable:!0,configurable:!0}),t.prototype.isType=function(t){return-1!==this.types.indexOf(V(t))},t.prototype.getPropertyValue=function(t,e){void 0===e&&(e=null);var n=w(this.propertiesIndex[V(t)]||[],1)[0];return n?n.value:e},t.prototype.getPropertyValues=function(t){return(this.propertiesIndex[V(t)]||[]).map((function(t){return t.value}))},t.prototype.addStatement=function(t){if(t.subject.value===this.url){var e=m.fromStatement(t);0===e.type&&this.types.push(e.value),this.statements.push(t),this.properties.push(e),this.propertiesIndex[e.name]=_(this.propertiesIndex[e.name]||[],[e])}},t}(),x=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},C=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(x(arguments[e]));return t},E=new(function(){function t(){}return t.prototype.create=function(t){return Array.isArray(t)?t:[t]},t.prototype.clean=function(t){return t.filter((function(t){return!!t}))},t.prototype.contains=function(t,e){return-1!==t.indexOf(e)},t.prototype.filter=function(t){return t.filter((function(t){return!!t}))},t.prototype.flatten=function(t){return t.reduce((function(t,e){return C(t,e)}),[])},t.prototype.last=function(t){return t[t.length-1]},t.prototype.make=function(t,e){return void 0===e&&(e=null),new Array(t).fill(e)},t.prototype.range=function(t){for(var e=[],n=0;n<t;n++)e.push(n);return e},t.prototype.removeItem=function(t,e){var n=t.indexOf(e);return-1!==n&&t.splice(n,1),e},t.prototype.unique=function(t,e){void 0===e&&(e=null);var n=t.map((function(t){return e?e(t):t}));return t.filter((function(t,e){return n.indexOf(n[e])===e}))},t.prototype.without=function(t,e){return t.filter((function(t){return-1===e.indexOf(t)}))},t.prototype.zip=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=function(e){n.push(t.map((function(t){return t[e]})))},i=0;i<t[0].length;i++)r(i);return n},t}()),O=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},D=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},T=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},k=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(T(arguments[e]));return t},R=function(){function t(t,e,n){void 0===e&&(e=[]),void 0===n&&(n={}),this.url=t,this.statements=e,this.metadata=n,this.resourcesIndex=this.statements.reduce((function(t,e){var n=e.subject.value;return n in t||(t[n]=new S(n)),t[n].addStatement(e),t}),{}),this.resources=Object.values(this.resourcesIndex),this.properties=this.resources.reduce((function(t,e){return k(t,e.properties)}),[])}return t.prototype.isEmpty=function(){return 0===this.statements.length},t.prototype.hasProperty=function(t,e){return t in this.resourcesIndex&&e in this.resourcesIndex[t].propertiesIndex},t.prototype.toJsonLD=function(){return O(this,void 0,void 0,(function(){return D(this,(function(t){return[2,B.createJsonLD(this.statements)]}))}))},t.prototype.resource=function(t){var e;return null!==(e=this.resourcesIndex[t])&&void 0!==e?e:null},t.prototype.clone=function(e){var n=this;void 0===e&&(e=null);var r=new t(e||this.url),i=E.without(Object.getOwnPropertyNames(this),["url"]);return Object.assign(r,i.reduce((function(t,e){return t[e]=n[e],t}),{})),r},t}(),P=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),j=function(){return(j=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},A=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},I=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},L=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},N=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(L(arguments[e]));return t},M=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},F={foaf:"http://xmlns.com/foaf/0.1/",ldp:"http://www.w3.org/ns/ldp#",pim:"http://www.w3.org/ns/pim/space#",posix:"http://www.w3.org/ns/posix/stat#",purl:"http://purl.org/dc/terms/",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",schema:"https://schema.org/",solid:"http://www.w3.org/ns/solid/terms#",xsd:"http://www.w3.org/2001/XMLSchema#"},U=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e}(i.SoukaiError);function V(t,e){if(void 0===e&&(e={}),/^https?:\/\//.test(t))return t;var n=t.indexOf(":");if(-1===n)return t;e=j(j({},F),e);var r=t.substr(0,n);return r in e?e[r]+t.substr(r.length+1):t}var B=new(function(){function t(){}return t.prototype.parseTurtle=function(t,e){var n=this;return void 0===e&&(e={}),new Promise((function(r,i){var o=[],a=new u.Parser({baseIRI:e.baseUrl||"",format:e.format||"text/turtle"}),s={containsRelativeIRIs:!1,describedBy:n.getDescribedBy(e)},c=a._resolveRelativeIRI;a._resolveRelativeIRI=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return s.containsRelativeIRIs=!0,a._resolveRelativeIRI=c,a._resolveRelativeIRI.apply(a,N(t))},a.parse(t,(function(t,n){t?i(new U(t.message)):n?o.push(n):r(new R(e.baseUrl||"",o,s))}))}))},t.prototype.parseJsonLD=function(t){return A(this,void 0,void 0,(function(){return I(this,(function(e){return[2,new Promise((function(e,n){var r=[],i=new a.JsonLdParser({baseIRI:t["@id"]||""});i.on("data",(function(t){r.push(t)})),i.on("error",n),i.on("end",(function(){return e(new R(t["@id"]||null,r))})),i.write(JSON.stringify(t)),i.end()}))]}))}))},t.prototype.createJsonLD=function(t){return A(this,void 0,void 0,(function(){return I(this,(function(e){return t.sort((function(t,e){return t.subject.value.localeCompare(e.subject.value)})),[2,new Promise((function(e,n){var r,i,o=new s.JsonLdSerializer,a="";o.on("data",(function(t){return a+=t})),o.on("error",n),o.on("end",(function(){return e({"@graph":JSON.parse(a)})}));try{for(var u=M(t),c=u.next();!c.done;c=u.next()){var l=c.value;o.write(l)}}catch(t){r={error:t}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}o.end()}))]}))}))},t.prototype.flattenJsonLD=function(t){return A(this,void 0,void 0,(function(){return I(this,(function(e){switch(e.label){case 0:return[4,this.parseJsonLD(t)];case 1:return[2,e.sent().toJsonLD()]}}))}))},t.prototype.getJsonLDProperty=function(t,e){if((e=V(e))in t)return this.getJsonLDPropertyValue(t[e]);if("@context"in t){var n=t["@context"],r=Object.entries(n).find((function(t){var n=L(t,2),r=(n[0],n[1]);return e.startsWith(r)}));if(r){var i=t[("@vocab"===r[0]?"":r[0]+":")+e.substr(r[1].length)];return this.getJsonLDPropertyValue(i)}}},t.prototype.getJsonLDPropertyValue=function(t){if(void 0!==t)return Array.isArray(t)&&1===t.length?t[0]:t},t.prototype.getDescribedBy=function(t){var e,n;if(null===(e=t.headers)||void 0===e?void 0:e.has("Link")){var r=null===(n=t.headers.get("Link"))||void 0===n?void 0:n.match(/<([^>]+)>; rel="describedBy"/i);if(r)return h.resolve(t.baseUrl||"",r[1])}},t}()),J=new(function(){function t(){}return t.prototype.slug=function(t){return t.replace(/[^\d\w]/g,"-").replace(/-+/g,"-").toLowerCase()},t.prototype.fixUrl=function(t){var e=t.indexOf("://")+3;return t.substr(0,e)+t.substr(e).replace(/\/\//g,"/")},t}()),G=new(function(){function t(){}return t.prototype.generate=function(t){return t?(t^16*Math.random()>>t/4).toString(16):"10000000-1000-4000-8000-100000000000".replace(/[018]/g,this.generate)},t}()),K=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},q=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},H=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},W=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},z=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(W(arguments[e]));return t},X=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return K(e,t),e.prototype.resolve=function(){return $(this,void 0,void 0,(function(){var t,e,n,r,i,o,a,s,u,c=this;return q(this,(function(l){switch(l.label){case 0:this.__modelsInSameDocument&&this.__modelsInOtherDocumentIds||(this.__modelsInSameDocument=[],this.__modelsInOtherDocumentIds=this.parent.getAttribute(this.foreignKeyName)),t={};try{for(e=H(this.__modelsInOtherDocumentIds),n=e.next();!n.done;n=e.next())r=n.value,(i=h.parentDirectory(r))in t||(t[i]=[]),t[i].push(r)}catch(t){s={error:t}}finally{try{n&&!n.done&&(u=e.return)&&u.call(e)}finally{if(s)throw s.error}}return[4,Promise.all(Object.keys(t).map((function(e){return c.relatedClass.from(e).all({$in:t[e]})})))];case 1:return o=l.sent(),a=o.reduce((function(t,e){return t.push.apply(t,z(e)),t}),[]),this.related=z(this.__modelsInSameDocument,a),[2,this.related]}}))}))},e.prototype.__loadDocumentModels=function(t,e){return $(this,void 0,void 0,(function(){var n,r,o,a,s,u=this;return q(this,(function(c){switch(c.label){case 0:return n=new i.EngineHelper,r=this.parent.getAttribute(this.foreignKeyName),o=this.relatedClass.prepareEngineFilters(),a=e["@graph"].filter((function(t){return-1!==r.indexOf(t["@id"])})).reduce((function(t,e){return t[e["@id"]]={"@graph":[e]},t}),{}),s=this,[4,Promise.all(Object.entries(n.filterDocuments(a,o)).map((function(e){var n=W(e,2),r=n[0],i=n[1];return u.relatedClass.createFromEngineDocument(t,i,r)})))];case 1:return s.__modelsInSameDocument=c.sent(),this.__modelsInOtherDocumentIds=r.filter((function(t){return!u.__modelsInSameDocument.some((function(e){return e.url===t}))})),this.__modelsInOtherDocumentIds.length>0||(this.related=this.__modelsInSameDocument),[2]}}))}))},e}(i.BelongsToManyRelation),Y=function(){return(Y=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},Q=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Z=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},tt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},et=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(tt(arguments[e]));return t},nt=new(function(){function t(){}return t.prototype.tap=function(t,e){return e?(e(t),t):this.proxyTap(t)},t.prototype.proxyTap=function(t){var e=new Proxy(t,{get:function(t,n,r){var i=Reflect.get(t,n,r);return"function"!=typeof i?i:function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return i.call.apply(i,et([t],n)),e}}});return e},t}()),rt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},it=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},ot=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},at=function(){function t(){}return t.prototype.deleteModels=function(t){return rt(this,void 0,void 0,(function(){var e,n=this;return it(this,(function(r){switch(r.label){case 0:return e=this.decantDocumentModelsByContainer(t),[4,Promise.all(Object.entries(e).map((function(t){var e=ot(t,2),r=e[0],i=e[1];return n.deleteContainerDocumentsModels(r,i)})))];case 1:return r.sent(),[2]}}))}))},t.prototype.decantDocumentModelsByContainer=function(t){var e=this.decantModelsByDocument(t);return Object.entries(e).reduce((function(t,e){var n=ot(e,2),r=n[0],i=n[1],o=h.parentDirectory(r);return o in t||(t[o]=[]),t[o].push({documentUrl:r,models:i}),t}),{})},t.prototype.decantModelsByDocument=function(t){return t.reduce((function(t,e){var n=e.getDocumentUrl();return n in t||(t[n]=[]),t[n].push(e),t}),{})},t.prototype.deleteContainerDocumentsModels=function(t,e){return rt(this,void 0,void 0,(function(){var n,r=this;return it(this,(function(i){switch(i.label){case 0:return[4,o.a.requireEngine().readMany(t,{$in:e.map((function(t){return t.documentUrl}))})];case 1:return n=i.sent(),[4,Promise.all(e.map((function(e){var i=e.documentUrl,o=e.models;return r.deleteDocumentModels(n,t,i,o)})))];case 2:return i.sent(),[2]}}))}))},t.prototype.deleteDocumentModels=function(t,e,n,r){return rt(this,void 0,void 0,(function(){var i,a;return it(this,(function(s){switch(s.label){case 0:return i=o.a.requireEngine(),a=r.map((function(t){return t.url})),t[n]["@graph"].some((function(t){return!a.some((function(e){return e===t["@id"]}))}))?[3,2]:[4,i.delete(e,n)];case 1:return s.sent(),[2];case 2:return[4,i.update(e,n,{"@graph":{$updateItems:{$where:{"@id":{$in:a}},$unset:!0}}})];case 3:return s.sent(),[2]}}))}))},t}(),st=function(){return(st=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},ut=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},ct=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},lt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},ft=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ht=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(lt(arguments[e]));return t},dt=function(){},pt=function(){function t(t,e){void 0===e&&(e=!0),this.declarations={},this.vocabs=Object.entries(t).map((function(t){var e=lt(t,2),n=e[0];return{name:n,iriPrefix:e[1],propertyPrefix:n+":",used:!1}})),this.compactIRIs=e,this.vocabs[0].name="@vocab",this.vocabs[0].propertyPrefix="",this.vocabs[0].used=!0}return t.prototype.compactIRI=function(t){var e,n;try{for(var r=ft(this.vocabs),i=r.next();!i.done;i=r.next()){var o=i.value;if(t.startsWith(o.iriPrefix))return o.used=!0,""+o.propertyPrefix+t.substr(o.iriPrefix.length)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return t},t.prototype.addDeclaration=function(t,e){this.declarations[t]=e},t.prototype.toJsonLD=function(){var t=this.vocabs.filter((function(t){return t.used})).reduce((function(t,e){var n;return st(st({},t),((n={})[e.name]=e.iriPrefix,n))}),{});return st(st({},t),this.declarations)},t}(),yt=function(){function t(){}return t.prototype.serializeToJsonLD=function(t,e){var n,r;void 0===t&&(t=!0),e=e||new pt(this.modelClass.rdfContexts);var i={"@context":{},"@type":null};try{for(var o=ft(Object.entries(this.getAttributes())),a=o.next();!a.done;a=o.next()){var s=lt(a.value,2),u=s[0],c=s[1];this.setJsonLDField(i,u,c,e)}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return t&&this.includeRelatedJsonLDInstances(i,e),this.setJsonLDTypes(i,e),this.setJsonLDContexts(i,e),i},t.prototype.convertJsonLDToAttributes=function(t){return ut(this,void 0,void 0,(function(){var e,n,r,i,o,a,s,u,c,l,f,h,d,p;return ct(this,(function(y){switch(y.label){case 0:return[4,B.parseJsonLD(t)];case 1:e=y.sent(),n=e.resource(t["@id"]),r=this.modelClass.fields,(i={})[this.modelClass.primaryKey]=t["@id"];try{for(o=ft(Object.entries(r)),a=o.next();!a.done;a=o.next())s=lt(a.value,2),u=s[0],c=s[1],u!==this.modelClass.primaryKey&&(l=lt(n.getPropertyValues(c.rdfProperty)),f=l[0],h=l.slice(1),void 0!==f&&(i[u]=h.length>0?ht([f],h):f))}catch(t){d={error:t}}finally{try{a&&!a.done&&(p=o.return)&&p.call(o)}finally{if(d)throw d.error}}return[2,i]}}))}))},t.prototype.convertEngineFiltersToJsonLD=function(t){var e={},n=ht(this.modelClass.rdfsClasses),r=this.getCompactedRdfsClasses();return t.$in&&(e.$in=t.$in,delete t.$in),st(st({},e),{"@graph":{$contains:st({"@type":{$or:ht([{$contains:r},{$contains:n}],1===r.length?[{$eq:r[0]},{$eq:n[0]}]:[])}},this.convertAttributeValuesToJsonLD(t))}})},t.prototype.convertEngineUpdatesToJsonLD=function(t){return this.convertAttributeValuesToJsonLD(t)},t.prototype.getCompactedRdfsClasses=function(){var t=new pt(this.modelClass.rdfContexts);return ht(this.modelClass.rdfsClasses).map((function(e){return t.compactIRI(e)}))},t.prototype.setJsonLDField=function(t,e,n,r){if(e!==this.modelClass.primaryKey){var i=this.modelClass.fields[e],o=i?i.rdfProperty:this.getDefaultRdfContext()+e;this.setJsonLDProperty(t,r.compactIRIs?r.compactIRI(o):o,n,i)}else t["@id"]=n.toString()},t.prototype.includeRelatedJsonLDInstances=function(t,e){var n,r,o=this,a=this.modelClass.relations.map((function(t){return[t,o.getRelation(t)]})),s=function(n,r){if(!r.loaded||!(r instanceof i.HasManyRelation||r instanceof i.HasOneRelation))return"continue";var o=V(r.foreignKeyName,r.relatedClass.rdfContexts),a=function(t){var n=t.serializeToJsonLD(!1,e);return delete n["@context"],delete n[o],n};t[n]=r instanceof i.HasManyRelation?r.related.map((function(t){return a(t)})):a(r.related),e.addDeclaration(n,{"@reverse":o})};try{for(var u=ft(a),c=u.next();!c.done;c=u.next()){var l=lt(c.value,2);s(l[0],l[1])}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}},t.prototype.setJsonLDTypes=function(t,e){var n=ht(this.modelClass.rdfsClasses).map((function(t){return e.compactIRI(t)}));t["@type"]=1===n.length?n[0]:n},t.prototype.setJsonLDContexts=function(t,e){t["@context"]=e.toJsonLD()},t.prototype.setJsonLDProperty=function(t,e,n,r){return void 0===r&&(r=null),("object"!=typeof n||1!==Object.keys(n).length||Object.keys(n)[0].startsWith("$"))&&(n=this.castJsonLDValue(n,r)),!(n instanceof dt)&&(t[e]=n,!0)},t.prototype.castJsonLDValue=function(t,e){var n=this;switch(void 0===e&&(e=null),e&&e.type||null){case i.FieldType.Key:return{"@id":t.toString()};case i.FieldType.Date:return{"@type":"http://www.w3.org/2001/XMLSchema#dateTime","@value":new Date(t).toISOString()};case i.FieldType.Array:switch(t.length){case 0:return new dt;case 1:return this.castJsonLDValue(t[0],e.items);default:return t.map((function(t){return n.castJsonLDValue(t,e.items)}))}default:return JSON.parse(JSON.stringify(t))}},t.prototype.convertAttributeValuesToJsonLD=function(t){var e,n,r=new pt(this.modelClass.rdfContexts,!1),i={};try{for(var o=ft(Object.entries(t)),a=o.next();!a.done;a=o.next()){var s=lt(a.value,2),u=s[0],c=s[1];this.setJsonLDField(i,u,c,r)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return i},t}(),bt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),vt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},gt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},mt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},wt=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(mt(arguments[e]));return t},_t=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},St=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.__newModels=[],e.useSameDocument=!1,e}return bt(e,t),e.prototype.resolve=function(){return vt(this,void 0,void 0,(function(){var t;return gt(this,(function(e){switch(e.label){case 0:return this.__modelsInSameDocument&&this.__modelsInOtherDocumentIds?[4,this.relatedClass.all({$in:this.__modelsInOtherDocumentIds})]:[2,[]];case 1:return t=e.sent(),this.related=wt(this.__modelsInSameDocument,t),[2,this.related]}}))}))},e.prototype.create=function(t){return void 0===t&&(t={}),vt(this,void 0,void 0,(function(){var e;return gt(this,(function(n){switch(n.label){case 0:return this.assertLoaded("create"),e=this.relatedClass.newInstance(t),[4,this.save(e)];case 1:return n.sent(),[2,e]}}))}))},e.prototype.save=function(t){return vt(this,void 0,void 0,(function(){return gt(this,(function(e){switch(e.label){case 0:return this.assertLoaded("save"),this.add(t),this.useSameDocument?[3,2]:[4,t.save()];case 1:return e.sent(),[3,4];case 2:return this.parent.exists()?[4,this.parent.save()]:[3,4];case 3:e.sent(),e.label=4;case 4:return[2]}}))}))},e.prototype.add=function(t){this.assertLoaded("add"),this.parent.exists()&&this.initializeInverseRelations(t),t.exists()||this.__newModels.push(t),this.related.push(t)},e.prototype.usingSameDocument=function(t){return void 0===t&&(t=!0),this.useSameDocument=t,this},e.prototype.__loadDocumentModels=function(t,e){var n;return vt(this,void 0,void 0,(function(){var r,o,a,s,u,c=this;return gt(this,(function(l){switch(l.label){case 0:return r=new i.EngineHelper,o=null===(n=this.relatedClass.fields[this.foreignKeyName])||void 0===n?void 0:n.rdfProperty,a=this.relatedClass.prepareEngineFilters(),s=e["@graph"].filter((function(t){var e=B.getJsonLDProperty(t,o);return"object"==typeof e&&"@id"in e&&e["@id"]===c.parent.url})).reduce((function(t,e){return t[e["@id"]]={"@graph":[e]},t}),{}),u=this,[4,Promise.all(Object.entries(r.filterDocuments(s,a)).map((function(e){var n=mt(e,2),r=n[0],i=n[1];return c.relatedClass.createFromEngineDocument(t,i,r)})))];case 1:return u.__modelsInSameDocument=l.sent(),this.__modelsInOtherDocumentIds=Object.keys(s).filter((function(t){return!c.__modelsInSameDocument.some((function(e){return e.url===t}))})),this.__modelsInOtherDocumentIds.length>0||(this.related=this.__modelsInSameDocument),[2]}}))}))},e.prototype.initializeInverseRelations=function(t){var e,n,r=this.parent.constructor;try{for(var o=_t(this.relatedClass.relations),a=o.next();!a.done;a=o.next()){var s=a.value,u=t.getRelation(s);u.relatedClass===r&&(u instanceof i.BelongsToManyRelation?(t.setAttribute(u.foreignKeyName,[this.parent.url]),u.related=[this.parent]):u instanceof i.BelongsToOneRelation&&(t.setAttribute(u.foreignKeyName,this.parent.url),u.related=this.parent))}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}},e.prototype.assertLoaded=function(t){if(!this.loaded){if(this.parent.exists())throw new i.SoukaiError('The "'+t+'" method cannot be called before loading the relationship');this.related=[]}},e}(i.HasManyRelation),xt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ct=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Et=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Ot=function(t){function e(e,n){return t.call(this,e,n,"url")||this}return xt(e,t),e.prototype.resolve=function(){return Ct(this,void 0,void 0,(function(){var t,e,n;return Et(this,(function(r){switch(r.label){case 0:return t=this.relatedClass.collection,e=h.parentDirectory(this.parent.url),n=this,[4,this.relatedClass.from(h.parentDirectory(e)).find(e)];case 1:return n.related=r.sent(),this.relatedClass.collection=t,[2,this.related]}}))}))},e}(i.SingleModelRelation),Dt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Tt=function(){return(Tt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},kt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Rt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Pt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},jt=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Pt(arguments[e]));return t},At=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},It=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._sourceDocumentUrl=null,e}return Dt(e,t),e.from=function(t){return this.collection=t,this},e.at=function(t){return this.from(t)},e.boot=function(e){var n=this;t.boot.call(this,e),this.rdfContexts=Tt(Tt({},this.rdfContexts),{solid:"http://www.w3.org/ns/solid/terms#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",ldp:"http://www.w3.org/ns/ldp#",purl:"http://purl.org/dc/terms/"});var r=this.instance.getDefaultRdfContext();for(var i in this.instance.hasAutomaticTimestamp("createdAt")&&void 0===this.fields.createdAt.rdfProperty&&(this.fields.createdAt.rdfProperty=V("purl:created")),this.instance.hasAutomaticTimestamp("updatedAt")&&void 0===this.fields.updatedAt.rdfProperty&&(this.fields.updatedAt.rdfProperty=V("purl:modified")),this.rdfsClasses=new Set(jt(this.rdfsClasses).map((function(t){return-1===t.indexOf(":")?r+t:V(t,n.rdfContexts)}))),this.fields)this.fields[i].rdfProperty=V(this.fields[i].rdfProperty||""+r+i,this.rdfContexts);this.fields[this.primaryKey].rdfProperty=null},e.createFromEngineDocument=function(t,e,n){return this.instance.createFromEngineDocument(t,e,n)},e.find=function(t){return kt(this,void 0,void 0,(function(){var e,n,r,i;return Rt(this,(function(a){switch(a.label){case 0:e=this.instance.serializeKey(t),n=h.route(e),r=h.parentDirectory(n),this.ensureBooted(),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,o.a.requireEngine().readOne(r,n)];case 2:return i=a.sent(),[2,this.instance.createFromEngineDocument(n,i,e)];case 3:return a.sent(),[2,null];case 4:return[2]}}))}))},e.all=function(e){var n=this;return void 0===e&&(e={}),e=this.prepareEngineFilters(e),this.withCollection((function(){return t.all.call(n,e)}))},e.prepareEngineFilters=function(t){return void 0===t&&(t={}),this.instance.convertEngineFiltersToJsonLD(t)},e.newInstance=function(t,e){return void 0===e&&(e=!1),new this(t,e)},e.newFromJsonLD=function(t,e){return kt(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l,f;return Rt(this,(function(d){switch(d.label){case 0:return[4,B.flattenJsonLD(t)];case 1:return n=d.sent(),r=e||h.route(t["@id"]),[4,this.instance.parseEngineDocumentAttributes(r,n,t["@id"])];case 2:return i=d.sent(),[4,(o=new this(i)).loadDocumentModels(r,n)];case 3:d.sent(),o.resetEngineData(),a=function(t){var e=o._relations[t],n=e.getLoadedModels();n.forEach((function(t){return t.resetEngineData()})),e instanceof St&&n.forEach((function(t){delete t[e.foreignKeyName],e.__newModels.push(t)}))};try{for(s=At(this.relations),u=s.next();!u.done;u=s.next())c=u.value,a(c)}catch(t){l={error:t}}finally{try{u&&!u.done&&(f=s.return)&&f.call(s)}finally{if(l)throw l.error}}return[2,o]}}))}))},e.withCollection=function(t,e){void 0===t&&(t="");var n=this.collection;if("string"!=typeof t&&(e=t,t=""),!e)throw new i.SoukaiError("Invalid method given to withCollection (SolidModel internals)");this.collection=t||n;var r=e();return this.collection=n,r},e.prototype.save=function(e){var n=this;return this.modelClass.withCollection(e||this.guessCollection(),(function(){return kt(n,void 0,void 0,(function(){var e;return Rt(this,(function(n){switch(n.label){case 0:!this.url&&this.modelClass.mintsUrls&&this.mintUrl(),n.label=1;case 1:return n.trys.push([1,3,,5]),[4,t.prototype.save.call(this)];case 2:return n.sent(),[3,5];case 3:if(!((e=n.sent())instanceof i.DocumentAlreadyExists))throw e;return this.url+="-"+G.generate(),[4,t.prototype.save.call(this)];case 4:return n.sent(),[3,5];case 5:return[2,this]}}))}))}))},e.prototype.delete=function(){var e=this;return this.modelClass.withCollection(this.guessCollection()||"",(function(){return t.prototype.delete.call(e)}))},e.prototype.mintUrl=function(t,e,n){this.setAttribute(this.modelClass.primaryKey,this.newUrl(t,n)),t&&(this._documentExists=null==e||e)},e.prototype.toJsonLD=function(){return this.serializeToJsonLD()},e.prototype.getIdAttribute=function(){return this.getAttribute("url")},e.prototype.setExists=function(e){this._documentExists=e&&this._documentExists,t.prototype.setExists.call(this,e)},e.prototype.documentExists=function(){return this._documentExists},e.prototype.setDocumentExists=function(t){this._documentExists=t},e.prototype.isDirty=function(e){return e?t.prototype.isDirty.call(this,e):!!t.prototype.isDirty.call(this)||this.getDirtyDocumentModels().length>0},e.prototype.getDocumentUrl=function(){return this.url?h.route(this.url):null},e.prototype.getSourceDocumentUrl=function(){return this._sourceDocumentUrl},e.prototype.getContainerUrl=function(){var t=this.getDocumentUrl();return t?h.parentDirectory(t):null},e.prototype.getSourceContainerUrl=function(){var t=this.getSourceDocumentUrl();return t?h.parentDirectory(t):null},e.prototype.initialize=function(e,n){t.prototype.initialize.call(this,e,n),this._documentExists=n},e.prototype.createFromEngineDocument=function(t,e,n){return kt(this,void 0,void 0,(function(){var r,i=this;return Rt(this,(function(o){switch(o.label){case 0:return[4,function(){return kt(i,void 0,void 0,(function(){var r;return Rt(this,(function(i){switch(i.label){case 0:return[4,this.parseEngineDocumentAttributes(t,e,n)];case 1:return(r=i.sent())[this.modelClass.primaryKey]=n||t,[2,new this.modelClass(r,!0)]}}))}))}()];case 1:return[4,(r=o.sent()).loadDocumentModels(t,e)];case 2:return o.sent(),[2,nt.tap(r,(function(e){return e._sourceDocumentUrl=t}))]}}))}))},e.prototype.createManyFromEngineDocuments=function(t){return kt(this,void 0,void 0,(function(){var e,n,r,i=this;return Rt(this,(function(o){switch(o.label){case 0:return e=jt(this.modelClass.rdfsClasses),n=function(t){return!e.some((function(e){return!t.isType(e)}))},[4,Promise.all(Object.entries(t).map((function(t){var e=Pt(t,2),r=e[0],o=e[1];return kt(i,void 0,void 0,(function(){var t,e=this;return Rt(this,(function(i){switch(i.label){case 0:return[4,B.parseJsonLD(o)];case 1:return t=i.sent(),[2,Promise.all(t.resources.filter(n).map((function(t){return kt(e,void 0,void 0,(function(){return Rt(this,(function(e){return[2,this.createFromEngineDocument(r,o,t.url)]}))}))})))]}}))}))})))];case 1:return r=o.sent(),[2,E.flatten(r)]}}))}))},e.prototype.loadDocumentModels=function(t,e){return kt(this,void 0,void 0,(function(){var n;return Rt(this,(function(r){switch(r.label){case 0:return n=Object.values(this._relations).filter((function(t){return t instanceof St||t instanceof X})),[4,Promise.all(n.map((function(n){return n.__loadDocumentModels(t,e)})))];case 1:return r.sent(),[2]}}))}))},e.prototype.syncDirty=function(){return kt(this,void 0,void 0,(function(){var t,e,n,r,i,a,s=this;return Rt(this,(function(u){switch(u.label){case 0:return t=o.a.requireEngine(),e=this.getSerializedPrimaryKey(),n=this.getDocumentUrl(),r=function(){return t.create(s.modelClass.collection,s.toEngineDocument(),n||void 0)},i=function(){return t.update(s.modelClass.collection,n,{"@graph":{$push:s.serializeToJsonLD(!1)}})},a=function(){return t.update(s.modelClass.collection,n,s.getDirtyEngineDocumentUpdates())},[4,function(){return s._documentExists?s._exists?a():i():r()}()];case 1:return u.sent(),[2,e]}}))}))},e.prototype.cleanDirty=function(){var e,n,r;t.prototype.cleanDirty.call(this),this.getDirtyDocumentModels().map((function(t){return t.cleanDirty()})),this._documentExists=!0;var i=Object.values(this._relations).filter((function(t){return t instanceof St&&t.useSameDocument}));try{for(var o=At(i),a=o.next();!a.done;a=o.next()){var s=a.value;s.__modelsInSameDocument=s.__modelsInSameDocument||[],(r=s.__modelsInSameDocument).push.apply(r,jt(s.__newModels)),s.__newModels=[]}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}},e.prototype.deleteModelsFromEngine=function(t){return kt(this,void 0,void 0,(function(){return Rt(this,(function(e){switch(e.label){case 0:return[4,this.deleteModels(t)];case 1:return e.sent(),[2]}}))}))},e.prototype.hasMany=function(t,e,n){return new St(this,t,e,n)},e.prototype.belongsToMany=function(t,e,n){return new X(this,t,e,n)},e.prototype.isContainedBy=function(t){return new Ot(this,t)},e.prototype.getDefaultRdfContext=function(){return Object.values(this.modelClass.rdfContexts).shift()||""},e.prototype.toEngineDocument=function(){return{"@graph":jt([this.serializeToJsonLD(!1)],this.prepareDirtyDocumentModels().map((function(t){return t.serializeToJsonLD(!1)})))}},e.prototype.getDirtyEngineDocumentUpdates=function(){var e=[];if(e.push.apply(e,jt(this.prepareDirtyDocumentModels().map((function(t){return{$push:t.serializeToJsonLD(!1)}})))),t.prototype.isDirty.call(this)){var n=t.prototype.getDirtyEngineDocumentUpdates.call(this);e.push({$updateItems:{$where:{"@id":this.url},$update:this.convertEngineUpdatesToJsonLD(n)}})}return 1===e.length?{"@graph":e[0]}:{"@graph":{$apply:e}}},e.prototype.parseEngineDocumentAttributes=function(t,e,n){return void 0===n&&(n=null),kt(this,void 0,void 0,(function(){var r;return Rt(this,(function(i){return n=n||t,r=e["@graph"].find((function(t){return t["@id"]===n})),[2,this.convertJsonLDToAttributes(r)]}))}))},e.prototype.castAttribute=function(e,n){return n&&n.type===i.FieldType.Array&&!Array.isArray(e)?[e]:t.prototype.castAttribute.call(this,e,n)},e.prototype.newUrl=function(t,e){return(t=null!=t?t:h.resolve(this.modelClass.collection,G.generate()))+"#"+(null!=e?e:this.modelClass.defaultResourceHash)},e.prototype.guessCollection=function(){if(this.url)return h.parentDirectory(this.url)},e.prototype.getDirtyDocumentModels=function(){var t=this,e=this.getDocumentUrl();return E.flatten(Object.values(this._relations).filter((function(t){return t.loaded&&t instanceof St&&t.useSameDocument})).map((function(n){var r,i,o=jt(n.__newModels),a=function(t){if(!t.isDirty()||t.getDocumentUrl()!==e||o.some((function(e){return e===t})))return"continue";o.push(t)};try{for(var s=At(n.getLoadedModels()),u=s.next();!u.done;u=s.next())a(u.value)}catch(t){r={error:t}}finally{try{u&&!u.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return o.forEach((function(e){return e.setAttribute(n.foreignKeyName,t.url)})),o})))},e.prototype.prepareDirtyDocumentModels=function(){var t=this,e=this.getDirtyDocumentModels();if(0===e.length)return[];this.url||this.mintUrl();var n=this.getDocumentUrl();return e.forEach((function(e){return!e.url&&e.mintUrl(n,t._documentExists,G.generate())})),e},e.primaryKey="url",e.rdfContexts={},e.rdfsClasses=[],e.defaultResourceHash="it",e.mintsUrls=!0,e}(i.Model);!function(t,e){var n,r,i=e.reduce((function(t,e){return Y(Y({},t),Object.getOwnPropertyDescriptors(e.prototype))}),{});try{for(var o=Q(Object.entries(i)),a=o.next();!a.done;a=o.next()){var s=Z(a.value,2),u=s[0],c=s[1];Object.defineProperty(t.prototype,u,c)}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}(It,[at,yt]);var Lt,Nt=It,Mt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Mt(e,t),e.timestamps=["updatedAt"],e.rdfContexts={iana:"http://www.w3.org/ns/iana/media-types/text/turtle#"},e.rdfsClasses=["Resource"],e}(Nt),Ut=function(t,e){this.resourceUrl=t,this.newResourceUrl=e,this.type=2},Vt=function(t,e,n){this.resourceUrl=t,this.property=e,this.value=n,this.type=1},Bt=function(t){this.property=t,this.type=0},Jt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(t){t.RDF="RDF"}(Lt||(Lt={}));var Gt=function(t){function e(e,n,r){var i=t.call(this,"Malformed "+n+" document found at "+e+" - "+r)||this;return i.documentUrl=e,i.documentFormat=n,i.malformationDetails=r,i}return Jt(e,t),e}(i.SoukaiError),Kt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$t=function(t){function e(e,n){var r=t.call(this,e+" ("+n.message+")")||this;return r.original=n,r}return Kt(e,t),e}(i.SoukaiError),qt=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ht=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},Wt=new(function(){function t(){}return t.prototype.createMap=function(t,e){var n,r,i={};try{for(var o=qt(t),a=o.next();!a.done;a=o.next()){var s=a.value;i[s[e]]=s}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i},t.prototype.deepEquals=function(t,e){if(t===e)return!0;var n=typeof t;if(n!==typeof e)return!1;if("object"!==n||null===t||null===e)return!1;if(t instanceof Date&&e instanceof Date)return t.getTime()===e.getTime();if(Object.keys(t).length!==Object.keys(e).length)return!1;for(var r in t)if(!this.deepEquals(t[r],e[r]))return!1;return!0},t.prototype.withoutEmpty=function(t){var e,n,r={};try{for(var i=qt(Object.entries(t)),o=i.next();!o.done;o=i.next()){var a=Ht(o.value,2),s=a[0],u=a[1];null!=u&&(r[s]=u)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r},t}()),zt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Xt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Yt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},Qt=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Yt(arguments[e]));return t},Zt=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},te=[V("ldp:contains"),V("posix:mtime"),V("posix:size"),V("purl:modified")],ee=[V("ldp:Container"),V("ldp:BasicContainer")],ne=function(){function t(t){var e=this;this.fetch=function(n,r){return zt(e,void 0,void 0,(function(){var e;return Xt(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,t(n,r)];case 1:return[2,i.sent()];case 2:throw e=i.sent(),new $t("Error fetching "+n,e);case 3:return[2]}}))}))}}return t.prototype.createDocument=function(t,e,n){return void 0===e&&(e=null),void 0===n&&(n=[]),zt(this,void 0,void 0,(function(){var r;return Xt(this,(function(i){return r=V("ldp:Container"),[2,n.some((function(t){return t.resourceUrl===e&&0===t.type&&t.value===r}))?this.createContainerDocument(t,e,n):this.createNonContainerDocument(t,e,n)]}))}))},t.prototype.getDocument=function(t){return zt(this,void 0,void 0,(function(){var e,n,r;return Xt(this,(function(i){switch(i.label){case 0:return[4,this.fetch(t,{headers:{Accept:"text/turtle"}})];case 1:return 200!==(e=i.sent()).status?[2,null]:[4,e.text()];case 2:n=i.sent(),i.label=3;case 3:return i.trys.push([3,5,,6]),[4,B.parseTurtle(n,{headers:e.headers,baseUrl:t})];case 4:return[2,i.sent()];case 5:throw r=i.sent(),new Gt(t,Lt.RDF,r.message);case 6:return[2]}}))}))},t.prototype.getDocuments=function(t,e){return void 0===e&&(e=!1),zt(this,void 0,void 0,(function(){var n,r;return Xt(this,(function(i){switch(i.label){case 0:return i.trys.push([0,5,,6]),e?[4,this.getContainerDocuments(t)]:[3,2];case 1:return n=i.sent(),[3,4];case 2:return[4,this.getNonContainerDocumentsUsingGlobbing(t)];case 3:n=i.sent(),i.label=4;case 4:return[2,n];case 5:if((r=i.sent())instanceof U)throw new Gt(t,Lt.RDF,r.message);return console.error(r),[2,[]];case 6:return[2]}}))}))},t.prototype.updateDocument=function(t,e){var n;return zt(this,void 0,void 0,(function(){var r;return Xt(this,(function(o){switch(o.label){case 0:return 0===e.length?[2]:[4,this.getDocument(t)];case 1:if(null===(r=o.sent()))throw new i.DocumentNotFound(t);return this.processChangeUrlOperations(r,e),this.processUpdatePropertyOperations(r,e),(null===(n=r.resource(t))||void 0===n?void 0:n.isType(V("ldp:Container")))?[4,this.updateContainerDocument(r,e)]:[3,3];case 2:return o.sent(),[3,5];case 3:return[4,this.updateNonContainerDocument(r,e)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))},t.prototype.deleteDocument=function(t){var e;return zt(this,void 0,void 0,(function(){var n,r,i,o=this;return Xt(this,(function(a){switch(a.label){case 0:return[4,this.getDocument(t)];case 1:return null===(n=a.sent())?[2]:(null===(e=n.resource(t))||void 0===e?void 0:e.isType(V("ldp:Container")))?[4,Promise.all([this.getDocuments(t,!0),this.getDocuments(t)])]:[3,4];case 2:return r=a.sent(),[4,Promise.all(E.flatten(r).map((function(t){return o.deleteDocument(t.url)})))];case 3:a.sent(),a.label=4;case 4:return[4,this.fetch(t,{method:"DELETE"})];case 5:return i=a.sent(),this.assertSuccessfulResponse(i,"Error deleting document at "+t),[2]}}))}))},t.prototype.documentExists=function(t){return zt(this,void 0,void 0,(function(){var e;return Xt(this,(function(n){switch(n.label){case 0:return[4,this.fetch(t,{headers:{Accept:"text/turtle"}})];case 1:return 200!==(e=n.sent()).status?[3,3]:[4,e.text()];case 2:return[2,n.sent().length>0];case 3:if(404===e.status)return[2,!1];throw new i.SoukaiError("Couldn't determine if document at "+t+" exists, got "+e.status+" response");case 4:return[2]}}))}))},t.prototype.createContainerDocument=function(t,e,n){return zt(this,void 0,void 0,(function(){var r,o;return Xt(this,(function(a){switch(a.label){case 0:if(e&&!e.startsWith(t))throw new i.SoukaiError("Explicit document url should start with the parent url");if(e&&!e.endsWith("/"))throw new i.SoukaiError("Container urls must end with a trailing slash, given "+e);return r=e?"at "+e:"under "+t,[4,this.fetch(t,{method:"POST",headers:Wt.withoutEmpty({"Content-Type":"text/turtle",Link:'<http://www.w3.org/ns/ldp#BasicContainer>; rel="type"',Slug:e?h.filename(e.substr(0,e.length-1)):null}),body:m.toTurtle(this.withoutReservedContainerProperties(e,n),e)})];case 1:return o=a.sent(),this.assertSuccessfulResponse(o,"Error creating container "+r,201),[2,e||h.resolve(t,o.headers.get("Location")||"")]}}))}))},t.prototype.createNonContainerDocument=function(t,e,n){return zt(this,void 0,void 0,(function(){var r,o;return Xt(this,(function(a){switch(a.label){case 0:return e?[3,2]:[4,this.fetch(t,{headers:{"Content-Type":"text/turtle"},method:"POST",body:m.toTurtle(n,e)})];case 1:return r=a.sent(),this.assertSuccessfulResponse(r,"Error creating document under "+t,201),[2,h.resolve(t,r.headers.get("Location")||"")];case 2:if(!e.startsWith(t))throw new i.SoukaiError("A minted document url should start with the parent url");return[4,this.fetch(e,{method:"PATCH",body:"\n                @prefix solid: <http://www.w3.org/ns/solid/terms#> .\n                <>\n                    solid:patches <"+e+"> ;\n                    solid:inserts { "+m.toTurtle(n)+" } .\n            ",headers:{"Content-Type":"text/n3","If-None-Match":"*"}})];case 3:return o=a.sent(),this.assertSuccessfulResponse(o,"Error creating document at "+e),[2,e]}}))}))},t.prototype.getContainerDocuments=function(t){var e;return zt(this,void 0,void 0,(function(){var n,r,i,o=this;return Xt(this,(function(a){switch(a.label){case 0:return[4,this.fetch(t,{headers:{Accept:"text/turtle"}})];case 1:return n=a.sent(),this.assertSuccessfulResponse(n,"Error getting container documents from "+t),[4,n.text()];case 2:return r=a.sent(),[4,B.parseTurtle(r,{baseUrl:t})];case 3:return i=a.sent(),[4,Promise.all((null===(e=i.resource(t))||void 0===e?void 0:e.getPropertyValues("ldp:contains").map((function(t){return i.resource(t)})).filter((function(t){return null!==t&&t.isType("ldp:Container")})).map((function(t){return o.getDocument(t.url)})))||[])];case 4:return[2,a.sent()]}}))}))},t.prototype.getNonContainerDocumentsUsingGlobbing=function(t){return zt(this,void 0,void 0,(function(){var e,n,r,i;return Xt(this,(function(o){switch(o.label){case 0:return[4,this.fetch(t+"*",{headers:{Accept:"text/turtle"}})];case 1:return e=o.sent(),this.assertSuccessfulResponse(e,"Error getting container documents using globbing from "+t),[4,e.text()];case 2:return n=o.sent(),[4,B.parseTurtle(n,{baseUrl:t})];case 3:return r=o.sent(),i=r.statements.reduce((function(t,e){var n=h.clean(e.subject.value,{fragment:!1});return n in t||(t[n]=[]),t[n].push(e),t}),{}),[2,Object.entries(i).map((function(t){var e=Yt(t,2),n=e[0],r=e[1];return new R(n,r)}))]}}))}))},t.prototype.updateContainerDocument=function(t,e){return zt(this,void 0,void 0,(function(){var n,r;return Xt(this,(function(i){switch(i.label){case 0:return n=function(e){return new Vt(t.url,e)},r=function(e){return new Vt(t.url,V("rdf:type"),e)},e.push.apply(e,Qt(te.map(n))),e.push.apply(e,Qt(ee.map(r))),[4,this.updateNonContainerDocument(t.clone(t.metadata.describedBy||t.url+".meta"),e)];case 1:return i.sent(),[2]}}))}))},t.prototype.updateNonContainerDocument=function(t,e){return zt(this,void 0,void 0,(function(){var n,r,i,o,a,s,u;return Xt(this,(function(c){switch(c.label){case 0:return n=Yt(function(t){return t.reduce((function(t,e){switch(e.type){case 0:t[0].push(e.property);break;case 1:t[1].push(E.filter([e.resourceUrl,e.property,e.value]))}return t}),[[],[]])}(e),2),r=n[0],i=n[1],o=m.toTurtle(r),a=m.toTurtle(t.properties.filter((function(t){return i.some((function(e){var n=Yt(e,3),r=n[0],i=n[1],o=n[2];return!(r!==t.resourceUrl||i&&i!==t.name||o&&o!==t.value)}))}))),s=E.filter(["solid:patches <"+t.url+">",o.length>0&&"solid:inserts { "+o+" }",a.length>0&&"solid:deletes { "+a+" }"]).join(";"),[4,this.fetch(t.url,{method:"PATCH",body:"\n                @prefix solid: <http://www.w3.org/ns/solid/terms#> .\n                <> "+s+" .\n            ",headers:{"Content-Type":"text/n3"}})];case 1:return u=c.sent(),this.assertSuccessfulResponse(u,"Error updating document at "+t.url),[2]}}))}))},t.prototype.withoutReservedContainerProperties=function(t,e){return e.filter((function(e){return e.resourceUrl!==t||!function(t){return E.contains(te,t.name)}(e)&&!function(t){return 0===t.type&&E.contains(ee,t.value)}(e)}))},t.prototype.processChangeUrlOperations=function(t,e){var n,r,i=function(t){var e;return t.reduce((function(t,e){return t[e.type].push(e),t}),((e={})[0]=[],e[1]=[],e[2]=[],e))}(e),o=function(n){var r=t.resource(n.resourceUrl);if(!r)return"continue";var o=i[0].filter((function(t){return t.property.resourceUrl===n.resourceUrl})),a=i[1].filter((function(t){return t.resourceUrl===n.resourceUrl}));o.forEach((function(t){return t.property=t.property.clone(n.newResourceUrl)})),a.forEach((function(t){return t.resourceUrl=n.newResourceUrl})),e.push(new Vt(n.resourceUrl)),e.push.apply(e,Qt(r.properties.filter((function(t){return!o.some((function(e){return e.property.name===t.name}))&&!a.some((function(e){return!e.property||e.property===t.name}))})).map((function(t){return new Bt(t.clone(n.newResourceUrl))})))),E.removeItem(e,n)};try{for(var a=Zt(i[2]),s=a.next();!s.done;s=a.next())o(s.value)}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}},t.prototype.processUpdatePropertyOperations=function(t,e){var n,r,i=e.filter((function(e){return 0===e.type&&0!==e.property.type&&t.hasProperty(e.property.resourceUrl,e.property.name)}));try{for(var o=Zt(i),a=o.next();!a.done;a=o.next()){var s=a.value.property;e.push(new Vt(s.resourceUrl,s.name))}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t.prototype.assertSuccessfulResponse=function(t,e,n){if(void 0===n&&(n=200),t.status!==n)throw new i.SoukaiError(e+", returned "+t.status+" status code")},t}(),re=function(){return(re=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},ie=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},oe=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},ae=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},se=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ae(arguments[e]));return t},ue=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ce=function(){function t(t,e){void 0===e&&(e={}),this.listeners=[],this.helper=new i.EngineHelper,this.client=new ne(t),this.config=re({globbingBatchSize:5},e)}return t.prototype.create=function(t,e,n){return ie(this,void 0,void 0,(function(){var r,o;return oe(this,(function(a){switch(a.label){case 0:return this.validateJsonLDGraph(e),(r=n)?[4,this.client.documentExists(n)]:[3,2];case 1:r=a.sent(),a.label=2;case 2:if(r)throw new i.DocumentAlreadyExists(n);return[4,this.getJsonLDGraphProperties(e)];case 3:return o=a.sent(),[4,this.client.createDocument(t,n,o)];case 4:return[2,a.sent()]}}))}))},t.prototype.readOne=function(t,e){return ie(this,void 0,void 0,(function(){var t,n;return oe(this,(function(r){switch(r.label){case 0:return[4,this.client.getDocument(e)];case 1:if(null===(t=r.sent()))throw new i.DocumentNotFound(e);return n=this.convertToEngineDocument(t),this.emit("onRDFDocumentLoaded",t.url,t.metadata),[2,n]}}))}))},t.prototype.readMany=function(t,e){return void 0===e&&(e={}),ie(this,void 0,void 0,(function(){var n,r,i=this;return oe(this,(function(o){switch(o.label){case 0:return[4,this.getDocumentsForFilters(t,e)];case 1:return n=o.sent(),r=n.reduce((function(t,e){return t[e.url]=i.convertToEngineDocument(e),i.emit("onRDFDocumentLoaded",e.url,e.metadata),t}),{}),[2,this.helper.filterDocuments(r,e)]}}))}))},t.prototype.update=function(t,e,n){return ie(this,void 0,void 0,(function(){var t;return oe(this,(function(r){switch(r.label){case 0:return[4,this.extractJsonLDGraphUpdate(n)];case 1:return t=r.sent(),[4,this.client.updateDocument(e,t)];case 2:return r.sent(),[2]}}))}))},t.prototype.delete=function(t,e){return ie(this,void 0,void 0,(function(){return oe(this,(function(t){switch(t.label){case 0:return[4,this.client.deleteDocument(e)];case 1:return t.sent(),[2]}}))}))},t.prototype.addListener=function(t){this.listeners.push(t)},t.prototype.removeListener=function(t){var e=this.listeners.indexOf(t);-1!==e&&this.listeners.splice(e,1)},t.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.listeners.forEach((function(n){var r;return null===(r=n[t])||void 0===r?void 0:r.call.apply(r,se([n],e))}))},t.prototype.getDocumentsForFilters=function(t,e){return ie(this,void 0,void 0,(function(){var n,r;return oe(this,(function(i){switch(i.label){case 0:return n=this.extractJsonLDGraphTypes(e),e.$in?[4,this.getDocumentsFromUrls(e.$in,n)]:[3,2];case 1:return r=i.sent(),[3,4];case 2:return[4,this.getContainerDocuments(t,n)];case 3:r=i.sent(),i.label=4;case 4:return[2,r]}}))}))},t.prototype.getDocumentsFromUrls=function(t,e){return ie(this,void 0,void 0,(function(){var n,r,i,o=this;return oe(this,(function(a){switch(a.label){case 0:return n=t.reduce((function(t,e){var n,r=h.parentDirectory(e);return re(re({},t),((n={})[r]=se(t[r]||[],[e]),n))}),{}),r=Object.entries(n).map((function(t){var n=ae(t,2),r=n[0],i=n[1];return ie(o,void 0,void 0,(function(){var t,n=this;return oe(this,(function(o){switch(o.label){case 0:return null!==this.config.globbingBatchSize&&i.length>=this.config.globbingBatchSize?[2,this.getContainerDocuments(r,e)]:(t=i.map((function(t){return n.client.getDocument(t)})),[4,Promise.all(t)]);case 1:return[2,o.sent().filter((function(t){return null!=t}))]}}))}))})),[4,Promise.all(r)];case 1:return i=a.sent(),[2,E.flatten(i)]}}))}))},t.prototype.getContainerDocuments=function(t,e){return ie(this,void 0,void 0,(function(){return oe(this,(function(n){switch(n.label){case 0:return[4,this.client.getDocuments(t,-1!==e.indexOf(V("ldp:Container")))];case 1:return[2,n.sent()]}}))}))},t.prototype.convertToEngineDocument=function(t){return{"@graph":t.resources.map((function(t){var e,n,r={},i=function(t,e){var n=ae(e),i=n[0],o=n.slice(1),a=t,s=function(t){return t};switch(i.type){case 0:a="@type";break;case 1:s=function(t){return{"@id":t}};break;case 2:s=function(t){return t instanceof Date?{"@type":"http://www.w3.org/2001/XMLSchema#dateTime","@value":t.toISOString()}:t}}r[a]=0===o.length?s(i.value):se([i],o).map((function(t){return s(t.value)}))};try{for(var o=ue(Object.entries(t.propertiesIndex)),a=o.next();!a.done;a=o.next()){var s=ae(a.value,2);i(s[0],s[1])}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r["@id"]=t.url,r}))}},t.prototype.validateJsonLDGraph=function(t){if(!Array.isArray(t["@graph"]))throw new i.SoukaiError("Invalid JSON-LD graph provided for SolidEngine. Are you using a model that isn't a SolidModel?")},t.prototype.extractJsonLDGraphUpdate=function(t){return ie(this,void 0,void 0,(function(){var e,n,r=this;return oe(this,(function(o){switch(o.label){case 0:if(!this.isJsonLDGraphUpdate(t))throw new i.SoukaiError("Invalid JSON-LD graph updates provided for SolidEngine. Are you using a model that isn't a SolidModel?");return e=[],t["@graph"].$updateItems&&e.push.apply(e,se(E.flatten(E.create(t["@graph"].$updateItems).map((function(t){return r.extractJsonLDGraphItemsUpdate(t)}))))),t["@graph"].$push?[4,this.extractJsonLDGraphItemPush(t["@graph"].$push)]:[3,2];case 1:n=o.sent(),e.push.apply(e,se(n)),o.label=2;case 2:return[2,e]}}))}))},t.prototype.extractJsonLDGraphItemsUpdate=function(t){var e,n,r=t.$where,o=t.$update,a=t.$unset;if(!r||!("@id"in r))throw new i.SoukaiError("Invalid JSON-LD graph updates provided for SolidEngine. Are you using a model that isn't a SolidModel?");if(a)return r["@id"].$in.map((function(t){return new Vt(t)}));var s=r["@id"],u=o,c=[];try{for(var l=ue(Object.entries(u)),f=l.next();!f.done;f=l.next()){var h=ae(f.value,2),d=h[0],p=h[1];if(null===p)throw new i.SoukaiError("SolidEngine doesn't support setting properties to null, delete");"object"==typeof p&&"$unset"in p?c.push(new Vt(s,d)):"object"==typeof p&&"@id"in p?c.push(new Bt(m.reference(s,d,p["@id"]))):"object"==typeof p&&"@type"in p&&"http://www.w3.org/2001/XMLSchema#dateTime"===p["@type"]?c.push(new Bt(m.literal(s,d,new Date(p["@value"])))):"@id"!==d?"@type"!==d?c.push(new Bt(m.literal(s,d,p))):c.push(new Bt(m.type(s,p))):c.push(new Ut(s,p))}}catch(t){e={error:t}}finally{try{f&&!f.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}return c},t.prototype.extractJsonLDGraphItemPush=function(t){return ie(this,void 0,void 0,(function(){return oe(this,(function(e){switch(e.label){case 0:return[4,this.getJsonLDGraphProperties(t)];case 1:return[2,e.sent().map((function(t){return new Bt(t)}))]}}))}))},t.prototype.extractJsonLDGraphTypes=function(t){if(!this.isJsonLDGraphTypesFilter(t))return[];var e=t["@graph"].$contains["@type"].$or.reduce((function(t,e){return"$contains"in e&&t.push.apply(t,se(e.$contains)),"$eq"in e&&t.push(e.$eq),t}),[]);return E.unique(e.filter((function(t){return t.startsWith("http")})))},t.prototype.getJsonLDGraphProperties=function(t){return ie(this,void 0,void 0,(function(){return oe(this,(function(e){switch(e.label){case 0:return[4,B.parseJsonLD(t)];case 1:return[2,e.sent().properties]}}))}))},t.prototype.isJsonLDGraphUpdate=function(t){return"object"==typeof t["@graph"]&&("object"==typeof t["@graph"].$updateItems||"object"==typeof t["@graph"].$push)},t.prototype.isJsonLDGraphTypesFilter=function(t){return"object"==typeof t["@graph"]&&"object"==typeof t["@graph"].$contains&&"object"==typeof t["@graph"].$contains["@type"]&&Array.isArray(t["@graph"].$contains["@type"].$or)},t}(),le=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fe=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},he=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},de=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},pe=function(t){function e(e){return t.call(this,e,Ft,"resourceUrls")||this}return le(e,t),Object.defineProperty(e.prototype,"container",{get:function(){return this.parent},enumerable:!0,configurable:!0}),e.prototype.resolve=function(){return fe(this,void 0,void 0,(function(){var e,n=this;return he(this,(function(r){switch(r.label){case 0:return o.a.engine instanceof ce?[2,t.prototype.resolve.call(this)]:[4,o.a.engine.readMany(this.container.getDocumentUrl())];case 1:return e=r.sent(),this.related=Object.entries(e).map((function(t){var e=de(t,2),r=e[0],i=e[1];return new Ft({url:r,updatedAt:n.getLatestUpdateDate(i["@graph"])})})),[2,this.related]}}))}))},e.prototype.getLatestUpdateDate=function(t){var e=t.reduce((function(t,e){var n,r,i,o,a=(null!==(o=null!==(i=null!==(r=null!==(n=e["purl:modified"])&&void 0!==n?n:e["http://purl.org/dc/terms/modified"])&&void 0!==r?r:e["purl:created"])&&void 0!==i?i:e["http://purl.org/dc/terms/created"])&&void 0!==o?o:{"@value":0})["@value"],s=new Date(a).getTime();return Math.max(t,s)}),0);return new Date(e)},e}(X),ye=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),be=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},ve=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},ge=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},me=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ge(arguments[e]));return t},we=function(t){function e(e,n){return t.call(this,e,n,"resourceUrls","url")||this}return ye(e,t),e.prototype.resolve=function(){return be(this,void 0,void 0,(function(){var t;return ve(this,(function(e){switch(e.label){case 0:return t=this,[4,this.relatedClass.from(this.parent.url).all({$in:this.parent.resourceUrls})];case 1:return t.related=e.sent(),[2,this.related]}}))}))},e.prototype.create=function(t){return void 0===t&&(t={}),be(this,void 0,void 0,(function(){var e;return ve(this,(function(n){switch(n.label){case 0:return e=this.relatedClass.newInstance(t),[4,this.save(e)];case 1:return n.sent(),[2,e]}}))}))},e.prototype.save=function(t){return be(this,void 0,void 0,(function(){return ve(this,(function(e){switch(e.label){case 0:if(!this.parent.exists())throw new i.SoukaiError("Cannot save a model because the container doesn't exist");return[4,t.save(this.parent.url)];case 1:return e.sent(),o.a.engine instanceof ce?[3,3]:[4,this.parent.update({resourceUrls:me(this.parent.resourceUrls,[t.getDocumentUrl()])})];case 2:e.sent(),e.label=3;case 3:return this.loaded&&this.related.push(t),[2]}}))}))},e}(i.BelongsToManyRelation),_e=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Se=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _e(e,t),e.boot=function(e){t.boot.call(this,e),this.rdfsClasses.add(V("ldp:Container")),this.fields.resourceUrls={type:i.FieldType.Array,required:!1,rdfProperty:"http://www.w3.org/ns/ldp#contains",items:{type:i.FieldType.Key}},Ft.boot("SolidDocument")},e.prototype.documentsRelationship=function(){return new pe(this)},e.prototype.contains=function(t){return new we(this,t)},e.prototype.newUrl=function(){var t=this.hasAttribute("name")?J.slug(this.getAttribute("name")):G.generate();return h.resolveDirectory(this.modelClass.collection,t)},e}(Nt),xe=new(function(){function t(){}return t.prototype.loadSolidModels=function(){o.a.loadModels({SolidDocument:Ft})},t}());e.default=xe}])}))},f071:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerHandlerLanguage=void 0;const r=n("e6e5");class i{canCombineWithGraph(){return!1}async handle(t,e,n,i,o,a){const s=await n.getContainerKey(i[a],i,a);if(Array.isArray(o))o=o.map(t=>({"@value":t,"@language":s}));else{if("string"!==typeof o)throw new r.ErrorCoded(`Got invalid language map value, got '${JSON.stringify(o)}', but expected string`,r.ERROR_CODES.INVALID_LANGUAGE_MAP_VALUE);o={"@value":o,"@language":s}}await e.newOnValueJob(i.slice(0,i.length-1),o,a-1,!0),e.emittedStack[a]=!1}}e.ContainerHandlerLanguage=i},f232:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeyword=void 0;class r{constructor(t){this.keyword=t}isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,n,r,i){return!1}async test(t,e,n,r,i){return n===this.keyword}}e.EntryHandlerKeyword=r},f60b:function(t,e,n){var r=n("b639"),i=r.Buffer;function o(t,e){for(var n in t)e[n]=t[n]}function a(t,e,n){return i(t,e,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=r:(o(r,e),e.Buffer=a),o(i,a),a.from=function(t,e,n){if("number"===typeof t)throw new TypeError("Argument must not be a number");return i(t,e,n)},a.alloc=function(t,e,n){if("number"!==typeof t)throw new TypeError("Argument must be a number");var r=i(t);return void 0!==e?"string"===typeof n?r.fill(e,n):r.fill(e):r.fill(0),r},a.allocUnsafe=function(t){if("number"!==typeof t)throw new TypeError("Argument must be a number");return i(t)},a.allocUnsafeSlow=function(t){if("number"!==typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}}}]);
//# sourceMappingURL=chunk-6d44c064.1e15a455.js.map